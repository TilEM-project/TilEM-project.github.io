<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <title>Tile Upload Buffer - TEM Architecture</title>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css"/>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"/>
<!-- <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.-.min.css"/> -->
<link rel="stylesheet" href="/assets/css/style.css"/>
<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/font-awesome.min.css"> -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
  window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>

  </head>
  <body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
      <!-- <div class="mdl-layout--fixed-header mdl-layout__header--scroll"> -->
  <header class="mdl-layout__header">
    <div class="mdl-layout__header-row">
      <span class="mdl-layout-title">
        <a href="/">TEM Architecture</a>
      </span>
      <div class="mdl-layout-spacer mdl-layout--large-screen-only"></div>
      <nav class="mdl-navigation mdl-layout--large-screen-only">
        
          <a class="mdl-navigation__link" href="/topics.html">Topics</a>
        
          <a class="mdl-navigation__link" href="/assignments.html">Assignments</a>
        
      </nav>
    </div>
  </header>
  <div class="mdl-layout__drawer">
    <span class="mdl-layout-title">TEM Architecture</span>
    <nav class="mdl-navigation">
      
        <a class="mdl-navigation__link" href="/topics.html">Topics</a>
        
      
        <a class="mdl-navigation__link" href="/assignments.html">Assignments</a>
        
      
        <a class="mdl-navigation__link" href="/unassigned.html">Unassigned</a>
        
      
    </nav>
  </div>
<!-- </div> -->

      <main class="mdl-layout__content">
        <div class="mdl-grid page-container">
    <div class="mdl-card mdl-cell--12-col mdl-shadow--4dp">
        <div class="mdl-card__title">
            <h2 class="mdl-card__title--text">
                Tile Upload Buffer
            </h2>
        </div>
        
  <div class="mdl-card__supporting-text mdl-card--border">
    
    
    
      <h3>Sends</h3>
      <ul>
        
        
          <li><a href="/topics.html#buffer-status">buffer.status</a></li>
        
      </ul>
    
    
      <h3>Receives</h3>
      <ul>
        
        
          <li><a href="/topics.html#tile-processed">tile.processed</a></li>
        
          <li><a href="/topics.html#tile-statistics-focus">tile.statistics.focus</a></li>
        
          <li><a href="/topics.html#tile-statistics-histogram">tile.statistics.histogram</a></li>
        
          <li><a href="/topics.html#tile-statistics-min_max_mean">tile.statistics.min_max_mean</a></li>
        
          <li><a href="/topics.html#tile-transform">tile.transform</a></li>
        
      </ul>
    
  </div>

<div class="mdl-card__supporting-text">
  <p>Tile images and metadata must be stored during montaging, then uploaded after montaging is complete.
If the montage is aborted, this data should then be discarded.
Uploads should happen asynchronously such that the microscope can continue imaging when the internet connection is insufficient for real-time tile upload.
An internet connection is still required for <a href="/pytem.html">pyTEM</a> to function.</p>

<p>The buffer service is responsible for the following tasks:</p>

<ol>
  <li>Store tile metadata during montaging.</li>
  <li>After montaging:
    <ol>
      <li>Upload metadata to <a href="/tem_db.html">TEM DB</a>.</li>
      <li>Upload each tile to the <a href="/aloha.html">aloha</a> service.</li>
      <li>Check that aloha successfully processed the tile.</li>
      <li>Delete the tile (and intermediate files) from the SSD.</li>
    </ol>
  </li>
  <li>If montaging is aborted: delete all tiles (and intermediate files).</li>
</ol>

<p>Processed tiles and metadata should be received from the <a href="/pipeline.html">image processing pipeline</a> via a multitude of topics listed above via the <a href="/broker.md">broker</a>.
Additionally, messages should be regularly published on the <a href="/topics.html#buffer-status"><code class="language-plaintext highlighter-rouge">buffer.status</code></a> topic about the state of the buffer.</p>

</div>
    </div>
</div>
        <footer class="mdl-mega-footer">
  <div class="mdl-mega-footer__middle-section">
    
  </div>
  <div class="mdl-mega-footer__bottom-section">
    <ul class="mdl-mega-footer__link-list">
      
    </ul>
  </div>
</footer>

      </main>
    </div>
  </body>
</html>

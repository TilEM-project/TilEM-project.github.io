<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <title>Image Processing Pipeline - TEM Architecture</title>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css"/>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"/>
<!-- <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.-.min.css"/> -->
<link rel="stylesheet" href="/assets/css/style.css"/>
<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/font-awesome.min.css"> -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
  window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>

  </head>
  <body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
      <!-- <div class="mdl-layout--fixed-header mdl-layout__header--scroll"> -->
  <header class="mdl-layout__header">
    <div class="mdl-layout__header-row">
      <span class="mdl-layout-title">
        <a href="/">TEM Architecture</a>
      </span>
      <div class="mdl-layout-spacer mdl-layout--large-screen-only"></div>
      <nav class="mdl-navigation mdl-layout--large-screen-only">
        
      </nav>
    </div>
  </header>
  <div class="mdl-layout__drawer">
    <span class="mdl-layout-title">TEM Architecture</span>
    <nav class="mdl-navigation">
      
    </nav>
  </div>
<!-- </div> -->

      <main class="mdl-layout__content">
        <div class="mdl-grid page-container">
  <div class="mdl-card mdl-cell--12-col mdl-shadow--4dp">
    <div class="mdl-card__title">
      <h2 class="mdl-card__title--text">
        Image Processing Pipeline
      </h2>
    </div>
    <div class="mdl-card__supporting-text">
      
        <p style="font-size: large;" class="mdl-card__subtitle-text">
          <i style="color:black;" class="fab fa-github"></i>
          <a href="https://github.com/AllenInstitute/TEM_graph">AllenInstitute/TEM_graph</a>
        </p>
      
    </div>
    <div class="mdl-card__supporting-text">
      <p>The image processing pipeline is primarily written in C++ with some Python bindings.
It utilizes the <a href="https://www.intel.com/content/www/us/en/developer/tools/oneapi/onetbb.html">Intel Thread Building Blocks</a> library for parallelism, and <a href="https://opencv.org/">OpenCV</a> for image processing.</p>

<div class="diagram"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0.00 0.00 2129.00 860.00">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(144 716)">
<title>%3</title>
<g id="clust1" class="cluster">
<title>cluster_Intel TBB</title>
<path fill="#ffe0b2" stroke="#aeb6be" d="M229.5,0C229.5,0 1611.5,0 1611.5,0 1617.5,0 1623.5,-6 1623.5,-12 1623.5,-12 1623.5,-560 1623.5,-560 1623.5,-566 1617.5,-572 1611.5,-572 1611.5,-572 229.5,-572 229.5,-572 223.5,-572 217.5,-566 217.5,-560 217.5,-560 217.5,-12 217.5,-12 217.5,-6 223.5,0 229.5,0" />
<text text-anchor="middle" x="253" y="-558.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Intel TBB</text>
</g>
<!-- cde2be2edc9749e5bc30856b57b6b15e -->
<g id="node1" class="node">
<title>cde2be2edc9749e5bc30856b57b6b15e</title>
<g id="a_node1"><a xlink:href="#recieve-tile-filepath" xlink:title="Recieve Tile Filepath">
<image xlink:href="/icons/python.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="217.5" y="-336.5" />
<text text-anchor="middle" x="268" y="-221.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Recieve Tile Filepath</text>
</a>
</g>
</g>
<!-- 0cb14f56661b4c9186915fd31f1efe8f -->
<g id="node2" class="node">
<title>0cb14f56661b4c9186915fd31f1efe8f</title>
<g id="a_node2"><a xlink:href="#load-tile" xlink:title="Load Tile">
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="362.5" y="-342.813" />
<text text-anchor="middle" x="413" y="-221.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Load Tile</text>
</a>
</g>
</g>
<!-- cde2be2edc9749e5bc30856b57b6b15e&#45;&gt;0cb14f56661b4c9186915fd31f1efe8f -->
<g id="edge1" class="edge">
<title>cde2be2edc9749e5bc30856b57b6b15e-&gt;0cb14f56661b4c9186915fd31f1efe8f</title>
<path fill="none" stroke="#7b8894" d="M318.71,-286C329.47,-286 340.93,-286 352.02,-286" />
<polygon fill="#7b8894" stroke="#7b8894" points="352.07,-289.5 362.07,-286 352.07,-282.5 352.07,-289.5" />
</g>
<!-- a0c287e3b7b644f28e259f33eb2bc799 -->
<g id="node20" class="node">
<title>a0c287e3b7b644f28e259f33eb2bc799</title>
<image xlink:href="/icons/blank.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="0" y="-336.5" />
</g>
<!-- cde2be2edc9749e5bc30856b57b6b15e&#45;&gt;a0c287e3b7b644f28e259f33eb2bc799 -->
<g id="edge19" class="edge">
<title>cde2be2edc9749e5bc30856b57b6b15e-&gt;a0c287e3b7b644f28e259f33eb2bc799</title>
<g id="a_edge19"><a xlink:href="/topics.html#tile.raw" xlink:title="tile.raw">
<path fill="none" stroke="#7b8894" d="M207.19,-286C173.83,-286 132.94,-286 101.3,-286" />
<polygon fill="#7b8894" stroke="#7b8894" points="207.28,-289.5 217.28,-286 207.28,-282.5 207.28,-289.5" />
</a>
</g>
<g id="a_edge19-label"><a xlink:href="/topics.html#tile.raw" xlink:title="tile.raw">
<text text-anchor="middle" x="129.24" y="-289.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">tile.raw</text>
</a>
</g>
</g>
<!-- 601fbe4acb6740b3bd32293e896adc4c -->
<g id="node3" class="node">
<title>601fbe4acb6740b3bd32293e896adc4c</title>
<g id="a_node3"><a xlink:href="#transfer-to-gpu" xlink:title="Transfer to GPU">
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="507.5" y="-342.813" />
<text text-anchor="middle" x="558" y="-221.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Transfer to GPU</text>
</a>
</g>
</g>
<!-- 0cb14f56661b4c9186915fd31f1efe8f&#45;&gt;601fbe4acb6740b3bd32293e896adc4c -->
<g id="edge2" class="edge">
<title>0cb14f56661b4c9186915fd31f1efe8f-&gt;601fbe4acb6740b3bd32293e896adc4c</title>
<path fill="none" stroke="#7b8894" d="M463.71,-286C474.47,-286 485.93,-286 497.02,-286" />
<polygon fill="#7b8894" stroke="#7b8894" points="497.07,-289.5 507.07,-286 497.07,-282.5 497.07,-289.5" />
</g>
<!-- b35842d7addd45fca32284a9c0538e9d -->
<g id="node4" class="node">
<title>b35842d7addd45fca32284a9c0538e9d</title>
<g id="a_node4"><a xlink:href="#flip" xlink:title="Horizontal Flip">
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="652.5" y="-342.813" />
<text text-anchor="middle" x="703" y="-221.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Horizontal Flip</text>
</a>
</g>
</g>
<!-- 601fbe4acb6740b3bd32293e896adc4c&#45;&gt;b35842d7addd45fca32284a9c0538e9d -->
<g id="edge3" class="edge">
<title>601fbe4acb6740b3bd32293e896adc4c-&gt;b35842d7addd45fca32284a9c0538e9d</title>
<path fill="none" stroke="#7b8894" d="M608.71,-286C619.47,-286 630.93,-286 642.02,-286" />
<polygon fill="#7b8894" stroke="#7b8894" points="642.07,-289.5 652.07,-286 642.07,-282.5 642.07,-289.5" />
</g>
<!-- d56bd1d077a6445db9a3a5f687014481 -->
<g id="node5" class="node">
<title>d56bd1d077a6445db9a3a5f687014481</title>
<g id="a_node5"><a xlink:href="#flat-field-correction" xlink:title="Flat-Field Correction">
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="797.5" y="-342.813" />
<text text-anchor="middle" x="848" y="-221.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Flat-Field Correction</text>
</a>
</g>
</g>
<!-- b35842d7addd45fca32284a9c0538e9d&#45;&gt;d56bd1d077a6445db9a3a5f687014481 -->
<g id="edge4" class="edge">
<title>b35842d7addd45fca32284a9c0538e9d-&gt;d56bd1d077a6445db9a3a5f687014481</title>
<path fill="none" stroke="#7b8894" d="M753.71,-286C764.47,-286 775.93,-286 787.02,-286" />
<polygon fill="#7b8894" stroke="#7b8894" points="787.07,-289.5 797.07,-286 787.07,-282.5 787.07,-289.5" />
</g>
<!-- 37f4ca16c5a54c6290731540e520d8c7 -->
<g id="node6" class="node">
<title>37f4ca16c5a54c6290731540e520d8c7</title>
<g id="a_node6"><a xlink:href="#clahe" xlink:title="CLAHE">
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="942.5" y="-342.813" />
<text text-anchor="middle" x="993" y="-221.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">CLAHE</text>
</a>
</g>
</g>
<!-- d56bd1d077a6445db9a3a5f687014481&#45;&gt;37f4ca16c5a54c6290731540e520d8c7 -->
<g id="edge5" class="edge">
<title>d56bd1d077a6445db9a3a5f687014481-&gt;37f4ca16c5a54c6290731540e520d8c7</title>
<path fill="none" stroke="#7b8894" d="M898.71,-286C909.47,-286 920.93,-286 932.02,-286" />
<polygon fill="#7b8894" stroke="#7b8894" points="932.07,-289.5 942.07,-286 932.07,-282.5 932.07,-289.5" />
</g>
<!-- 9de863f239cf4f6f8b027824f90f76ec -->
<g id="node7" class="node">
<title>9de863f239cf4f6f8b027824f90f76ec</title>
<g id="a_node7"><a xlink:href="#min-max-mean" xlink:title="Min, Max, Mean">
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="1087.5" y="-560.313" />
<text text-anchor="middle" x="1138" y="-438.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Min, Max, Mean</text>
</a>
</g>
</g>
<!-- 37f4ca16c5a54c6290731540e520d8c7&#45;&gt;9de863f239cf4f6f8b027824f90f76ec -->
<g id="edge10" class="edge">
<title>37f4ca16c5a54c6290731540e520d8c7-&gt;9de863f239cf4f6f8b027824f90f76ec</title>
<path fill="none" stroke="#7b8894" d="M1038.68,-354.52C1053.91,-377.37 1070.98,-402.97 1086.61,-426.42" />
<polygon fill="#7b8894" stroke="#7b8894" points="1083.84,-428.57 1092.3,-434.95 1089.67,-424.69 1083.84,-428.57" />
</g>
<!-- 5dae87724042467896b07cbf5103ffe1 -->
<g id="node9" class="node">
<title>5dae87724042467896b07cbf5103ffe1</title>
<g id="a_node9"><a xlink:href="#fft" xlink:title="FFT">
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="1087.5" y="-415.313" />
<text text-anchor="middle" x="1138" y="-293.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">FFT</text>
</a>
</g>
</g>
<!-- 37f4ca16c5a54c6290731540e520d8c7&#45;&gt;5dae87724042467896b07cbf5103ffe1 -->
<g id="edge12" class="edge">
<title>37f4ca16c5a54c6290731540e520d8c7-&gt;5dae87724042467896b07cbf5103ffe1</title>
<path fill="none" stroke="#7b8894" d="M1043.71,-311.36C1054.8,-316.9 1066.63,-322.82 1078.04,-328.52" />
<polygon fill="#7b8894" stroke="#7b8894" points="1076.56,-331.69 1087.07,-333.03 1079.69,-325.43 1076.56,-331.69" />
</g>
<!-- 610e1c281e414afe853efddbd65d4705 -->
<g id="node12" class="node">
<title>610e1c281e414afe853efddbd65d4705</title>
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="1087.5" y="-270.313" />
<text text-anchor="middle" x="1138" y="-148.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Transfer to CPU Memory</text>
</g>
<!-- 37f4ca16c5a54c6290731540e520d8c7&#45;&gt;610e1c281e414afe853efddbd65d4705 -->
<g id="edge15" class="edge">
<title>37f4ca16c5a54c6290731540e520d8c7-&gt;610e1c281e414afe853efddbd65d4705</title>
<path fill="none" stroke="#7b8894" d="M1043.71,-260.64C1054.8,-255.1 1066.63,-249.18 1078.04,-243.48" />
<polygon fill="#7b8894" stroke="#7b8894" points="1079.69,-246.57 1087.07,-238.97 1076.56,-240.31 1079.69,-246.57" />
</g>
<!-- 9a93ed500d20421db54e72c7dfa8aa34 -->
<g id="node16" class="node">
<title>9a93ed500d20421db54e72c7dfa8aa34</title>
<g id="a_node16"><a xlink:href="#lens-correction" xlink:title="Lens Correction">
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="1087.5" y="-125.312" />
<text text-anchor="middle" x="1138" y="-3.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Lens Correction</text>
</a>
</g>
</g>
<!-- 37f4ca16c5a54c6290731540e520d8c7&#45;&gt;9a93ed500d20421db54e72c7dfa8aa34 -->
<g id="edge6" class="edge">
<title>37f4ca16c5a54c6290731540e520d8c7-&gt;9a93ed500d20421db54e72c7dfa8aa34</title>
<path fill="none" stroke="#7b8894" d="M1038.68,-217.48C1053.91,-194.63 1070.98,-169.03 1086.61,-145.58" />
<polygon fill="#7b8894" stroke="#7b8894" points="1089.67,-147.31 1092.3,-137.05 1083.84,-143.43 1089.67,-147.31" />
</g>
<!-- 06b335029e1d4d5da757a2e12456c467 -->
<g id="node8" class="node">
<title>06b335029e1d4d5da757a2e12456c467</title>
<g id="a_node8"><a xlink:href="#send-min-max-mean" xlink:title="Send Min, Max, Mean">
<image xlink:href="/icons/python.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1232.5" y="-554" />
<text text-anchor="middle" x="1283" y="-438.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Send Min, Max, Mean</text>
</a>
</g>
</g>
<!-- 9de863f239cf4f6f8b027824f90f76ec&#45;&gt;06b335029e1d4d5da757a2e12456c467 -->
<g id="edge11" class="edge">
<title>9de863f239cf4f6f8b027824f90f76ec-&gt;06b335029e1d4d5da757a2e12456c467</title>
<path fill="none" stroke="#7b8894" d="M1188.71,-503.5C1199.47,-503.5 1210.93,-503.5 1222.02,-503.5" />
<polygon fill="#7b8894" stroke="#7b8894" points="1222.07,-507 1232.07,-503.5 1222.07,-500 1222.07,-507" />
</g>
<!-- 92bf2f858d2444b69ce7c17596fa79de -->
<g id="node21" class="node">
<title>92bf2f858d2444b69ce7c17596fa79de</title>
<image xlink:href="/icons/blank.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1740" y="-554" />
</g>
<!-- 06b335029e1d4d5da757a2e12456c467&#45;&gt;92bf2f858d2444b69ce7c17596fa79de -->
<g id="edge20" class="edge">
<title>06b335029e1d4d5da757a2e12456c467-&gt;92bf2f858d2444b69ce7c17596fa79de</title>
<path fill="none" stroke="#7b8894" d="M1333.52,-503.5C1427.44,-503.5 1628.58,-503.5 1729.75,-503.5" />
<polygon fill="#7b8894" stroke="#7b8894" points="1729.81,-507 1739.81,-503.5 1729.81,-500 1729.81,-507" />
<text text-anchor="middle" x="1655.31" y="-507.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">statistics.min_max_mean</text>
</g>
<!-- 48b85b8c1f8644e1baba16855013097b -->
<g id="node10" class="node">
<title>48b85b8c1f8644e1baba16855013097b</title>
<g id="a_node10"><a xlink:href="#focus-score" xlink:title="Compute Focus Score">
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="1232.5" y="-415.313" />
<text text-anchor="middle" x="1283" y="-293.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Compute Focus Score</text>
</a>
</g>
</g>
<!-- 5dae87724042467896b07cbf5103ffe1&#45;&gt;48b85b8c1f8644e1baba16855013097b -->
<g id="edge13" class="edge">
<title>5dae87724042467896b07cbf5103ffe1-&gt;48b85b8c1f8644e1baba16855013097b</title>
<path fill="none" stroke="#7b8894" d="M1188.71,-358.5C1199.47,-358.5 1210.93,-358.5 1222.02,-358.5" />
<polygon fill="#7b8894" stroke="#7b8894" points="1222.07,-362 1232.07,-358.5 1222.07,-355 1222.07,-362" />
</g>
<!-- e6e17aff432c42a78d742074bb83f1dc -->
<g id="node11" class="node">
<title>e6e17aff432c42a78d742074bb83f1dc</title>
<g id="a_node11"><a xlink:href="#send-focus-score" xlink:title="Send Focus Score">
<image xlink:href="/icons/python.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1377.5" y="-409" />
<text text-anchor="middle" x="1428" y="-293.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Send Focus Score</text>
</a>
</g>
</g>
<!-- 48b85b8c1f8644e1baba16855013097b&#45;&gt;e6e17aff432c42a78d742074bb83f1dc -->
<g id="edge14" class="edge">
<title>48b85b8c1f8644e1baba16855013097b-&gt;e6e17aff432c42a78d742074bb83f1dc</title>
<path fill="none" stroke="#7b8894" d="M1333.71,-358.5C1344.47,-358.5 1355.93,-358.5 1367.02,-358.5" />
<polygon fill="#7b8894" stroke="#7b8894" points="1367.07,-362 1377.07,-358.5 1367.07,-355 1367.07,-362" />
</g>
<!-- 5d43534b197c4a5ca366f7de7d5facaf -->
<g id="node22" class="node">
<title>5d43534b197c4a5ca366f7de7d5facaf</title>
<image xlink:href="/icons/blank.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1740" y="-409" />
</g>
<!-- e6e17aff432c42a78d742074bb83f1dc&#45;&gt;5d43534b197c4a5ca366f7de7d5facaf -->
<g id="edge21" class="edge">
<title>e6e17aff432c42a78d742074bb83f1dc-&gt;5d43534b197c4a5ca366f7de7d5facaf</title>
<path fill="none" stroke="#7b8894" d="M1478.79,-358.5C1544.62,-358.5 1659.32,-358.5 1729.71,-358.5" />
<polygon fill="#7b8894" stroke="#7b8894" points="1729.77,-362 1739.77,-358.5 1729.77,-355 1729.77,-362" />
<text text-anchor="middle" x="1689.77" y="-362.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">statistics.focus</text>
</g>
<!-- e829a4e3d36e471caa60cbf40e05e38b -->
<g id="node13" class="node">
<title>e829a4e3d36e471caa60cbf40e05e38b</title>
<g id="a_node13"><a xlink:href="#calculate-histogram" xlink:title="Calculate Histogram">
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="1232.5" y="-270.313" />
<text text-anchor="middle" x="1283" y="-148.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Calculate Histogram</text>
</a>
</g>
</g>
<!-- 610e1c281e414afe853efddbd65d4705&#45;&gt;e829a4e3d36e471caa60cbf40e05e38b -->
<g id="edge16" class="edge">
<title>610e1c281e414afe853efddbd65d4705-&gt;e829a4e3d36e471caa60cbf40e05e38b</title>
<path fill="none" stroke="#7b8894" d="M1188.71,-213.5C1199.47,-213.5 1210.93,-213.5 1222.02,-213.5" />
<polygon fill="#7b8894" stroke="#7b8894" points="1222.07,-217 1232.07,-213.5 1222.07,-210 1222.07,-217" />
</g>
<!-- 2e5cb465d4b048748cb95a9e2ad42733 -->
<g id="node14" class="node">
<title>2e5cb465d4b048748cb95a9e2ad42733</title>
<g id="a_node14"><a xlink:href="#save-histogram" xlink:title="Save Histogram">
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="1377.5" y="-270.313" />
<text text-anchor="middle" x="1428" y="-148.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Save Histogram</text>
</a>
</g>
</g>
<!-- e829a4e3d36e471caa60cbf40e05e38b&#45;&gt;2e5cb465d4b048748cb95a9e2ad42733 -->
<g id="edge17" class="edge">
<title>e829a4e3d36e471caa60cbf40e05e38b-&gt;2e5cb465d4b048748cb95a9e2ad42733</title>
<path fill="none" stroke="#7b8894" d="M1333.71,-213.5C1344.47,-213.5 1355.93,-213.5 1367.02,-213.5" />
<polygon fill="#7b8894" stroke="#7b8894" points="1367.07,-217 1377.07,-213.5 1367.07,-210 1367.07,-217" />
</g>
<!-- 0107252ed38848fca6904f26c2a02df2 -->
<g id="node15" class="node">
<title>0107252ed38848fca6904f26c2a02df2</title>
<g id="a_node15"><a xlink:href="#send-histogram-filepath" xlink:title="Send Histogram Filepath">
<image xlink:href="/icons/python.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1522.5" y="-264" />
<text text-anchor="middle" x="1573" y="-148.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Send Histogram Filepath</text>
</a>
</g>
</g>
<!-- 2e5cb465d4b048748cb95a9e2ad42733&#45;&gt;0107252ed38848fca6904f26c2a02df2 -->
<g id="edge18" class="edge">
<title>2e5cb465d4b048748cb95a9e2ad42733-&gt;0107252ed38848fca6904f26c2a02df2</title>
<path fill="none" stroke="#7b8894" d="M1478.71,-213.5C1489.47,-213.5 1500.93,-213.5 1512.02,-213.5" />
<polygon fill="#7b8894" stroke="#7b8894" points="1512.07,-217 1522.07,-213.5 1512.07,-210 1512.07,-217" />
</g>
<!-- 935756fc644440c9bbb8cdad1e8476d0 -->
<g id="node23" class="node">
<title>935756fc644440c9bbb8cdad1e8476d0</title>
<image xlink:href="/icons/blank.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1740" y="-264" />
</g>
<!-- 0107252ed38848fca6904f26c2a02df2&#45;&gt;935756fc644440c9bbb8cdad1e8476d0 -->
<g id="edge22" class="edge">
<title>0107252ed38848fca6904f26c2a02df2-&gt;935756fc644440c9bbb8cdad1e8476d0</title>
<path fill="none" stroke="#7b8894" d="M1623.72,-213.5C1655.34,-213.5 1696.23,-213.5 1729.6,-213.5" />
<polygon fill="#7b8894" stroke="#7b8894" points="1729.7,-217 1739.7,-213.5 1729.7,-210 1729.7,-217" />
<text text-anchor="middle" x="1674.2" y="-217.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">statistics.histogram</text>
</g>
<!-- be8662c7765f4d6ba9019b3af9189df9 -->
<g id="node17" class="node">
<title>be8662c7765f4d6ba9019b3af9189df9</title>
<g id="a_node17"><a xlink:href="#transfer-to-cpu-memory" xlink:title="Transfer to CPU Memory">
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="1232.5" y="-125.312" />
<text text-anchor="middle" x="1283" y="-3.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Transfer to CPU Memory</text>
</a>
</g>
</g>
<!-- 9a93ed500d20421db54e72c7dfa8aa34&#45;&gt;be8662c7765f4d6ba9019b3af9189df9 -->
<g id="edge7" class="edge">
<title>9a93ed500d20421db54e72c7dfa8aa34-&gt;be8662c7765f4d6ba9019b3af9189df9</title>
<path fill="none" stroke="#7b8894" d="M1188.71,-68.5C1199.47,-68.5 1210.93,-68.5 1222.02,-68.5" />
<polygon fill="#7b8894" stroke="#7b8894" points="1222.07,-72 1232.07,-68.5 1222.07,-65 1222.07,-72" />
</g>
<!-- c34d3ab2b9874d7cabd013a3cbc09cbd -->
<g id="node18" class="node">
<title>c34d3ab2b9874d7cabd013a3cbc09cbd</title>
<g id="a_node18"><a xlink:href="#save-tile" xlink:title="Save Tile">
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="1377.5" y="-125.312" />
<text text-anchor="middle" x="1428" y="-3.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Save Tile</text>
</a>
</g>
</g>
<!-- be8662c7765f4d6ba9019b3af9189df9&#45;&gt;c34d3ab2b9874d7cabd013a3cbc09cbd -->
<g id="edge8" class="edge">
<title>be8662c7765f4d6ba9019b3af9189df9-&gt;c34d3ab2b9874d7cabd013a3cbc09cbd</title>
<path fill="none" stroke="#7b8894" d="M1333.71,-68.5C1344.47,-68.5 1355.93,-68.5 1367.02,-68.5" />
<polygon fill="#7b8894" stroke="#7b8894" points="1367.07,-72 1377.07,-68.5 1367.07,-65 1367.07,-72" />
</g>
<!-- a1aa2b10172e4df895c34c8b7f373525 -->
<g id="node19" class="node">
<title>a1aa2b10172e4df895c34c8b7f373525</title>
<g id="a_node19"><a xlink:href="#send-tile-filepath" xlink:title="Send Processed Tile Filepath">
<image xlink:href="/icons/python.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1522.5" y="-119" />
<text text-anchor="middle" x="1573" y="-3.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Send Processed Tile Filepath</text>
</a>
</g>
</g>
<!-- c34d3ab2b9874d7cabd013a3cbc09cbd&#45;&gt;a1aa2b10172e4df895c34c8b7f373525 -->
<g id="edge9" class="edge">
<title>c34d3ab2b9874d7cabd013a3cbc09cbd-&gt;a1aa2b10172e4df895c34c8b7f373525</title>
<path fill="none" stroke="#7b8894" d="M1478.71,-68.5C1489.47,-68.5 1500.93,-68.5 1512.02,-68.5" />
<polygon fill="#7b8894" stroke="#7b8894" points="1512.07,-72 1522.07,-68.5 1512.07,-65 1512.07,-72" />
</g>
<!-- fabe87140d9745c09ec66c285164a1c3 -->
<g id="node24" class="node">
<title>fabe87140d9745c09ec66c285164a1c3</title>
<image xlink:href="/icons/blank.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1740" y="-119" />
</g>
<!-- a1aa2b10172e4df895c34c8b7f373525&#45;&gt;fabe87140d9745c09ec66c285164a1c3 -->
<g id="edge23" class="edge">
<title>a1aa2b10172e4df895c34c8b7f373525-&gt;fabe87140d9745c09ec66c285164a1c3</title>
<path fill="none" stroke="#7b8894" d="M1623.72,-68.5C1655.34,-68.5 1696.23,-68.5 1729.6,-68.5" />
<polygon fill="#7b8894" stroke="#7b8894" points="1729.7,-72 1739.7,-68.5 1729.7,-65 1729.7,-72" />
<text text-anchor="middle" x="1692.7" y="-72.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">tile.processed</text>
</g>
</g>
</svg></div>

<h3 id="recieve-tile-filepath">Recieve Tile Filepath</h3>

<p>This node recieves the metadata for a tile to process from the <a href="/broker.html">message broker</a>, and passes the filename to the load image node.</p>

<h3 id="load-tile">Load Tile</h3>

<p>This node recieves the metadata and filename, and uses openCV to load a tile into CPU memory from SSD based storage.</p>

<h3 id="transfer-to-gpu">Transfer to GPU</h3>

<p>After the tile is loaded into CPU memory, it is transfered into GPU memory for more efficient processing.</p>

<h3 id="flip">Flip</h3>

<p>On the GPU, the tile is horizontally flipped.</p>

<h3 id="flat-field-correction">Flat-Field Correction</h3>

<p>The flat-field correction is applied to the tile using brightfield and darkfield images stored on the SSD.
The brightfield and darkfield file modification times are checked during each execution to check if they need to be reloaded.</p>

<h3 id="clahe">CLAHE</h3>

<p>The Contrast Limited Adaptive Histogram Equilization algorithm is applied to the tile.
The resulting image is sent to multiple functions for further analysis, including an <a href="#fft">FFT</a> for calculating the <a href="#focus-score">focus score</a>, calculating the <a href="#min-max-mean">minimum, maximum, and mean</a> pixel values, and <a href="#calculate-histogram">histogram</a>.</p>

<h3 id="lens-correction">Lens Correction</h3>

<p>To remove distortion, a lens correction is applied.
This is performed using two images stored on the SSD and reloaded whenever the file modification times are newer than the images stored in memory.</p>

<h3 id="transfer-to-cpu-memory">Transfer to CPU Memory</h3>

<p>In order to save the tile, it must first be transferred to CPU memory.</p>

<h3 id="save-tile">Save Tile</h3>

<p>The processed tile can now be saved to disk.</p>

<h3 id="send-tile-filepath">Send Tile Filepath</h3>

<p>The filepath of the processed tile can now be sent via the <a href="/broker.html">broker</a> to other services.</p>

<h3 id="min-max-mean">Min, Max, Mean</h3>

<p>This node calculates the minimum, maximum, and mean pixel values.</p>

<h3 id="send-min-max-mean">Send Min, Max, Mean</h3>

<p>This node sends the minimum, maximum, and mean pixel values to other services via the <a href="/broker.html">broker</a>.</p>

<h3 id="fft">FFT</h3>

<p>This node crops out the center of the tile and computes the Fast Fourier Transform.</p>

<h3 id="focus-score">Focus Score</h3>

<p>This ndoe uses the FFT data to create a metric for the quality of the focus.</p>

<h3 id="send-focus-score">Send Focus Score</h3>

<p>This node sends the focus score to other services via the <a href="/broker.html">broker</a></p>

<h3 id="calculate-histogram">Calculate Histogram</h3>

<p>A small histogram image is created using this node.</p>

<h3 id="save-histogram">Save Histogram</h3>

<p>This node saves the histogram to SSD storage.</p>

<h3 id="send-histogram">Send Histogram</h3>

<p>This node sends the filepath to the histogram to other services using the <a href="/broker.html">broker</a>.</p>

    </div>
  </div>
</div>
        <footer class="mdl-mega-footer">
  <div class="mdl-mega-footer__middle-section">
    
  </div>
  <div class="mdl-mega-footer__bottom-section">
    <ul class="mdl-mega-footer__link-list">
      
    </ul>
  </div>
</footer>

      </main>
    </div>
  </body>
</html>

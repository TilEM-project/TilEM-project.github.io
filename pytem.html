<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <title>pyTEM - TEM Architecture</title>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css"/>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"/>
<!-- <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.-.min.css"/> -->
<link rel="stylesheet" href="/assets/css/style.css"/>
<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/font-awesome.min.css"> -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
  window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>

  </head>
  <body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
      <!-- <div class="mdl-layout--fixed-header mdl-layout__header--scroll"> -->
  <header class="mdl-layout__header">
    <div class="mdl-layout__header-row">
      <span class="mdl-layout-title">
        <a href="/">TEM Architecture</a>
      </span>
      <div class="mdl-layout-spacer mdl-layout--large-screen-only"></div>
      <nav class="mdl-navigation mdl-layout--large-screen-only">
        
          <a class="mdl-navigation__link" href="/topics.html">Topics</a>
        
      </nav>
    </div>
  </header>
  <div class="mdl-layout__drawer">
    <span class="mdl-layout-title">TEM Architecture</span>
    <nav class="mdl-navigation">
      
        <a class="mdl-navigation__link" href="/topics.html">Topics</a>
        
      
    </nav>
  </div>
<!-- </div> -->

      <main class="mdl-layout__content">
        <div class="mdl-grid page-container">
    <div class="mdl-card mdl-cell--12-col mdl-shadow--4dp">
        <div class="mdl-card__title">
            <h2 class="mdl-card__title--text">
                pyTEM
            </h2>
        </div>
        
  <div class="mdl-card__supporting-text mdl-card--border">
    
    
      <h3>Sends</h3>
      <ul>
        
        
          <li><a href="/topics.html#camera-command">camera.command</a></li>
        
          <li><a href="/topics.html#camera-settings">camera.settings</a></li>
        
          <li><a href="/topics.html#scope-command">scope.command</a></li>
        
          <li><a href="/topics.html#stage-aperture-command">stage.aperture.command</a></li>
        
          <li><a href="/topics.html#stage-motion-command">stage.motion.command</a></li>
        
          <li><a href="/topics.html#stage-rotation-command">stage.rotation.command</a></li>
        
          <li><a href="/topics.html#tile-raw">tile.raw</a></li>
        
      </ul>
    
    
      <h3>Receives</h3>
      <ul>
        
        
          <li><a href="/topics.html#camera-image">camera.image</a></li>
        
          <li><a href="/topics.html#camera-status">camera.status</a></li>
        
          <li><a href="/topics.html#scope-status">scope.status</a></li>
        
          <li><a href="/topics.html#stage-aperture-status">stage.aperture.status</a></li>
        
          <li><a href="/topics.html#stage-motion-status">stage.motion.status</a></li>
        
          <li><a href="/topics.html#stage-rotation-status">stage.rotation.status</a></li>
        
      </ul>
    
  </div>

<div class="mdl-card__supporting-text">
  <div class="diagram"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0.00 0.00 828.00 612.00">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(144 468)">
<title>%3</title>
<g id="clust1" class="cluster">
<title>cluster_pyTEM States</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M12,0C12,0 528,0 528,0 534,0 540,-6 540,-12 540,-12 540,-312 540,-312 540,-318 534,-324 528,-324 528,-324 12,-324 12,-324 6,-324 0,-318 0,-312 0,-312 0,-12 0,-12 0,-6 6,0 12,0" />
<text text-anchor="middle" x="49" y="-310.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">pyTEM States</text>
</g>
<!-- eff263edb0464e4bb7dccc21647a7f66 -->
<g id="node1" class="node">
<title>eff263edb0464e4bb7dccc21647a7f66</title>
<g id="a_node1"><a xlink:href="#preview-state" xlink:title="Preview/Setup State">
<path fill="none" stroke="black" d="M348,-324C348,-324 156,-324 156,-324 150,-324 144,-318 144,-312 144,-312 144,-300 144,-300 144,-294 150,-288 156,-288 156,-288 348,-288 348,-288 354,-288 360,-294 360,-300 360,-300 360,-312 360,-312 360,-318 354,-324 348,-324" />
<text text-anchor="middle" x="252" y="-302.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Preview/Setup State</text>
</a>
</g>
</g>
<!-- 396782dd50e34646a418e734fe2a8b3d -->
<g id="node2" class="node">
<title>396782dd50e34646a418e734fe2a8b3d</title>
<g id="a_node2"><a xlink:href="#change-aperture-state" xlink:title="Change Aperture State">
<path fill="none" stroke="black" d="M204,-216C204,-216 12,-216 12,-216 6,-216 0,-210 0,-204 0,-204 0,-192 0,-192 0,-186 6,-180 12,-180 12,-180 204,-180 204,-180 210,-180 216,-186 216,-192 216,-192 216,-204 216,-204 216,-210 210,-216 204,-216" />
<text text-anchor="middle" x="108" y="-194.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Change Aperture State</text>
</a>
</g>
</g>
<!-- eff263edb0464e4bb7dccc21647a7f66&#45;&gt;396782dd50e34646a418e734fe2a8b3d -->
<g id="edge1" class="edge">
<title>eff263edb0464e4bb7dccc21647a7f66-&gt;396782dd50e34646a418e734fe2a8b3d</title>
<path fill="none" stroke="#7b8894" d="M227.9,-287.92C203.91,-269.93 166.95,-242.21 140.4,-222.3" />
<polygon fill="#7b8894" stroke="#7b8894" points="142.28,-219.34 132.18,-216.14 138.08,-224.94 142.28,-219.34" />
</g>
<!-- 204a7578289341d09ed116d58214112d -->
<g id="node3" class="node">
<title>204a7578289341d09ed116d58214112d</title>
<g id="a_node3"><a xlink:href="#acquisition-state" xlink:title="Acquisition State">
<path fill="none" stroke="black" d="M348,-36C348,-36 156,-36 156,-36 150,-36 144,-30 144,-24 144,-24 144,-12 144,-12 144,-6 150,0 156,0 156,0 348,0 348,0 354,0 360,-6 360,-12 360,-12 360,-24 360,-24 360,-30 354,-36 348,-36" />
<text text-anchor="middle" x="252" y="-14.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Acquisition State</text>
</a>
</g>
</g>
<!-- 396782dd50e34646a418e734fe2a8b3d&#45;&gt;204a7578289341d09ed116d58214112d -->
<g id="edge2" class="edge">
<title>396782dd50e34646a418e734fe2a8b3d-&gt;204a7578289341d09ed116d58214112d</title>
<path fill="none" stroke="#7b8894" d="M137.2,-179.69C170.66,-147.66 222.24,-82.73 243.56,-45.39" />
<polygon fill="#7b8894" stroke="#7b8894" points="246.9,-46.56 248.52,-36.08 240.73,-43.27 246.9,-46.56" />
</g>
<!-- 222fcb2e2e0241e48ab57001ef399c94 -->
<g id="node4" class="node">
<title>222fcb2e2e0241e48ab57001ef399c94</title>
<g id="a_node4"><a xlink:href="#error-state" xlink:title="Error State">
<polygon fill="none" stroke="black" points="468,-225 396,-198 468,-171 540,-198 468,-225" />
<text text-anchor="middle" x="468" y="-194.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Error State</text>
</a>
</g>
</g>
<!-- 396782dd50e34646a418e734fe2a8b3d&#45;&gt;222fcb2e2e0241e48ab57001ef399c94 -->
<g id="edge5" class="edge">
<title>396782dd50e34646a418e734fe2a8b3d-&gt;222fcb2e2e0241e48ab57001ef399c94</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M216.01,-198C270.46,-198 335.43,-198 385.76,-198" />
<polygon fill="red" stroke="red" points="385.94,-201.5 395.94,-198 385.94,-194.5 385.94,-201.5" />
<text text-anchor="middle" x="284.38" y="-201.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Error</text>
</g>
<!-- 204a7578289341d09ed116d58214112d&#45;&gt;eff263edb0464e4bb7dccc21647a7f66 -->
<g id="edge6" class="edge">
<title>204a7578289341d09ed116d58214112d-&gt;eff263edb0464e4bb7dccc21647a7f66</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M252,-36.02C252,-84.71 252,-219.2 252,-277.94" />
<polygon fill="blue" stroke="blue" points="248.5,-277.99 252,-287.99 255.5,-277.99 248.5,-277.99" />
<text text-anchor="middle" x="233.5" y="-160.58" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Abort</text>
</g>
<!-- 204a7578289341d09ed116d58214112d&#45;&gt;396782dd50e34646a418e734fe2a8b3d -->
<g id="edge3" class="edge">
<title>204a7578289341d09ed116d58214112d-&gt;396782dd50e34646a418e734fe2a8b3d</title>
<path fill="none" stroke="#7b8894" d="M222.01,-36.31C188.21,-68.39 136.69,-133.34 115.83,-170.68" />
<polygon fill="#7b8894" stroke="#7b8894" points="112.5,-169.5 111.01,-179.99 118.72,-172.72 112.5,-169.5" />
<text text-anchor="middle" x="145.42" y="-107.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Repeat</text>
</g>
<!-- 204a7578289341d09ed116d58214112d&#45;&gt;222fcb2e2e0241e48ab57001ef399c94 -->
<g id="edge4" class="edge">
<title>204a7578289341d09ed116d58214112d-&gt;222fcb2e2e0241e48ab57001ef399c94</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M273.9,-36.25C312.67,-68.56 393.46,-135.88 437.6,-172.66" />
<polygon fill="red" stroke="red" points="435.47,-175.45 445.39,-179.16 439.95,-170.07 435.47,-175.45" />
<text text-anchor="middle" x="339.25" y="-108.06" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Error</text>
</g>
</g>
</svg></div>

<h2 id="preview-state">Preview State</h2>

<p>This state is is the entry point to the system. It is the default state at start up and will also be the state that the system will revert to upon detecting an error that does not crash the system.</p>

<h3 id="preview-state-logic">Preview State Logic</h3>

<p>Upon entering this state the system will continuously acquire images from the XIMEA camera and each image frame will be minimally processed. The images are then JPEG encoded and sent to python which pushes them to a websocket to display on a browser based UI.</p>

<div class="diagram"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0.00 0.00 1664.74 1246.51">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(144 1102.51)">
<title>%3</title>
<g id="clust1" class="cluster">
<title>cluster_opencv_graph</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M512.08,-343.68C512.08,-343.68 1083.07,-343.68 1083.07,-343.68 1089.07,-343.68 1095.07,-349.68 1095.07,-355.68 1095.07,-355.68 1095.07,-856.37 1095.07,-856.37 1095.07,-862.37 1089.07,-868.37 1083.07,-868.37 1083.07,-868.37 512.08,-868.37 512.08,-868.37 506.08,-868.37 500.08,-862.37 500.08,-856.37 500.08,-856.37 500.08,-355.68 500.08,-355.68 500.08,-349.68 506.08,-343.68 512.08,-343.68" />
<text text-anchor="middle" x="550.58" y="-854.77" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">opencv_graph</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_pyTEMCA</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M153.71,-161.42C153.71,-161.42 401.02,-161.42 401.02,-161.42 407.02,-161.42 413.02,-167.42 413.02,-173.42 413.02,-173.42 413.02,-419.82 413.02,-419.82 413.02,-425.82 407.02,-431.82 401.02,-431.82 401.02,-431.82 153.71,-431.82 153.71,-431.82 147.71,-431.82 141.71,-425.82 141.71,-419.82 141.71,-419.82 141.71,-173.42 141.71,-173.42 141.71,-167.42 147.71,-161.42 153.71,-161.42" />
<text text-anchor="middle" x="178.21" y="-418.22" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">pyTEMCA</text>
</g>
<!-- ed82e1c7738140268b7a07cb657729bd -->
<g id="node1" class="node">
<title>ed82e1c7738140268b7a07cb657729bd</title>
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="994.069" y="-856.683" />
<text text-anchor="middle" x="1044.57" y="-734.97" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Acquire Image</text>
</g>
<!-- 7fc396d7a0b241949f46019307e2618b -->
<g id="node2" class="node">
<title>7fc396d7a0b241949f46019307e2618b</title>
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="807.149" y="-736.713" />
<text text-anchor="middle" x="857.65" y="-614.5" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Flat Field Correction</text>
<text text-anchor="middle" x="857.65" y="-600.5" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">and CLAHE (CUDA)</text>
</g>
<!-- ed82e1c7738140268b7a07cb657729bd&#45;&gt;7fc396d7a0b241949f46019307e2618b -->
<g id="edge1" class="edge">
<title>ed82e1c7738140268b7a07cb657729bd-&gt;7fc396d7a0b241949f46019307e2618b</title>
<path fill="none" stroke="#7b8894" d="M993.99,-767.4C970.19,-752.13 941.67,-733.83 916.87,-717.91" />
<polygon fill="#7b8894" stroke="#7b8894" points="918.58,-714.85 908.27,-712.39 914.8,-720.74 918.58,-714.85" />
</g>
<!-- 98f66bcc9f0047dcab84d12f6bdae944 -->
<g id="node3" class="node">
<title>98f66bcc9f0047dcab84d12f6bdae944</title>
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="752.823" y="-483.493" />
<text text-anchor="middle" x="803.32" y="-361.28" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Calculate Stats</text>
<text text-anchor="middle" x="803.32" y="-347.28" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">(Min/Max/Mean)</text>
</g>
<!-- 7fc396d7a0b241949f46019307e2618b&#45;&gt;98f66bcc9f0047dcab84d12f6bdae944 -->
<g id="edge4" class="edge">
<title>7fc396d7a0b241949f46019307e2618b-&gt;98f66bcc9f0047dcab84d12f6bdae944</title>
<path fill="none" stroke="#7b8894" d="M839.79,-596.64C834.52,-572.08 828.72,-545.04 823.32,-519.9" />
<polygon fill="#7b8894" stroke="#7b8894" points="826.72,-519.04 821.2,-510 819.87,-520.51 826.72,-519.04" />
</g>
<!-- 3e98101febf540e5919354fdee85bd34 -->
<g id="node4" class="node">
<title>3e98101febf540e5919354fdee85bd34</title>
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="551.591" y="-795.155" />
<text text-anchor="middle" x="602.09" y="-673.44" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Calculate FFT Focus Score</text>
</g>
<!-- 7fc396d7a0b241949f46019307e2618b&#45;&gt;3e98101febf540e5919354fdee85bd34 -->
<g id="edge6" class="edge">
<title>7fc396d7a0b241949f46019307e2618b-&gt;3e98101febf540e5919354fdee85bd34</title>
<path fill="none" stroke="#7b8894" d="M806.85,-691.52C765.39,-701 706.7,-714.42 662.77,-724.47" />
<polygon fill="#7b8894" stroke="#7b8894" points="661.76,-721.11 652.79,-726.75 663.32,-727.93 661.76,-721.11" />
</g>
<!-- 9d73559bc8d44829a479a3e530918bbc -->
<g id="node5" class="node">
<title>9d73559bc8d44829a479a3e530918bbc</title>
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="646.307" y="-650.155" />
<text text-anchor="middle" x="696.81" y="-528.44" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">JPEG Compress</text>
</g>
<!-- 7fc396d7a0b241949f46019307e2618b&#45;&gt;9d73559bc8d44829a479a3e530918bbc -->
<g id="edge2" class="edge">
<title>7fc396d7a0b241949f46019307e2618b-&gt;9d73559bc8d44829a479a3e530918bbc</title>
<path fill="none" stroke="#7b8894" d="M806.76,-652.51C790.76,-643.9 772.95,-634.32 756.41,-625.42" />
<polygon fill="#7b8894" stroke="#7b8894" points="757.83,-622.21 747.37,-620.55 754.51,-628.37 757.83,-622.21" />
</g>
<!-- e4d7512b2ee449acab02b57b04b9c817 -->
<g id="node6" class="node">
<title>e4d7512b2ee449acab02b57b04b9c817</title>
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="500.08" y="-538.961" />
<text text-anchor="middle" x="550.58" y="-416.75" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Send to Python</text>
<text text-anchor="middle" x="550.58" y="-402.75" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">via pybind11</text>
</g>
<!-- 98f66bcc9f0047dcab84d12f6bdae944&#45;&gt;e4d7512b2ee449acab02b57b04b9c817 -->
<g id="edge5" class="edge">
<title>98f66bcc9f0047dcab84d12f6bdae944-&gt;e4d7512b2ee449acab02b57b04b9c817</title>
<path fill="none" stroke="#7b8894" d="M752.78,-437.77C712.02,-446.72 654.56,-459.33 611.3,-468.82" />
<polygon fill="#7b8894" stroke="#7b8894" points="610.48,-465.42 601.46,-470.98 611.98,-472.26 610.48,-465.42" />
</g>
<!-- 3e98101febf540e5919354fdee85bd34&#45;&gt;e4d7512b2ee449acab02b57b04b9c817 -->
<g id="edge7" class="edge">
<title>3e98101febf540e5919354fdee85bd34-&gt;e4d7512b2ee449acab02b57b04b9c817</title>
<path fill="none" stroke="#7b8894" d="M588.29,-669.69C582.48,-640.8 575.63,-606.73 569.37,-575.61" />
<polygon fill="#7b8894" stroke="#7b8894" points="572.76,-574.73 567.36,-565.62 565.9,-576.11 572.76,-574.73" />
</g>
<!-- 9d73559bc8d44829a479a3e530918bbc&#45;&gt;e4d7512b2ee449acab02b57b04b9c817 -->
<g id="edge3" class="edge">
<title>9d73559bc8d44829a479a3e530918bbc-&gt;e4d7512b2ee449acab02b57b04b9c817</title>
<path fill="none" stroke="#7b8894" d="M646.07,-554.76C634.28,-545.79 621.62,-536.17 609.51,-526.96" />
<polygon fill="#7b8894" stroke="#7b8894" points="611.3,-523.93 601.22,-520.66 607.06,-529.5 611.3,-523.93" />
</g>
<!-- a591cba4bad944c095650b4df0fff140 -->
<g id="node7" class="node">
<title>a591cba4bad944c095650b4df0fff140</title>
<image xlink:href="/icons/python.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="312.016" y="-413.815" />
<text text-anchor="middle" x="362.52" y="-298.42" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Encode Image</text>
</g>
<!-- e4d7512b2ee449acab02b57b04b9c817&#45;&gt;a591cba4bad944c095650b4df0fff140 -->
<g id="edge8" class="edge">
<title>e4d7512b2ee449acab02b57b04b9c817-&gt;a591cba4bad944c095650b4df0fff140</title>
<path fill="none" stroke="#7b8894" d="M499.69,-449.99C475.65,-434.8 446.82,-416.58 421.8,-400.77" />
<polygon fill="#7b8894" stroke="#7b8894" points="423.45,-397.68 413.12,-395.29 419.71,-403.59 423.45,-397.68" />
</g>
<!-- 45bc318cbc7e4afcbce22d6ff7ce3d49 -->
<g id="node8" class="node">
<title>45bc318cbc7e4afcbce22d6ff7ce3d49</title>
<image xlink:href="/icons/python.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="141.713" y="-280.422" />
<text text-anchor="middle" x="192.21" y="-165.02" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Publish Image</text>
</g>
<!-- a591cba4bad944c095650b4df0fff140&#45;&gt;45bc318cbc7e4afcbce22d6ff7ce3d49 -->
<g id="edge9" class="edge">
<title>a591cba4bad944c095650b4df0fff140-&gt;45bc318cbc7e4afcbce22d6ff7ce3d49</title>
<path fill="none" stroke="#7b8894" d="M311.88,-323.65C292.75,-308.67 270.82,-291.49 251,-275.97" />
<polygon fill="#7b8894" stroke="#7b8894" points="252.98,-273.07 242.95,-269.66 248.66,-278.58 252.98,-273.07" />
</g>
<!-- d182cd31d62e41b1bb1c0baf2607fd6b -->
<g id="node9" class="node">
<title>d182cd31d62e41b1bb1c0baf2607fd6b</title>
<image xlink:href="/icons/user.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="0" y="-119" />
<text text-anchor="middle" x="50.5" y="-3.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Web UI</text>
</g>
<!-- 45bc318cbc7e4afcbce22d6ff7ce3d49&#45;&gt;d182cd31d62e41b1bb1c0baf2607fd6b -->
<g id="edge10" class="edge">
<title>45bc318cbc7e4afcbce22d6ff7ce3d49-&gt;d182cd31d62e41b1bb1c0baf2607fd6b</title>
<path fill="none" stroke="#7b8894" d="M141.45,-172.1C130.6,-159.74 119.06,-146.6 107.98,-133.97" />
<polygon fill="#7b8894" stroke="#7b8894" points="110.37,-131.39 101.14,-126.19 105.11,-136.01 110.37,-131.39" />
</g>
<!-- a086d90a6c9b474d9ddcb65c49f2727e -->
<g id="node10" class="node">
<title>a086d90a6c9b474d9ddcb65c49f2727e</title>
<image xlink:href="/icons/decision.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1190.06" y="-940.511" />
<text text-anchor="middle" x="1240.56" y="-825.11" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">State Changed?</text>
</g>
<!-- a086d90a6c9b474d9ddcb65c49f2727e&#45;&gt;ed82e1c7738140268b7a07cb657729bd -->
<g id="edge12" class="edge">
<title>a086d90a6c9b474d9ddcb65c49f2727e-&gt;ed82e1c7738140268b7a07cb657729bd</title>
<path fill="none" stroke="#7b8894" d="M1189.84,-866.68C1163.76,-854.69 1131.81,-840 1104.53,-827.45" />
<polygon fill="#7b8894" stroke="#7b8894" points="1105.63,-824.1 1095.09,-823.1 1102.71,-830.46 1105.63,-824.1" />
</g>
<!-- a086d90a6c9b474d9ddcb65c49f2727e&#45;&gt;a086d90a6c9b474d9ddcb65c49f2727e -->
<g id="edge11" class="edge">
<title>a086d90a6c9b474d9ddcb65c49f2727e-&gt;a086d90a6c9b474d9ddcb65c49f2727e</title>
<path fill="none" stroke="#7b8894" d="M1291.54,-905.88C1314.34,-907.4 1334.06,-902.11 1334.06,-890.01 1334.06,-879.76 1319.89,-874.4 1301.69,-873.92" />
<polygon fill="#7b8894" stroke="#7b8894" points="1301.46,-870.42 1291.54,-874.14 1301.61,-877.42 1301.46,-870.42" />
<text text-anchor="middle" x="1353.24" y="-895.23" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Repeat</text>
</g>
</g>
</svg></div>

<h2 id="change-aperture-state">Change Aperture State</h2>

<p>The Change Aperture State represents a state for moving to an aperture on a grid tape or stick16.</p>

<h3 id="change-aperture-state-logic">Change Aperture State Logic</h3>

<p>Upon entering this state it handles the entry logic for the state and initializes tape_ranges if it is None. It tries to fetch barcode values from TEM_db (if using tape); otherwise, it sets default values.</p>

<p>Next the code performs the following:</p>

<ol>
  <li>
    <p>Initialization and Logging:
 Clears lists related to aperture critical and error events.
 Logs the action of changing the aperture.</p>
  </li>
  <li>
    <p>State Check for Pause:
 Checks if the current montage state is PAUSE. If yes, it schedules the _change_aperture method to run again after 0.2 seconds and exits the current execution.</p>
  </li>
  <li>
    <p>Preparatory Actions:
 Updates beam center results and informs the system that a new montage is starting.</p>
  </li>
  <li>Abort Conditions Check:
 Checks several conditions to decide whether to abort the operation:
    <ul>
      <li>If required media information is missing.</li>
      <li>If environmental conditions are not suitable.</li>
      <li>If there’s a pending request to abort at the end of the montage.</li>
      <li>If there is insufficient disk space.</li>
      <li>If too many errors have accumulated (default is 3).</li>
    </ul>
  </li>
  <li>Handling of Tape and Aperture:
 Retrieves the next task object (TAO) from the montage controller.
 If a valid TAO is found:
    <ul>
      <li>Checks if the destination directory exists or needs to be created.</li>
      <li>Checks for existing data that might require an abort.</li>
      <li>Performs adjustments based on the first Region of Interest (ROI) from tao.</li>
    </ul>
  </li>
  <li>
    <p>Aperture Movement and Correction:
 Manages movement to the correct grid or aperture based on the tape controller status.
 Deals with potential barcode errors and adjusts based on confidence levels in the barcode readings.</p>
  </li>
  <li>
    <p>Lens and Beam Adjustments:
 Adjusts the beam’s brightness and attempts to find a centroid for the aperture if needed.
 Conducts a quality check on the beam’s brightness and might abort if the beam mean value is too low.
 Manages autocentering of the beam if necessary.</p>
  </li>
  <li>
    <p>Brightfield Imaging:
 Handles brightfield imaging conditions and might abort based on the quality of consecutive brightfield images.</p>
  </li>
  <li>
    <p>Lens Correction Montage:
 Decides whether a new lens correction montage is necessary based on time intervals and changes in lens conditions.</p>
  </li>
  <li>Finalizing and Error Handling:
If no ROIs are found in tao, logs the event but continues processing.
If there are still tasks (taos) left in the montage queue, it triggers the start of another attempt.
Sets the montage state to NONE if no tasks are left.</li>
</ol>

<div class="diagram"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0.00 0.00 2047.81 1527.13">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(144 1383.13)">
<title>%3</title>
<g id="clust1" class="cluster">
<title>cluster_Change Aperture State</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M12,0C12,0 1747.81,0 1747.81,0 1753.81,0 1759.81,-6 1759.81,-12 1759.81,-12 1759.81,-1227.13 1759.81,-1227.13 1759.81,-1233.13 1753.81,-1239.13 1747.81,-1239.13 1747.81,-1239.13 12,-1239.13 12,-1239.13 6,-1239.13 0,-1233.13 0,-1227.13 0,-1227.13 0,-12 0,-12 0,-6 6,0 12,0" />
<text text-anchor="middle" x="77" y="-1225.53" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Change Aperture State</text>
</g>
<!-- 1115f4d078be4b96a3fc4ba2e28bc7b3 -->
<g id="node1" class="node">
<title>1115f4d078be4b96a3fc4ba2e28bc7b3</title>
<image xlink:href="/icons/start-end.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="0" y="-300.001" />
<text text-anchor="middle" x="50.5" y="-184.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Enter State</text>
</g>
<!-- 7646b85a1b8a4bf09e09b9a7b80998fe -->
<g id="node2" class="node">
<title>7646b85a1b8a4bf09e09b9a7b80998fe</title>
<image xlink:href="/icons/decision.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="175.388" y="-292.824" />
<text text-anchor="middle" x="225.89" y="-177.42" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Initialize tape_ranges</text>
</g>
<!-- 1115f4d078be4b96a3fc4ba2e28bc7b3&#45;&gt;7646b85a1b8a4bf09e09b9a7b80998fe -->
<g id="edge1" class="edge">
<title>1115f4d078be4b96a3fc4ba2e28bc7b3-&gt;7646b85a1b8a4bf09e09b9a7b80998fe</title>
<path fill="none" stroke="#7b8894" d="M101.23,-247.43C121.23,-246.61 144.36,-245.66 165.23,-244.81" />
<polygon fill="#7b8894" stroke="#7b8894" points="165.42,-248.3 175.27,-244.39 165.14,-241.31 165.42,-248.3" />
</g>
<!-- 59f5fcea361f4fa98188ce5d0f3a06e4 -->
<g id="node3" class="node">
<title>59f5fcea361f4fa98188ce5d0f3a06e4</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="193.831" y="-119" />
<text text-anchor="middle" x="244.33" y="-3.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Fetch Barcode from TEM_db</text>
</g>
<!-- 7646b85a1b8a4bf09e09b9a7b80998fe&#45;&gt;59f5fcea361f4fa98188ce5d0f3a06e4 -->
<g id="edge2" class="edge">
<title>7646b85a1b8a4bf09e09b9a7b80998fe-&gt;59f5fcea361f4fa98188ce5d0f3a06e4</title>
<path fill="none" stroke="#7b8894" d="M233.18,-173.62C234.09,-165.03 235.03,-156.19 235.95,-147.45" />
<polygon fill="#7b8894" stroke="#7b8894" points="239.46,-147.58 237.03,-137.27 232.5,-146.84 239.46,-147.58" />
</g>
<!-- 7d10549829dc4988aed19671cd299b33 -->
<g id="node4" class="node">
<title>7d10549829dc4988aed19671cd299b33</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="288.652" y="-424.522" />
<text text-anchor="middle" x="339.15" y="-309.12" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Initialization &amp; Logging</text>
</g>
<!-- 7646b85a1b8a4bf09e09b9a7b80998fe&#45;&gt;7d10549829dc4988aed19671cd299b33 -->
<g id="edge3" class="edge">
<title>7646b85a1b8a4bf09e09b9a7b80998fe-&gt;7d10549829dc4988aed19671cd299b33</title>
<path fill="none" stroke="#7b8894" d="M276.56,-301.24C278.31,-303.28 280.07,-305.32 281.83,-307.37" />
<polygon fill="#7b8894" stroke="#7b8894" points="279.44,-309.96 288.61,-315.26 284.74,-305.39 279.44,-309.96" />
</g>
<!-- 1c02491dd53d4b0087e5b701a3ba95a7 -->
<g id="node5" class="node">
<title>1c02491dd53d4b0087e5b701a3ba95a7</title>
<image xlink:href="/icons/decision.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="374.771" y="-579.121" />
<text text-anchor="middle" x="425.27" y="-463.72" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Check if State is PAUSE</text>
</g>
<!-- 7d10549829dc4988aed19671cd299b33&#45;&gt;1c02491dd53d4b0087e5b701a3ba95a7 -->
<g id="edge4" class="edge">
<title>7d10549829dc4988aed19671cd299b33-&gt;1c02491dd53d4b0087e5b701a3ba95a7</title>
<path fill="none" stroke="#7b8894" d="M377.43,-442.73C378.95,-445.47 380.48,-448.21 382.01,-450.96" />
<polygon fill="#7b8894" stroke="#7b8894" points="378.97,-452.7 386.9,-459.73 385.09,-449.29 378.97,-452.7" />
</g>
<!-- d65adf667df343228c2ce264087cc9bc -->
<g id="node6" class="node">
<title>d65adf667df343228c2ce264087cc9bc</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="266.668" y="-724.121" />
<text text-anchor="middle" x="317.17" y="-608.72" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Retry after 0.2s</text>
</g>
<!-- 1c02491dd53d4b0087e5b701a3ba95a7&#45;&gt;d65adf667df343228c2ce264087cc9bc -->
<g id="edge6" class="edge">
<title>1c02491dd53d4b0087e5b701a3ba95a7-&gt;d65adf667df343228c2ce264087cc9bc</title>
<path fill="none" stroke="#7b8894" d="M374.71,-571.1C367.99,-579.27 361.21,-588.06 354.75,-596.92" />
<polygon fill="#7b8894" stroke="#7b8894" points="351.89,-594.9 348.92,-605.07 357.59,-598.97 351.89,-594.9" />
</g>
<!-- 4a58a6b003db495db13b6f8bb4384868 -->
<g id="node7" class="node">
<title>4a58a6b003db495db13b6f8bb4384868</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="546.066" y="-609.88" />
<text text-anchor="middle" x="596.57" y="-494.48" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Preparatory Actions</text>
</g>
<!-- 1c02491dd53d4b0087e5b701a3ba95a7&#45;&gt;4a58a6b003db495db13b6f8bb4384868 -->
<g id="edge5" class="edge">
<title>1c02491dd53d4b0087e5b701a3ba95a7-&gt;4a58a6b003db495db13b6f8bb4384868</title>
<path fill="none" stroke="#7b8894" d="M476.2,-537.77C494.93,-541.13 516.32,-544.97 535.83,-548.47" />
<polygon fill="#7b8894" stroke="#7b8894" points="535.37,-551.95 545.83,-550.27 536.61,-545.06 535.37,-551.95" />
</g>
<!-- d65adf667df343228c2ce264087cc9bc&#45;&gt;1c02491dd53d4b0087e5b701a3ba95a7 -->
<g id="edge7" class="edge">
<title>d65adf667df343228c2ce264087cc9bc-&gt;1c02491dd53d4b0087e5b701a3ba95a7</title>
<path fill="none" stroke="#7b8894" d="M367.98,-631.97C374.89,-623.62 381.86,-614.62 388.47,-605.52" />
<polygon fill="#7b8894" stroke="#7b8894" points="391.47,-607.33 394.43,-597.16 385.77,-603.27 391.47,-607.33" />
</g>
<!-- 9d1b2398edc843fa93b3815d28ca2f87 -->
<g id="node8" class="node">
<title>9d1b2398edc843fa93b3815d28ca2f87</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="704.898" y="-654.011" />
<text text-anchor="middle" x="755.4" y="-538.61" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Check Abort Conditions</text>
</g>
<!-- 4a58a6b003db495db13b6f8bb4384868&#45;&gt;9d1b2398edc843fa93b3815d28ca2f87 -->
<g id="edge8" class="edge">
<title>4a58a6b003db495db13b6f8bb4384868-&gt;9d1b2398edc843fa93b3815d28ca2f87</title>
<path fill="none" stroke="#7b8894" d="M647.26,-573.46C662.45,-577.68 679.25,-582.35 695,-586.73" />
<polygon fill="#7b8894" stroke="#7b8894" points="694.07,-590.1 704.64,-589.41 695.95,-583.36 694.07,-590.1" />
</g>
<!-- 0f42c94890ee49dda1520046f11e9a09 -->
<g id="node9" class="node">
<title>0f42c94890ee49dda1520046f11e9a09</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="858.844" y="-704.767" />
<text text-anchor="middle" x="909.34" y="-589.37" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Handle Tape &amp; Aperture</text>
</g>
<!-- 9d1b2398edc843fa93b3815d28ca2f87&#45;&gt;0f42c94890ee49dda1520046f11e9a09 -->
<g id="edge9" class="edge">
<title>9d1b2398edc843fa93b3815d28ca2f87-&gt;0f42c94890ee49dda1520046f11e9a09</title>
<path fill="none" stroke="#7b8894" d="M806.23,-620.27C819.97,-624.8 834.96,-629.74 849.15,-634.42" />
<polygon fill="#7b8894" stroke="#7b8894" points="848.23,-637.8 858.83,-637.61 850.42,-631.16 848.23,-637.8" />
</g>
<!-- 2a57a884d35249b494fd985f54a5a353 -->
<g id="node10" class="node">
<title>2a57a884d35249b494fd985f54a5a353</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1008.92" y="-763.18" />
<text text-anchor="middle" x="1059.42" y="-647.78" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Aperture Movement &amp; Correction</text>
</g>
<!-- 0f42c94890ee49dda1520046f11e9a09&#45;&gt;2a57a884d35249b494fd985f54a5a353 -->
<g id="edge10" class="edge">
<title>0f42c94890ee49dda1520046f11e9a09-&gt;2a57a884d35249b494fd985f54a5a353</title>
<path fill="none" stroke="#7b8894" d="M960.15,-674.04C972.81,-678.97 986.5,-684.3 999.55,-689.38" />
<polygon fill="#7b8894" stroke="#7b8894" points="998.33,-692.66 1008.92,-693.02 1000.87,-686.13 998.33,-692.66" />
</g>
<!-- a790ed286f204da7a7c229b9b19c9d00 -->
<g id="node11" class="node">
<title>a790ed286f204da7a7c229b9b19c9d00</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1153.58" y="-832.842" />
<text text-anchor="middle" x="1204.08" y="-717.44" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Lens &amp; Beam Adjustments</text>
</g>
<!-- 2a57a884d35249b494fd985f54a5a353&#45;&gt;a790ed286f204da7a7c229b9b19c9d00 -->
<g id="edge11" class="edge">
<title>2a57a884d35249b494fd985f54a5a353-&gt;a790ed286f204da7a7c229b9b19c9d00</title>
<path fill="none" stroke="#7b8894" d="M1110.02,-737.04C1121.07,-742.37 1132.88,-748.05 1144.26,-753.53" />
<polygon fill="#7b8894" stroke="#7b8894" points="1142.74,-756.69 1153.27,-757.87 1145.78,-750.38 1142.74,-756.69" />
</g>
<!-- 09013f7c1f27449d929c2569c4bda064 -->
<g id="node12" class="node">
<title>09013f7c1f27449d929c2569c4bda064</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1291.15" y="-915.103" />
<text text-anchor="middle" x="1341.65" y="-799.7" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Brightfield Imaging</text>
</g>
<!-- a790ed286f204da7a7c229b9b19c9d00&#45;&gt;09013f7c1f27449d929c2569c4bda064 -->
<g id="edge12" class="edge">
<title>a790ed286f204da7a7c229b9b19c9d00-&gt;09013f7c1f27449d929c2569c4bda064</title>
<path fill="none" stroke="#7b8894" d="M1254.92,-812.74C1263.85,-818.08 1273.22,-823.68 1282.35,-829.15" />
<polygon fill="#7b8894" stroke="#7b8894" points="1280.65,-832.2 1291.02,-834.33 1284.24,-826.19 1280.65,-832.2" />
</g>
<!-- a45b7095a07641708e8c7b3230b4d0a2 -->
<g id="node13" class="node">
<title>a45b7095a07641708e8c7b3230b4d0a2</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1423.63" y="-1004.99" />
<text text-anchor="middle" x="1474.13" y="-889.59" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Lens Correction Montage</text>
</g>
<!-- 09013f7c1f27449d929c2569c4bda064&#45;&gt;a45b7095a07641708e8c7b3230b4d0a2 -->
<g id="edge13" class="edge">
<title>09013f7c1f27449d929c2569c4bda064-&gt;a45b7095a07641708e8c7b3230b4d0a2</title>
<path fill="none" stroke="#7b8894" d="M1392.49,-899.1C1399.73,-904.01 1407.22,-909.1 1414.61,-914.11" />
<polygon fill="#7b8894" stroke="#7b8894" points="1412.96,-917.22 1423.2,-919.94 1416.89,-911.43 1412.96,-917.22" />
</g>
<!-- 137c411f1abf4c9b833db894925d00b8 -->
<g id="node14" class="node">
<title>137c411f1abf4c9b833db894925d00b8</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1546.81" y="-1107.11" />
<text text-anchor="middle" x="1597.31" y="-991.71" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Finalizing &amp; Error Handling</text>
</g>
<!-- a45b7095a07641708e8c7b3230b4d0a2&#45;&gt;137c411f1abf4c9b833db894925d00b8 -->
<g id="edge14" class="edge">
<title>a45b7095a07641708e8c7b3230b4d0a2-&gt;137c411f1abf4c9b833db894925d00b8</title>
<path fill="none" stroke="#7b8894" d="M1524.94,-996.61C1529.53,-1000.41 1534.19,-1004.28 1538.84,-1008.13" />
<polygon fill="#7b8894" stroke="#7b8894" points="1536.68,-1010.89 1546.61,-1014.58 1541.15,-1005.5 1536.68,-1010.89" />
</g>
<!-- 09ff729319a6442787a211cb030c1c78 -->
<g id="node15" class="node">
<title>09ff729319a6442787a211cb030c1c78</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1658.81" y="-1221.13" />
<text text-anchor="middle" x="1709.31" y="-1105.73" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Set State to NONE</text>
</g>
<!-- 137c411f1abf4c9b833db894925d00b8&#45;&gt;09ff729319a6442787a211cb030c1c78 -->
<g id="edge15" class="edge">
<title>137c411f1abf4c9b833db894925d00b8-&gt;09ff729319a6442787a211cb030c1c78</title>
<path fill="none" stroke="#7b8894" d="M1648.07,-1108.28C1649.15,-1109.39 1650.24,-1110.49 1651.33,-1111.6" />
<polygon fill="#7b8894" stroke="#7b8894" points="1649.01,-1114.23 1658.51,-1118.92 1654,-1109.33 1649.01,-1114.23" />
</g>
</g>
</svg></div>

<h2 id="acquisition-state">Acquisition State</h2>

<p>The Acquisition State represents the overall state of the acquisition loop in the system for imaging and processing data. It manages tasks related to moving the stage, capturing images, processing metadata, and handling various states during the acquisition process.</p>

<h3 id="acquisition-state-logic">Acquisition State Logic</h3>

<h4 id="main-acquisition-loop-activation">Main Acquisition Loop Activation</h4>

<p>The acquisition starts if both the main_acquisition_loop_active_event is set and _start_new_aperture() returns True.
Initialize variables and prepare for the acquisition sequence within a specific aperture.</p>

<h4 id="roi-acquisition-process">ROI Acquisition Process</h4>

<p>Iterate over each ROI in roi_list.</p>

<p>For each ROI:</p>

<ul>
  <li>Initialize the ROI and calculate the starting position.</li>
  <li>Move the stage to the initial position and wait for it to stabilize.</li>
  <li>Enter a nested loop to handle image capture for each tile in the ROI until there are no more positions to move to.
    <ul>
      <li>Set metadata for the image.</li>
      <li>Start camera exposure.</li>
      <li>If there was a previous image, wait for asynchronous processes to complete and possibly write metadata.</li>
      <li>Wait for the current exposure to complete.</li>
      <li>Get the next position and move the stage.</li>
      <li>Handle synchronization and stabilization of the stage.</li>
    </ul>
  </li>
  <li>After completing all tiles in the ROI, perform final processing such as writing metadata and resetting the stage to the starting position.</li>
</ul>

<h4 id="lens-correction-process">Lens Correction Process</h4>

<p>If lens correction is part of the current montage, attempt to correct lens distortions using template matching and solving algorithms. Multiple attempts are made, and if unsuccessful, a critical error event is logged.</p>

<h4 id="completion-and-metadata-handling">Completion and Metadata Handling</h4>

<p>Finalize the metadata file and write results to a database.
Create a robocopy file if not aborting.</p>

<h4 id="abort-or-switch-event">Abort or Switch Event</h4>

<p>If an abort signal is received or it’s time to switch to another aperture, the loop is terminated or adjusted accordingly.</p>

<h4 id="event-scheduling">Event Scheduling</h4>

<p>Schedule callbacks for events like “BACK_TO_SETUP” or “NEXT_APERTURE” based on the conditions met during the loop.</p>

<div class="diagram"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0.00 0.00 1607.97 1324.19">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(144 1180.19)">
<title>%3</title>
<g id="clust1" class="cluster">
<title>cluster_Outer Infinite Loop</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M12,-427.02C12,-427.02 89.56,-427.02 89.56,-427.02 95.56,-427.02 101.56,-433.02 101.56,-439.02 101.56,-439.02 101.56,-722.33 101.56,-722.33 101.56,-728.33 95.56,-734.33 89.56,-734.33 89.56,-734.33 12,-734.33 12,-734.33 6,-734.33 0,-728.33 0,-722.33 0,-722.33 0,-439.02 0,-439.02 0,-433.02 6,-427.02 12,-427.02" />
<text text-anchor="middle" x="64.5" y="-720.73" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Outer Infinite Loop</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_Main Acquisition</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M77.03,-148.41C77.03,-148.41 272.04,-148.41 272.04,-148.41 278.04,-148.41 284.04,-154.41 284.04,-160.41 284.04,-160.41 284.04,-394.88 284.04,-394.88 284.04,-400.88 278.04,-406.88 272.04,-406.88 272.04,-406.88 77.03,-406.88 77.03,-406.88 71.03,-406.88 65.03,-400.88 65.03,-394.88 65.03,-394.88 65.03,-160.41 65.03,-160.41 65.03,-154.41 71.03,-148.41 77.03,-148.41" />
<text text-anchor="middle" x="121.53" y="-393.28" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Main Acquisition</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_ROI Acquisition Process</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M347.11,-61.53C347.11,-61.53 952.74,-61.53 952.74,-61.53 958.74,-61.53 964.74,-67.53 964.74,-73.53 964.74,-73.53 964.74,-650.65 964.74,-650.65 964.74,-656.65 958.74,-662.65 952.74,-662.65 952.74,-662.65 347.11,-662.65 347.11,-662.65 341.11,-662.65 335.11,-656.65 335.11,-650.65 335.11,-650.65 335.11,-73.53 335.11,-73.53 335.11,-67.53 341.11,-61.53 347.11,-61.53" />
<text text-anchor="middle" x="412.61" y="-649.05" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">ROI Acquisition Process</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_Per-Tile</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M827.77,0C827.77,0 1307.97,0 1307.97,0 1313.97,0 1319.97,-6 1319.97,-12 1319.97,-12 1319.97,-480.04 1319.97,-480.04 1319.97,-486.04 1313.97,-492.04 1307.97,-492.04 1307.97,-492.04 827.77,-492.04 827.77,-492.04 821.77,-492.04 815.77,-486.04 815.77,-480.04 815.77,-480.04 815.77,-12 815.77,-12 815.77,-6 821.77,0 827.77,0" />
<text text-anchor="middle" x="845.27" y="-478.44" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Per-Tile</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_Lens Correction Process</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M817.68,-682.46C817.68,-682.46 894.68,-682.46 894.68,-682.46 900.68,-682.46 906.68,-688.46 906.68,-694.46 906.68,-694.46 906.68,-807.46 906.68,-807.46 906.68,-813.46 900.68,-819.46 894.68,-819.46 894.68,-819.46 817.68,-819.46 817.68,-819.46 811.68,-819.46 805.68,-813.46 805.68,-807.46 805.68,-807.46 805.68,-694.46 805.68,-694.46 805.68,-688.46 811.68,-682.46 817.68,-682.46" />
<text text-anchor="middle" x="884.68" y="-805.86" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Lens Correction Process</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_Completion &amp; Metadata Handling</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M554.53,-805.82C554.53,-805.82 781.97,-805.82 781.97,-805.82 787.97,-805.82 793.97,-811.82 793.97,-817.82 793.97,-817.82 793.97,-1006.41 793.97,-1006.41 793.97,-1012.41 787.97,-1018.41 781.97,-1018.41 781.97,-1018.41 554.53,-1018.41 554.53,-1018.41 548.53,-1018.41 542.53,-1012.41 542.53,-1006.41 542.53,-1006.41 542.53,-817.82 542.53,-817.82 542.53,-811.82 548.53,-805.82 554.53,-805.82" />
<text text-anchor="middle" x="650.03" y="-1004.81" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Completion &amp; Metadata Handling</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_Abort or Switch Event</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M222.07,-854.7C222.07,-854.7 463.09,-854.7 463.09,-854.7 469.09,-854.7 475.09,-860.7 475.09,-866.7 475.09,-866.7 475.09,-1024.19 475.09,-1024.19 475.09,-1030.19 469.09,-1036.19 463.09,-1036.19 463.09,-1036.19 222.07,-1036.19 222.07,-1036.19 216.07,-1036.19 210.07,-1030.19 210.07,-1024.19 210.07,-1024.19 210.07,-866.7 210.07,-866.7 210.07,-860.7 216.07,-854.7 222.07,-854.7" />
<text text-anchor="middle" x="283.07" y="-1022.59" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Abort or Switch Event</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_Event Scheduling</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M87.5,-750.34C87.5,-750.34 164.5,-750.34 164.5,-750.34 170.5,-750.34 176.5,-756.34 176.5,-762.34 176.5,-762.34 176.5,-875.34 176.5,-875.34 176.5,-881.34 170.5,-887.34 164.5,-887.34 164.5,-887.34 87.5,-887.34 87.5,-887.34 81.5,-887.34 75.5,-881.34 75.5,-875.34 75.5,-875.34 75.5,-762.34 75.5,-762.34 75.5,-756.34 81.5,-750.34 87.5,-750.34" />
<text text-anchor="middle" x="135" y="-873.74" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Event Scheduling</text>
</g>
<!-- 0207ede744e64cad9ace781b69ad6544 -->
<g id="node1" class="node">
<title>0207ede744e64cad9ace781b69ad6544</title>
<image xlink:href="/icons/start-end.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="0" y="-546.019" />
<text text-anchor="middle" x="50.5" y="-430.62" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Start Outer Loop</text>
</g>
<!-- 1b5c9cbff0c142469e1a7d5f9150cdcb -->
<g id="node3" class="node">
<title>1b5c9cbff0c142469e1a7d5f9150cdcb</title>
<image xlink:href="/icons/decision.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="65.0272" y="-388.885" />
<text text-anchor="middle" x="115.53" y="-273.48" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Check Activation &amp; Start</text>
</g>
<!-- 0207ede744e64cad9ace781b69ad6544&#45;&gt;1b5c9cbff0c142469e1a7d5f9150cdcb -->
<g id="edge1" class="edge">
<title>0207ede744e64cad9ace781b69ad6544-&gt;1b5c9cbff0c142469e1a7d5f9150cdcb</title>
<path fill="none" stroke="#7b8894" d="M79.02,-426.6C80.39,-423.28 81.78,-419.94 83.16,-416.6" />
<polygon fill="#7b8894" stroke="#7b8894" points="86.45,-417.79 87.04,-407.22 79.99,-415.12 86.45,-417.79" />
</g>
<!-- 2572d1dd55b84598b23445e09015ec4c -->
<g id="node2" class="node">
<title>2572d1dd55b84598b23445e09015ec4c</title>
<image xlink:href="/icons/start-end.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="0.563752" y="-716.331" />
<text text-anchor="middle" x="51.06" y="-600.93" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">End Outer Loop</text>
</g>
<!-- 2572d1dd55b84598b23445e09015ec4c&#45;&gt;0207ede744e64cad9ace781b69ad6544 -->
<g id="edge22" class="edge">
<title>2572d1dd55b84598b23445e09015ec4c-&gt;0207ede744e64cad9ace781b69ad6544</title>
<path fill="none" stroke="#7b8894" d="M50.84,-597.05C50.81,-589.62 50.79,-582.02 50.76,-574.49" />
<polygon fill="#7b8894" stroke="#7b8894" points="54.26,-574.27 50.73,-564.28 47.26,-574.29 54.26,-574.27" />
</g>
<!-- 403d90ccfb2841f3902eab05980c5a9d -->
<g id="node4" class="node">
<title>403d90ccfb2841f3902eab05980c5a9d</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="183.038" y="-267.409" />
<text text-anchor="middle" x="233.54" y="-152.01" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Initialize &amp; Prepare Acquisition</text>
</g>
<!-- 1b5c9cbff0c142469e1a7d5f9150cdcb&#45;&gt;403d90ccfb2841f3902eab05980c5a9d -->
<g id="edge2" class="edge">
<title>1b5c9cbff0c142469e1a7d5f9150cdcb-&gt;403d90ccfb2841f3902eab05980c5a9d</title>
<path fill="none" stroke="#7b8894" d="M166.26,-286.16C169.44,-282.89 172.65,-279.59 175.85,-276.29" />
<polygon fill="#7b8894" stroke="#7b8894" points="178.39,-278.7 182.85,-269.09 173.37,-273.82 178.39,-278.7" />
</g>
<!-- 246dd198938a42d99cad69732ebb9cba -->
<g id="node5" class="node">
<title>246dd198938a42d99cad69732ebb9cba</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="335.114" y="-195.642" />
<text text-anchor="middle" x="385.61" y="-80.24" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">For Each ROI</text>
</g>
<!-- 403d90ccfb2841f3902eab05980c5a9d&#45;&gt;246dd198938a42d99cad69732ebb9cba -->
<g id="edge3" class="edge">
<title>403d90ccfb2841f3902eab05980c5a9d-&gt;246dd198938a42d99cad69732ebb9cba</title>
<path fill="none" stroke="#7b8894" d="M284.18,-193.01C297.45,-186.75 311.88,-179.94 325.59,-173.47" />
<polygon fill="#7b8894" stroke="#7b8894" points="327.39,-176.49 334.94,-169.06 324.4,-170.16 327.39,-176.49" />
</g>
<!-- 648861b7e90644e69fce2f21b2ec8d02 -->
<g id="node6" class="node">
<title>648861b7e90644e69fce2f21b2ec8d02</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="501.472" y="-180.534" />
<text text-anchor="middle" x="551.97" y="-65.13" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Initialize ROI &amp; Calculate Position</text>
</g>
<!-- 246dd198938a42d99cad69732ebb9cba&#45;&gt;648861b7e90644e69fce2f21b2ec8d02 -->
<g id="edge4" class="edge">
<title>246dd198938a42d99cad69732ebb9cba-&gt;648861b7e90644e69fce2f21b2ec8d02</title>
<path fill="none" stroke="#7b8894" d="M436.43,-140.53C453.76,-138.95 473.32,-137.18 491.35,-135.54" />
<polygon fill="#7b8894" stroke="#7b8894" points="491.82,-139.01 501.47,-134.62 491.19,-132.04 491.82,-139.01" />
</g>
<!-- d25c8277701a4f89849f0f01ddaea601 -->
<g id="node7" class="node">
<title>d25c8277701a4f89849f0f01ddaea601</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="660.952" y="-231.127" />
<text text-anchor="middle" x="711.45" y="-115.73" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Move &amp; Stabilize Stage</text>
</g>
<!-- 648861b7e90644e69fce2f21b2ec8d02&#45;&gt;d25c8277701a4f89849f0f01ddaea601 -->
<g id="edge5" class="edge">
<title>648861b7e90644e69fce2f21b2ec8d02-&gt;d25c8277701a4f89849f0f01ddaea601</title>
<path fill="none" stroke="#7b8894" d="M602.87,-146.18C618.2,-151.04 635.16,-156.42 651.04,-161.46" />
<polygon fill="#7b8894" stroke="#7b8894" points="650.17,-164.86 660.76,-164.55 652.29,-158.19 650.17,-164.86" />
</g>
<!-- 7dbba8ece69c4d8a8cc1c8c3af047eb1 -->
<g id="node9" class="node">
<title>7dbba8ece69c4d8a8cc1c8c3af047eb1</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="815.771" y="-309.846" />
<text text-anchor="middle" x="866.27" y="-194.45" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Set Metadata for Each Tile</text>
</g>
<!-- d25c8277701a4f89849f0f01ddaea601&#45;&gt;7dbba8ece69c4d8a8cc1c8c3af047eb1 -->
<g id="edge6" class="edge">
<title>d25c8277701a4f89849f0f01ddaea601-&gt;7dbba8ece69c4d8a8cc1c8c3af047eb1</title>
<path fill="none" stroke="#7b8894" d="M762.15,-206.4C776.39,-213.64 792,-221.58 806.71,-229.06" />
<polygon fill="#7b8894" stroke="#7b8894" points="805.23,-232.23 815.73,-233.65 808.4,-225.99 805.23,-232.23" />
</g>
<!-- de5207f55cfe48c9954564f3320eab75 -->
<g id="node8" class="node">
<title>de5207f55cfe48c9954564f3320eab75</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="863.738" y="-644.647" />
<text text-anchor="middle" x="914.24" y="-529.25" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Finalize ROI</text>
</g>
<!-- 7d2ec5baf02248eab8805a0ac55e75ee -->
<g id="node16" class="node">
<title>7d2ec5baf02248eab8805a0ac55e75ee</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="805.683" y="-801.461" />
<text text-anchor="middle" x="856.18" y="-686.06" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Correct Lens Distortions</text>
</g>
<!-- de5207f55cfe48c9954564f3320eab75&#45;&gt;7d2ec5baf02248eab8805a0ac55e75ee -->
<g id="edge15" class="edge">
<title>de5207f55cfe48c9954564f3320eab75-&gt;7d2ec5baf02248eab8805a0ac55e75ee</title>
<path fill="none" stroke="#7b8894" d="M888.77,-662.93C887.59,-666.14 886.39,-669.37 885.19,-672.6" />
<polygon fill="#7b8894" stroke="#7b8894" points="881.8,-671.68 881.61,-682.27 888.37,-674.11 881.8,-671.68" />
</g>
<!-- cf14a33dbebb4e5ab6ab23b52c438c9b -->
<g id="node10" class="node">
<title>cf14a33dbebb4e5ab6ab23b52c438c9b</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="924.771" y="-173.739" />
<text text-anchor="middle" x="975.27" y="-58.34" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Start Camera Exposure</text>
</g>
<!-- 7dbba8ece69c4d8a8cc1c8c3af047eb1&#45;&gt;cf14a33dbebb4e5ab6ab23b52c438c9b -->
<g id="edge7" class="edge">
<title>7dbba8ece69c4d8a8cc1c8c3af047eb1-&gt;cf14a33dbebb4e5ab6ab23b52c438c9b</title>
<path fill="none" stroke="#7b8894" d="M916.94,-196.07C917.34,-195.58 917.74,-195.08 918.14,-194.58" />
<polygon fill="#7b8894" stroke="#7b8894" points="921.11,-196.47 924.63,-186.48 915.64,-192.1 921.11,-196.47" />
</g>
<!-- c4979a402a724fcaa069e03bb0e6e932 -->
<g id="node11" class="node">
<title>c4979a402a724fcaa069e03bb0e6e932</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1081.77" y="-119" />
<text text-anchor="middle" x="1132.27" y="-3.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Handle Async &amp; Write Metadata</text>
</g>
<!-- cf14a33dbebb4e5ab6ab23b52c438c9b&#45;&gt;c4979a402a724fcaa069e03bb0e6e932 -->
<g id="edge8" class="edge">
<title>cf14a33dbebb4e5ab6ab23b52c438c9b-&gt;c4979a402a724fcaa069e03bb0e6e932</title>
<path fill="none" stroke="#7b8894" d="M1025.81,-105.62C1040.44,-100.52 1056.57,-94.89 1071.75,-89.6" />
<polygon fill="#7b8894" stroke="#7b8894" points="1073.27,-92.78 1081.56,-86.18 1070.96,-86.17 1073.27,-92.78" />
</g>
<!-- ea06601cf76f4500bef37b2eac357cd5 -->
<g id="node12" class="node">
<title>ea06601cf76f4500bef37b2eac357cd5</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1218.97" y="-214.084" />
<text text-anchor="middle" x="1269.47" y="-98.68" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Complete Exposure</text>
</g>
<!-- c4979a402a724fcaa069e03bb0e6e932&#45;&gt;ea06601cf76f4500bef37b2eac357cd5 -->
<g id="edge9" class="edge">
<title>c4979a402a724fcaa069e03bb0e6e932-&gt;ea06601cf76f4500bef37b2eac357cd5</title>
<path fill="none" stroke="#7b8894" d="M1182.97,-103.64C1191.85,-109.79 1201.17,-116.25 1210.26,-122.55" />
<polygon fill="#7b8894" stroke="#7b8894" points="1208.31,-125.46 1218.52,-128.28 1212.3,-119.7 1208.31,-125.46" />
</g>
<!-- b7533361e3264518bbfc3cbe0cfbabdc -->
<g id="node13" class="node">
<title>b7533361e3264518bbfc3cbe0cfbabdc</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1210.14" y="-380.806" />
<text text-anchor="middle" x="1260.64" y="-265.41" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Get Next Position</text>
</g>
<!-- ea06601cf76f4500bef37b2eac357cd5&#45;&gt;b7533361e3264518bbfc3cbe0cfbabdc -->
<g id="edge10" class="edge">
<title>ea06601cf76f4500bef37b2eac357cd5-&gt;b7533361e3264518bbfc3cbe0cfbabdc</title>
<path fill="none" stroke="#7b8894" d="M1265.82,-232.36C1265.49,-238.72 1265.14,-245.19 1264.8,-251.63" />
<polygon fill="#7b8894" stroke="#7b8894" points="1261.3,-251.52 1264.27,-261.69 1268.29,-251.89 1261.3,-251.52" />
</g>
<!-- cad91f9552ce4895ae76a5dad983ede8 -->
<g id="node14" class="node">
<title>cad91f9552ce4895ae76a5dad983ede8</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1070.53" y="-471.08" />
<text text-anchor="middle" x="1121.03" y="-355.68" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Stabilize Stage</text>
</g>
<!-- b7533361e3264518bbfc3cbe0cfbabdc&#45;&gt;cad91f9552ce4895ae76a5dad983ede8 -->
<g id="edge11" class="edge">
<title>b7533361e3264518bbfc3cbe0cfbabdc-&gt;cad91f9552ce4895ae76a5dad983ede8</title>
<path fill="none" stroke="#7b8894" d="M1209.84,-363.15C1200.19,-369.39 1190.02,-375.97 1180.14,-382.36" />
<polygon fill="#7b8894" stroke="#7b8894" points="1178.05,-379.54 1171.55,-387.91 1181.85,-385.42 1178.05,-379.54" />
</g>
<!-- a413875e05224214b0e88a02a1f9365f -->
<g id="node15" class="node">
<title>a413875e05224214b0e88a02a1f9365f</title>
<image xlink:href="/icons/decision.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="896.223" y="-474.037" />
<text text-anchor="middle" x="946.72" y="-358.64" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">More Tiles?</text>
</g>
<!-- cad91f9552ce4895ae76a5dad983ede8&#45;&gt;a413875e05224214b0e88a02a1f9365f -->
<g id="edge12" class="edge">
<title>cad91f9552ce4895ae76a5dad983ede8-&gt;a413875e05224214b0e88a02a1f9365f</title>
<path fill="none" stroke="#7b8894" d="M1070.14,-421.44C1050.54,-421.78 1027.97,-422.16 1007.52,-422.51" />
<polygon fill="#7b8894" stroke="#7b8894" points="1007.31,-419.01 997.37,-422.68 1007.43,-426.01 1007.31,-419.01" />
</g>
<!-- a413875e05224214b0e88a02a1f9365f&#45;&gt;de5207f55cfe48c9954564f3320eab75 -->
<g id="edge14" class="edge">
<title>a413875e05224214b0e88a02a1f9365f-&gt;de5207f55cfe48c9954564f3320eab75</title>
<path fill="none" stroke="#7b8894" d="M933.6,-492.44C932.16,-500.03 930.68,-507.79 929.21,-515.49" />
<polygon fill="#7b8894" stroke="#7b8894" points="925.73,-515.06 927.3,-525.54 932.61,-516.37 925.73,-515.06" />
</g>
<!-- a413875e05224214b0e88a02a1f9365f&#45;&gt;7dbba8ece69c4d8a8cc1c8c3af047eb1 -->
<g id="edge13" class="edge">
<title>a413875e05224214b0e88a02a1f9365f-&gt;7dbba8ece69c4d8a8cc1c8c3af047eb1</title>
<path fill="none" stroke="#7b8894" d="M913.07,-354.86C910.22,-349.03 907.32,-343.11 904.43,-337.23" />
<polygon fill="#7b8894" stroke="#7b8894" points="907.46,-335.46 899.92,-328.02 901.18,-338.54 907.46,-335.46" />
</g>
<!-- c375931cc35b4211accd28b83f5b3f82 -->
<g id="node17" class="node">
<title>c375931cc35b4211accd28b83f5b3f82</title>
<image xlink:href="/icons/predefined-process.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="692.974" y="-924.823" />
<text text-anchor="middle" x="743.47" y="-809.42" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Finalize Metadata</text>
</g>
<!-- 7d2ec5baf02248eab8805a0ac55e75ee&#45;&gt;c375931cc35b4211accd28b83f5b3f82 -->
<g id="edge16" class="edge">
<title>7d2ec5baf02248eab8805a0ac55e75ee-&gt;c375931cc35b4211accd28b83f5b3f82</title>
<path fill="none" stroke="#7b8894" d="M805.43,-806.51C804.03,-808.04 802.62,-809.58 801.22,-811.12" />
<polygon fill="#7b8894" stroke="#7b8894" points="798.34,-809.08 794.18,-818.82 803.51,-813.8 798.34,-809.08" />
</g>
<!-- 7165e34575344c9f8ed6a49386103888 -->
<g id="node18" class="node">
<title>7165e34575344c9f8ed6a49386103888</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="542.532" y="-1000.41" />
<text text-anchor="middle" x="593.03" y="-885.01" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Create Robocopy File</text>
</g>
<!-- c375931cc35b4211accd28b83f5b3f82&#45;&gt;7165e34575344c9f8ed6a49386103888 -->
<g id="edge17" class="edge">
<title>c375931cc35b4211accd28b83f5b3f82-&gt;7165e34575344c9f8ed6a49386103888</title>
<path fill="none" stroke="#7b8894" d="M692.96,-899.7C680.06,-906.18 666.07,-913.21 652.76,-919.9" />
<polygon fill="#7b8894" stroke="#7b8894" points="651.03,-916.85 643.67,-924.47 654.18,-923.11 651.03,-916.85" />
</g>
<!-- 70a34d47e0fb4c10a9802b030e83b6e2 -->
<g id="node19" class="node">
<title>70a34d47e0fb4c10a9802b030e83b6e2</title>
<image xlink:href="/icons/decision.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="374.086" y="-1018.19" />
<text text-anchor="middle" x="424.59" y="-902.79" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Check for Abort or Switch</text>
</g>
<!-- 7165e34575344c9f8ed6a49386103888&#45;&gt;70a34d47e0fb4c10a9802b030e83b6e2 -->
<g id="edge18" class="edge">
<title>7165e34575344c9f8ed6a49386103888-&gt;70a34d47e0fb4c10a9802b030e83b6e2</title>
<path fill="none" stroke="#7b8894" d="M542.49,-955.24C524.42,-957.15 503.87,-959.32 485.05,-961.31" />
<polygon fill="#7b8894" stroke="#7b8894" points="484.67,-957.83 475.09,-962.36 485.4,-964.79 484.67,-957.83" />
</g>
<!-- 59a20ac7ce1c4d68b7b832e55427b0d5 -->
<g id="node20" class="node">
<title>59a20ac7ce1c4d68b7b832e55427b0d5</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="210.067" y="-973.703" />
<text text-anchor="middle" x="260.57" y="-858.3" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Handle Abort</text>
</g>
<!-- 70a34d47e0fb4c10a9802b030e83b6e2&#45;&gt;59a20ac7ce1c4d68b7b832e55427b0d5 -->
<g id="edge19" class="edge">
<title>70a34d47e0fb4c10a9802b030e83b6e2-&gt;59a20ac7ce1c4d68b7b832e55427b0d5</title>
<path fill="none" stroke="#7b8894" d="M374.04,-953.98C357.36,-949.46 338.63,-944.38 321.27,-939.67" />
<polygon fill="#7b8894" stroke="#7b8894" points="321.8,-936.19 311.23,-936.95 319.97,-942.94 321.8,-936.19" />
</g>
<!-- a0e31c68199e4fefb713c15a0b79f0d5 -->
<g id="node21" class="node">
<title>a0e31c68199e4fefb713c15a0b79f0d5</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="75.4982" y="-869.335" />
<text text-anchor="middle" x="126" y="-753.94" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Schedule Events</text>
</g>
<!-- 59a20ac7ce1c4d68b7b832e55427b0d5&#45;&gt;a0e31c68199e4fefb713c15a0b79f0d5 -->
<g id="edge20" class="edge">
<title>59a20ac7ce1c4d68b7b832e55427b0d5-&gt;a0e31c68199e4fefb713c15a0b79f0d5</title>
<path fill="none" stroke="#7b8894" d="M209.69,-883.75C201.46,-877.36 192.87,-870.7 184.48,-864.19" />
<polygon fill="#7b8894" stroke="#7b8894" points="186.55,-861.36 176.5,-858 182.26,-866.9 186.55,-861.36" />
</g>
<!-- a0e31c68199e4fefb713c15a0b79f0d5&#45;&gt;2572d1dd55b84598b23445e09015ec4c -->
<g id="edge21" class="edge">
<title>a0e31c68199e4fefb713c15a0b79f0d5-&gt;2572d1dd55b84598b23445e09015ec4c</title>
<path fill="none" stroke="#7b8894" d="M92.26,-749.94C91.25,-747.88 90.23,-745.81 89.22,-743.74" />
<polygon fill="#7b8894" stroke="#7b8894" points="92.32,-742.11 84.78,-734.67 86.03,-745.19 92.32,-742.11" />
</g>
</g>
</svg></div>

<h2 id="error-state">Error State</h2>


</div>
    </div>
</div>
        <footer class="mdl-mega-footer">
  <div class="mdl-mega-footer__middle-section">
    
  </div>
  <div class="mdl-mega-footer__bottom-section">
    <ul class="mdl-mega-footer__link-list">
      
    </ul>
  </div>
</footer>

      </main>
    </div>
  </body>
</html>

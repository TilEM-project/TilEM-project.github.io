<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <title>pyTEM - TEM Architecture</title>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css"/>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"/>
<!-- <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.-.min.css"/> -->
<link rel="stylesheet" href="/assets/css/style.css"/>
<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/font-awesome.min.css"> -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
  window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>

  </head>
  <body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
      <!-- <div class="mdl-layout--fixed-header mdl-layout__header--scroll"> -->
  <header class="mdl-layout__header">
    <div class="mdl-layout__header-row">
      <span class="mdl-layout-title">
        <a href="/">TEM Architecture</a>
      </span>
      <div class="mdl-layout-spacer mdl-layout--large-screen-only"></div>
      <nav class="mdl-navigation mdl-layout--large-screen-only">
        
          <a class="mdl-navigation__link" href="/topics.html">Topics</a>
        
          <a class="mdl-navigation__link" href="/assignments.html">Assignments</a>
        
      </nav>
    </div>
  </header>
  <div class="mdl-layout__drawer">
    <span class="mdl-layout-title">TEM Architecture</span>
    <nav class="mdl-navigation">
      
        <a class="mdl-navigation__link" href="/topics.html">Topics</a>
        
      
        <a class="mdl-navigation__link" href="/assignments.html">Assignments</a>
        
      
        <a class="mdl-navigation__link" href="/unassigned.html">Unassigned</a>
        
      
    </nav>
  </div>
<!-- </div> -->

      <main class="mdl-layout__content">
        <div class="mdl-grid page-container">
    <div class="mdl-card mdl-cell--12-col mdl-shadow--4dp">
        <div class="mdl-card__title">
            <h2 class="mdl-card__title--text">
                pyTEM
            </h2>
        </div>
        
  <div class="mdl-card__supporting-text mdl-card--border">
    
    
      
      <p class="mdl-card__subtitle-text contributor-info">
        Assigned: Derrick Brittain
        
          <a href="https://github.com/dlbrittain"><i class="fab fa-github"></i></a>
          <a href="mailto:derrickb@alleninstitute.org"><i class="fa fa-envelope"></i></a>
          <a href="https://aianatomy.slack.com/team/U0CPVP4CC"><i class="fab fa-slack"></i></a></p>
    
    
      <h3>Sends</h3>
      <ul>
        
        
          <li><a href="/topics.html#camera-command">camera.command</a></li>
        
          <li><a href="/topics.html#camera-settings">camera.settings</a></li>
        
          <li><a href="/topics.html#scope-command">scope.command</a></li>
        
          <li><a href="/topics.html#stage-aperture-command">stage.aperture.command</a></li>
        
          <li><a href="/topics.html#stage-motion-command">stage.motion.command</a></li>
        
          <li><a href="/topics.html#stage-rotation-command">stage.rotation.command</a></li>
        
          <li><a href="/topics.html#tile-raw">tile.raw</a></li>
        
      </ul>
    
    
      <h3>Receives</h3>
      <ul>
        
        
          <li><a href="/topics.html#camera-image">camera.image</a></li>
        
          <li><a href="/topics.html#camera-status">camera.status</a></li>
        
          <li><a href="/topics.html#scope-status">scope.status</a></li>
        
          <li><a href="/topics.html#stage-aperture-status">stage.aperture.status</a></li>
        
          <li><a href="/topics.html#stage-motion-status">stage.motion.status</a></li>
        
          <li><a href="/topics.html#stage-rotation-status">stage.rotation.status</a></li>
        
      </ul>
    
  </div>

<div class="mdl-card__supporting-text">
  <div class="diagram"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0.00 0.00 828.00 612.00">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(144 468)">
<title>%3</title>
<g id="clust1" class="cluster">
<title>cluster_pyTEM States</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M12,0C12,0 528,0 528,0 534,0 540,-6 540,-12 540,-12 540,-312 540,-312 540,-318 534,-324 528,-324 528,-324 12,-324 12,-324 6,-324 0,-318 0,-312 0,-312 0,-12 0,-12 0,-6 6,0 12,0" />
<text text-anchor="middle" x="49" y="-310.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">pyTEM States</text>
</g>
<!-- 02a6be390877416db4c5b2a2e7ce4e85 -->
<g id="node1" class="node">
<title>02a6be390877416db4c5b2a2e7ce4e85</title>
<g id="a_node1"><a xlink:href="#preview-state" xlink:title="Preview/Setup State">
<path fill="none" stroke="black" d="M348,-324C348,-324 156,-324 156,-324 150,-324 144,-318 144,-312 144,-312 144,-300 144,-300 144,-294 150,-288 156,-288 156,-288 348,-288 348,-288 354,-288 360,-294 360,-300 360,-300 360,-312 360,-312 360,-318 354,-324 348,-324" />
<text text-anchor="middle" x="252" y="-302.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Preview/Setup State</text>
</a>
</g>
</g>
<!-- 89cf471c9e594d07a5899aecf3e8dd5f -->
<g id="node2" class="node">
<title>89cf471c9e594d07a5899aecf3e8dd5f</title>
<g id="a_node2"><a xlink:href="#change-aperture-state" xlink:title="ROI Initialization State">
<path fill="none" stroke="black" d="M204,-216C204,-216 12,-216 12,-216 6,-216 0,-210 0,-204 0,-204 0,-192 0,-192 0,-186 6,-180 12,-180 12,-180 204,-180 204,-180 210,-180 216,-186 216,-192 216,-192 216,-204 216,-204 216,-210 210,-216 204,-216" />
<text text-anchor="middle" x="108" y="-194.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">ROI Initialization State</text>
</a>
</g>
</g>
<!-- 02a6be390877416db4c5b2a2e7ce4e85&#45;&gt;89cf471c9e594d07a5899aecf3e8dd5f -->
<g id="edge1" class="edge">
<title>02a6be390877416db4c5b2a2e7ce4e85-&gt;89cf471c9e594d07a5899aecf3e8dd5f</title>
<path fill="none" stroke="#7b8894" d="M227.9,-287.92C203.91,-269.93 166.95,-242.21 140.4,-222.3" />
<polygon fill="#7b8894" stroke="#7b8894" points="142.28,-219.34 132.18,-216.14 138.08,-224.94 142.28,-219.34" />
</g>
<!-- 1bfdc26328924e9ea9401ab27145c3f9 -->
<g id="node3" class="node">
<title>1bfdc26328924e9ea9401ab27145c3f9</title>
<g id="a_node3"><a xlink:href="#acquisition-state" xlink:title="Acquisition State">
<path fill="none" stroke="black" d="M348,-36C348,-36 156,-36 156,-36 150,-36 144,-30 144,-24 144,-24 144,-12 144,-12 144,-6 150,0 156,0 156,0 348,0 348,0 354,0 360,-6 360,-12 360,-12 360,-24 360,-24 360,-30 354,-36 348,-36" />
<text text-anchor="middle" x="252" y="-14.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Acquisition State</text>
</a>
</g>
</g>
<!-- 89cf471c9e594d07a5899aecf3e8dd5f&#45;&gt;1bfdc26328924e9ea9401ab27145c3f9 -->
<g id="edge2" class="edge">
<title>89cf471c9e594d07a5899aecf3e8dd5f-&gt;1bfdc26328924e9ea9401ab27145c3f9</title>
<path fill="none" stroke="#7b8894" d="M137.2,-179.69C170.66,-147.66 222.24,-82.73 243.56,-45.39" />
<polygon fill="#7b8894" stroke="#7b8894" points="246.9,-46.56 248.52,-36.08 240.73,-43.27 246.9,-46.56" />
</g>
<!-- dc0b8a713395493ba8ec8b1da2f3f78f -->
<g id="node4" class="node">
<title>dc0b8a713395493ba8ec8b1da2f3f78f</title>
<g id="a_node4"><a xlink:href="#error-state" xlink:title="Error State">
<polygon fill="none" stroke="black" points="468,-225 396,-198 468,-171 540,-198 468,-225" />
<text text-anchor="middle" x="468" y="-194.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Error State</text>
</a>
</g>
</g>
<!-- 89cf471c9e594d07a5899aecf3e8dd5f&#45;&gt;dc0b8a713395493ba8ec8b1da2f3f78f -->
<g id="edge5" class="edge">
<title>89cf471c9e594d07a5899aecf3e8dd5f-&gt;dc0b8a713395493ba8ec8b1da2f3f78f</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M216.01,-198C270.46,-198 335.43,-198 385.76,-198" />
<polygon fill="red" stroke="red" points="385.94,-201.5 395.94,-198 385.94,-194.5 385.94,-201.5" />
<text text-anchor="middle" x="284.38" y="-201.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Error</text>
</g>
<!-- 1bfdc26328924e9ea9401ab27145c3f9&#45;&gt;02a6be390877416db4c5b2a2e7ce4e85 -->
<g id="edge6" class="edge">
<title>1bfdc26328924e9ea9401ab27145c3f9-&gt;02a6be390877416db4c5b2a2e7ce4e85</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M252,-36.02C252,-84.71 252,-219.2 252,-277.94" />
<polygon fill="blue" stroke="blue" points="248.5,-277.99 252,-287.99 255.5,-277.99 248.5,-277.99" />
<text text-anchor="middle" x="233.5" y="-160.58" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Abort</text>
</g>
<!-- 1bfdc26328924e9ea9401ab27145c3f9&#45;&gt;89cf471c9e594d07a5899aecf3e8dd5f -->
<g id="edge3" class="edge">
<title>1bfdc26328924e9ea9401ab27145c3f9-&gt;89cf471c9e594d07a5899aecf3e8dd5f</title>
<path fill="none" stroke="#7b8894" d="M222.01,-36.31C188.21,-68.39 136.69,-133.34 115.83,-170.68" />
<polygon fill="#7b8894" stroke="#7b8894" points="112.5,-169.5 111.01,-179.99 118.72,-172.72 112.5,-169.5" />
<text text-anchor="middle" x="145.42" y="-107.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Repeat</text>
</g>
<!-- 1bfdc26328924e9ea9401ab27145c3f9&#45;&gt;dc0b8a713395493ba8ec8b1da2f3f78f -->
<g id="edge4" class="edge">
<title>1bfdc26328924e9ea9401ab27145c3f9-&gt;dc0b8a713395493ba8ec8b1da2f3f78f</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M273.9,-36.25C312.67,-68.56 393.46,-135.88 437.6,-172.66" />
<polygon fill="red" stroke="red" points="435.47,-175.45 445.39,-179.16 439.95,-170.07 435.47,-175.45" />
<text text-anchor="middle" x="339.25" y="-108.06" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Error</text>
</g>
</g>
</svg></div>

<h2 id="preview-state">Preview State</h2>

<p>This state is is the entry point to the system. It is the default state at start up and will also be the state that the system will revert to upon detecting an error that does not crash the system.</p>

<h3 id="preview-state-logic">Preview State Logic</h3>

<p>Upon entering this state the system will continuously acquire images from the XIMEA camera and each image frame will be minimally processed. The images are then JPEG encoded and sent to python which pushes them to a websocket to display on a browser based UI.</p>

<div class="diagram"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0.00 0.00 1474.00 868.00">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(144 724)">
<title>%3</title>
<g id="clust1" class="cluster">
<title>cluster_opencv_graph</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M159,-8C159,-8 717,-8 717,-8 723,-8 729,-14 729,-20 729,-20 729,-560 729,-560 729,-566 723,-572 717,-572 717,-572 159,-572 159,-572 153,-572 147,-566 147,-560 147,-560 147,-20 147,-20 147,-14 153,-8 159,-8" />
<text text-anchor="middle" x="197.5" y="-558.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">opencv_graph</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_pyTEMCA</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M779,-217C779,-217 1027,-217 1027,-217 1033,-217 1039,-223 1039,-229 1039,-229 1039,-380 1039,-380 1039,-386 1033,-392 1027,-392 1027,-392 779,-392 779,-392 773,-392 767,-386 767,-380 767,-380 767,-229 767,-229 767,-223 773,-217 779,-217" />
<text text-anchor="middle" x="803.5" y="-378.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">pyTEMCA</text>
</g>
<!-- 2384139f893a47b8b2e8437bf8527951 -->
<g id="node1" class="node">
<title>2384139f893a47b8b2e8437bf8527951</title>
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="155" y="-350.812" />
<text text-anchor="middle" x="205.5" y="-229.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Acquire Image</text>
</g>
<!-- 1bc186279698451381156ab40ee7fb2d -->
<g id="node2" class="node">
<title>1bc186279698451381156ab40ee7fb2d</title>
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="310" y="-350.812" />
<text text-anchor="middle" x="360.5" y="-228.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Flat Field Correction</text>
<text text-anchor="middle" x="360.5" y="-214.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">and CLAHE (CUDA)</text>
</g>
<!-- 2384139f893a47b8b2e8437bf8527951&#45;&gt;1bc186279698451381156ab40ee7fb2d -->
<g id="edge1" class="edge">
<title>2384139f893a47b8b2e8437bf8527951-&gt;1bc186279698451381156ab40ee7fb2d</title>
<path fill="none" stroke="#7b8894" d="M256.17,-294C270.01,-294 285.18,-294 299.53,-294" />
<polygon fill="#7b8894" stroke="#7b8894" points="299.81,-297.5 309.81,-294 299.81,-290.5 299.81,-297.5" />
</g>
<!-- d5c6e6a45fbf4f6c9d1fa7c9f578609a -->
<g id="node3" class="node">
<title>d5c6e6a45fbf4f6c9d1fa7c9f578609a</title>
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="465" y="-155.812" />
<text text-anchor="middle" x="515.5" y="-33.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Calculate Stats</text>
<text text-anchor="middle" x="515.5" y="-19.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">(Min/Max/Mean)</text>
</g>
<!-- 1bc186279698451381156ab40ee7fb2d&#45;&gt;d5c6e6a45fbf4f6c9d1fa7c9f578609a -->
<g id="edge4" class="edge">
<title>1bc186279698451381156ab40ee7fb2d-&gt;d5c6e6a45fbf4f6c9d1fa7c9f578609a</title>
<path fill="none" stroke="#7b8894" d="M411.17,-230.69C426.28,-211.43 442.99,-190.14 458.48,-170.39" />
<polygon fill="#7b8894" stroke="#7b8894" points="461.39,-172.35 464.81,-162.33 455.89,-168.03 461.39,-172.35" />
</g>
<!-- 348a7c80d815477bb24d259856fab8c6 -->
<g id="node4" class="node">
<title>348a7c80d815477bb24d259856fab8c6</title>
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="465" y="-350.812" />
<text text-anchor="middle" x="515.5" y="-229.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Calculate FFT Focus Score</text>
</g>
<!-- 1bc186279698451381156ab40ee7fb2d&#45;&gt;348a7c80d815477bb24d259856fab8c6 -->
<g id="edge6" class="edge">
<title>1bc186279698451381156ab40ee7fb2d-&gt;348a7c80d815477bb24d259856fab8c6</title>
<path fill="none" stroke="#7b8894" d="M411.17,-294C425.01,-294 440.18,-294 454.53,-294" />
<polygon fill="#7b8894" stroke="#7b8894" points="454.81,-297.5 464.81,-294 454.81,-290.5 454.81,-297.5" />
</g>
<!-- 37e00ffb62524b87814977685a84ab99 -->
<g id="node5" class="node">
<title>37e00ffb62524b87814977685a84ab99</title>
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="465" y="-530.812" />
<text text-anchor="middle" x="515.5" y="-409.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">JPEG Compress</text>
</g>
<!-- 1bc186279698451381156ab40ee7fb2d&#45;&gt;37e00ffb62524b87814977685a84ab99 -->
<g id="edge2" class="edge">
<title>1bc186279698451381156ab40ee7fb2d-&gt;37e00ffb62524b87814977685a84ab99</title>
<path fill="none" stroke="#7b8894" d="M411.17,-352.44C426.22,-370.14 442.84,-389.69 458.28,-407.86" />
<polygon fill="#7b8894" stroke="#7b8894" points="455.67,-410.19 464.81,-415.54 461,-405.66 455.67,-410.19" />
</g>
<!-- a837d85eb56947dc89a34393e3aef3f1 -->
<g id="node6" class="node">
<title>a837d85eb56947dc89a34393e3aef3f1</title>
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="620" y="-350.812" />
<text text-anchor="middle" x="670.5" y="-228.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Send to Python</text>
<text text-anchor="middle" x="670.5" y="-214.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">via pybind11</text>
</g>
<!-- d5c6e6a45fbf4f6c9d1fa7c9f578609a&#45;&gt;a837d85eb56947dc89a34393e3aef3f1 -->
<g id="edge5" class="edge">
<title>d5c6e6a45fbf4f6c9d1fa7c9f578609a-&gt;a837d85eb56947dc89a34393e3aef3f1</title>
<path fill="none" stroke="#7b8894" d="M566.17,-162.31C581.28,-181.57 597.99,-202.86 613.48,-222.61" />
<polygon fill="#7b8894" stroke="#7b8894" points="610.89,-224.97 619.81,-230.67 616.39,-220.65 610.89,-224.97" />
</g>
<!-- 348a7c80d815477bb24d259856fab8c6&#45;&gt;a837d85eb56947dc89a34393e3aef3f1 -->
<g id="edge7" class="edge">
<title>348a7c80d815477bb24d259856fab8c6-&gt;a837d85eb56947dc89a34393e3aef3f1</title>
<path fill="none" stroke="#7b8894" d="M566.17,-294C580.01,-294 595.18,-294 609.53,-294" />
<polygon fill="#7b8894" stroke="#7b8894" points="609.81,-297.5 619.81,-294 609.81,-290.5 609.81,-297.5" />
</g>
<!-- 37e00ffb62524b87814977685a84ab99&#45;&gt;a837d85eb56947dc89a34393e3aef3f1 -->
<g id="edge3" class="edge">
<title>37e00ffb62524b87814977685a84ab99-&gt;a837d85eb56947dc89a34393e3aef3f1</title>
<path fill="none" stroke="#7b8894" d="M566.17,-415.56C581.22,-397.86 597.84,-378.31 613.28,-360.14" />
<polygon fill="#7b8894" stroke="#7b8894" points="616,-362.34 619.81,-352.46 610.67,-357.81 616,-362.34" />
</g>
<!-- f5d277d2abdc464bb638f067b8f9f3e8 -->
<g id="node7" class="node">
<title>f5d277d2abdc464bb638f067b8f9f3e8</title>
<image xlink:href="/icons/python.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="775" y="-344.5" />
<text text-anchor="middle" x="825.5" y="-229.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Encode Image</text>
</g>
<!-- a837d85eb56947dc89a34393e3aef3f1&#45;&gt;f5d277d2abdc464bb638f067b8f9f3e8 -->
<g id="edge8" class="edge">
<title>a837d85eb56947dc89a34393e3aef3f1-&gt;f5d277d2abdc464bb638f067b8f9f3e8</title>
<path fill="none" stroke="#7b8894" d="M721.17,-294C735.01,-294 750.18,-294 764.53,-294" />
<polygon fill="#7b8894" stroke="#7b8894" points="764.81,-297.5 774.81,-294 764.81,-290.5 764.81,-297.5" />
</g>
<!-- 6ddddecd681940f29bc60b5a2c417a8d -->
<g id="node8" class="node">
<title>6ddddecd681940f29bc60b5a2c417a8d</title>
<image xlink:href="/icons/python.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="930" y="-344.5" />
<text text-anchor="middle" x="980.5" y="-229.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Publish Image</text>
</g>
<!-- f5d277d2abdc464bb638f067b8f9f3e8&#45;&gt;6ddddecd681940f29bc60b5a2c417a8d -->
<g id="edge9" class="edge">
<title>f5d277d2abdc464bb638f067b8f9f3e8-&gt;6ddddecd681940f29bc60b5a2c417a8d</title>
<path fill="none" stroke="#7b8894" d="M876.17,-294C890.01,-294 905.18,-294 919.53,-294" />
<polygon fill="#7b8894" stroke="#7b8894" points="919.81,-297.5 929.81,-294 919.81,-290.5 919.81,-297.5" />
</g>
<!-- ab0c4c4ea1ab4543a3ff97a878e84cc0 -->
<g id="node9" class="node">
<title>ab0c4c4ea1ab4543a3ff97a878e84cc0</title>
<image xlink:href="/icons/user.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1085" y="-344.5" />
<text text-anchor="middle" x="1135.5" y="-229.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Web UI</text>
</g>
<!-- 6ddddecd681940f29bc60b5a2c417a8d&#45;&gt;ab0c4c4ea1ab4543a3ff97a878e84cc0 -->
<g id="edge10" class="edge">
<title>6ddddecd681940f29bc60b5a2c417a8d-&gt;ab0c4c4ea1ab4543a3ff97a878e84cc0</title>
<path fill="none" stroke="#7b8894" d="M1031.17,-294C1045.01,-294 1060.18,-294 1074.53,-294" />
<polygon fill="#7b8894" stroke="#7b8894" points="1074.81,-297.5 1084.81,-294 1074.81,-290.5 1074.81,-297.5" />
</g>
<!-- b15c065b5554491fb44b624021f636c6 -->
<g id="node10" class="node">
<title>b15c065b5554491fb44b624021f636c6</title>
<image xlink:href="/icons/decision.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="0" y="-344.5" />
<text text-anchor="middle" x="50.5" y="-229.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">State Changed?</text>
</g>
<!-- b15c065b5554491fb44b624021f636c6&#45;&gt;2384139f893a47b8b2e8437bf8527951 -->
<g id="edge12" class="edge">
<title>b15c065b5554491fb44b624021f636c6-&gt;2384139f893a47b8b2e8437bf8527951</title>
<path fill="none" stroke="#7b8894" d="M101.17,-294C115.01,-294 130.18,-294 144.53,-294" />
<polygon fill="#7b8894" stroke="#7b8894" points="144.81,-297.5 154.81,-294 144.81,-290.5 144.81,-297.5" />
</g>
<!-- b15c065b5554491fb44b624021f636c6&#45;&gt;b15c065b5554491fb44b624021f636c6 -->
<g id="edge11" class="edge">
<title>b15c065b5554491fb44b624021f636c6-&gt;b15c065b5554491fb44b624021f636c6</title>
<path fill="none" stroke="#7b8894" d="M21.63,-362.6C21.33,-386.33 30.95,-405.5 50.5,-405.5 67.15,-405.5 76.6,-391.6 78.85,-372.82" />
<polygon fill="#7b8894" stroke="#7b8894" points="82.35,-372.76 79.37,-362.6 75.36,-372.4 82.35,-372.76" />
<text text-anchor="middle" x="24.64" y="-391.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Repeat</text>
</g>
</g>
</svg></div>

<h2 id="roi-initialization-state">ROI Initialization State</h2>

<p>The ROI Initialization State represents a state for moving to an aperture on a grid tape or stick16.</p>

<h3 id="roi-initialization-state-logic">ROI Initialization State Logic</h3>

<p>Upon entering this state it handles the entry logic for the state and initializes tape_ranges if it is None. It tries to fetch barcode values from TEM_db (if using tape); otherwise, it sets default values.</p>

<p>Next the code performs the following:</p>

<ol>
  <li>
    <p>Initialization and Logging:
 Clears lists related to aperture critical and error events.
 Logs the action of changing the aperture.</p>
  </li>
  <li>
    <p>State Check for Pause:
 Checks if the current montage state is PAUSE. If yes, it schedules the _change_aperture method to run again after 0.2 seconds and exits the current execution.</p>
  </li>
  <li>
    <p>Preparatory Actions:
 Updates beam center results and informs the system that a new montage is starting.</p>
  </li>
  <li>Abort Conditions Check:
 Checks several conditions to decide whether to abort the operation:
    <ul>
      <li>If required media information is missing.</li>
      <li>If environmental conditions are not suitable.</li>
      <li>If there’s a pending request to abort at the end of the montage.</li>
      <li>If there is insufficient disk space.</li>
      <li>If too many errors have accumulated (default is 3).</li>
    </ul>
  </li>
  <li>Handling of Tape and Aperture:
 Retrieves the next task object (TAO) from the montage controller.
 If a valid TAO is found:
    <ul>
      <li>Checks if the destination directory exists or needs to be created.</li>
      <li>Checks for existing data that might require an abort.</li>
      <li>Performs adjustments based on the first Region of Interest (ROI) from tao.</li>
    </ul>
  </li>
  <li>
    <p>Aperture Movement and Correction:
 Manages movement to the correct grid or aperture based on the tape controller status.
 Deals with potential barcode errors and adjusts based on confidence levels in the barcode readings.</p>
  </li>
  <li>
    <p>Lens and Beam Adjustments:
 Adjusts the beam’s brightness and attempts to find a centroid for the aperture if needed.
 Conducts a quality check on the beam’s brightness and might abort if the beam mean value is too low.
 Manages auto-centering of the beam if necessary.</p>
  </li>
  <li>
    <p>Brightfield Imaging:
 Handles brightfield imaging conditions and might abort based on the quality of consecutive brightfield images.</p>
  </li>
  <li>
    <p>Lens Correction Montage:
 Decides whether a new lens correction montage is necessary based on time intervals and changes in lens conditions.</p>
  </li>
  <li>Finalizing and Error Handling:
If no ROIs are found in tao, logs the event but continues processing.
If there are still tasks (taos) left in the montage queue, it triggers the start of another attempt.
Sets the montage state to NONE if no tasks are left.</li>
</ol>

<div class="diagram"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0.00 0.00 2281.00 716.00">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(144 572)">
<title>%3</title>
<g id="clust1" class="cluster">
<title>cluster_ROI Initialization State</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M20,-8C20,-8 1973,-8 1973,-8 1979,-8 1985,-14 1985,-20 1985,-20 1985,-408 1985,-408 1985,-414 1979,-420 1973,-420 1973,-420 20,-420 20,-420 14,-420 8,-414 8,-408 8,-408 8,-20 8,-20 8,-14 14,-8 20,-8" />
<text text-anchor="middle" x="82.5" y="-406.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">ROI Initialization State</text>
</g>
<!-- d7d548faa90345d3bd082bb4504c238e -->
<g id="node1" class="node">
<title>d7d548faa90345d3bd082bb4504c238e</title>
<image xlink:href="/icons/start-end.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="16" y="-253.5" />
<text text-anchor="middle" x="66.5" y="-138.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Enter State</text>
</g>
<!-- 9e0789d5863e4de78a30791c3ebdfce4 -->
<g id="node2" class="node">
<title>9e0789d5863e4de78a30791c3ebdfce4</title>
<image xlink:href="/icons/decision.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="171" y="-253.5" />
<text text-anchor="middle" x="221.5" y="-138.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Initialize tape_ranges</text>
</g>
<!-- d7d548faa90345d3bd082bb4504c238e&#45;&gt;9e0789d5863e4de78a30791c3ebdfce4 -->
<g id="edge1" class="edge">
<title>d7d548faa90345d3bd082bb4504c238e-&gt;9e0789d5863e4de78a30791c3ebdfce4</title>
<path fill="none" stroke="#7b8894" d="M117.17,-203C131.01,-203 146.18,-203 160.53,-203" />
<polygon fill="#7b8894" stroke="#7b8894" points="160.81,-206.5 170.81,-203 160.81,-199.5 160.81,-206.5" />
</g>
<!-- b907f04a49964dd996e45b2f88363c08 -->
<g id="node3" class="node">
<title>b907f04a49964dd996e45b2f88363c08</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="326" y="-149.5" />
<text text-anchor="middle" x="376.5" y="-33.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Fetch Barcode</text>
<text text-anchor="middle" x="376.5" y="-19.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">from TEM_db</text>
</g>
<!-- 9e0789d5863e4de78a30791c3ebdfce4&#45;&gt;b907f04a49964dd996e45b2f88363c08 -->
<g id="edge2" class="edge">
<title>9e0789d5863e4de78a30791c3ebdfce4-&gt;b907f04a49964dd996e45b2f88363c08</title>
<path fill="none" stroke="#7b8894" d="M272.17,-169.23C286.54,-159.47 302.36,-148.72 317.2,-138.63" />
<polygon fill="#7b8894" stroke="#7b8894" points="319.51,-141.29 325.81,-132.77 315.58,-135.5 319.51,-141.29" />
</g>
<!-- 249b8f23f0f14536bd493ebb423bf93f -->
<g id="node4" class="node">
<title>249b8f23f0f14536bd493ebb423bf93f</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="326" y="-358.5" />
<text text-anchor="middle" x="376.5" y="-242.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Initialization</text>
<text text-anchor="middle" x="376.5" y="-228.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">&amp; Logging</text>
</g>
<!-- 9e0789d5863e4de78a30791c3ebdfce4&#45;&gt;249b8f23f0f14536bd493ebb423bf93f -->
<g id="edge3" class="edge">
<title>9e0789d5863e4de78a30791c3ebdfce4-&gt;249b8f23f0f14536bd493ebb423bf93f</title>
<path fill="none" stroke="#7b8894" d="M272.17,-237.09C286.54,-246.95 302.36,-257.81 317.2,-267.99" />
<polygon fill="#7b8894" stroke="#7b8894" points="315.59,-271.13 325.81,-273.9 319.55,-265.36 315.59,-271.13" />
</g>
<!-- 91cdcd60ac8e48a4bcbe018d168f80b0 -->
<g id="node5" class="node">
<title>91cdcd60ac8e48a4bcbe018d168f80b0</title>
<image xlink:href="/icons/decision.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="481" y="-275.5" />
<text text-anchor="middle" x="531.5" y="-159.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Check if State</text>
<text text-anchor="middle" x="531.5" y="-145.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">is PAUSE</text>
</g>
<!-- 249b8f23f0f14536bd493ebb423bf93f&#45;&gt;91cdcd60ac8e48a4bcbe018d168f80b0 -->
<g id="edge4" class="edge">
<title>249b8f23f0f14536bd493ebb423bf93f-&gt;91cdcd60ac8e48a4bcbe018d168f80b0</title>
<path fill="none" stroke="#7b8894" d="M427.17,-281.05C441.41,-273.33 457.06,-264.84 471.79,-256.85" />
<polygon fill="#7b8894" stroke="#7b8894" points="473.69,-259.8 480.81,-251.95 470.35,-253.65 473.69,-259.8" />
</g>
<!-- 72ef3831163d466aa8e2963f1fc7f168 -->
<g id="node6" class="node">
<title>72ef3831163d466aa8e2963f1fc7f168</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="636" y="-185.5" />
<text text-anchor="middle" x="686.5" y="-70.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Retry after 0.2s</text>
</g>
<!-- 91cdcd60ac8e48a4bcbe018d168f80b0&#45;&gt;72ef3831163d466aa8e2963f1fc7f168 -->
<g id="edge6" class="edge">
<title>91cdcd60ac8e48a4bcbe018d168f80b0-&gt;72ef3831163d466aa8e2963f1fc7f168</title>
<path fill="none" stroke="#7b8894" d="M582.17,-180.92C596.41,-171.56 612.06,-162.19 626.79,-154.17" />
<polygon fill="#7b8894" stroke="#7b8894" points="628.63,-157.16 635.81,-149.37 625.34,-150.98 628.63,-157.16" />
</g>
<!-- 01dc1baef9bf46a4abe1739a8e790cf6 -->
<g id="node7" class="node">
<title>01dc1baef9bf46a4abe1739a8e790cf6</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="636" y="-365.5" />
<text text-anchor="middle" x="686.5" y="-250.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Preparatory Actions</text>
</g>
<!-- 91cdcd60ac8e48a4bcbe018d168f80b0&#45;&gt;01dc1baef9bf46a4abe1739a8e790cf6 -->
<g id="edge5" class="edge">
<title>91cdcd60ac8e48a4bcbe018d168f80b0-&gt;01dc1baef9bf46a4abe1739a8e790cf6</title>
<path fill="none" stroke="#7b8894" d="M582.17,-254.22C596.41,-262.59 612.06,-271.8 626.79,-280.46" />
<polygon fill="#7b8894" stroke="#7b8894" points="625.42,-283.72 635.81,-285.77 628.97,-277.69 625.42,-283.72" />
</g>
<!-- 72ef3831163d466aa8e2963f1fc7f168&#45;&gt;91cdcd60ac8e48a4bcbe018d168f80b0 -->
<g id="edge7" class="edge">
<title>72ef3831163d466aa8e2963f1fc7f168-&gt;91cdcd60ac8e48a4bcbe018d168f80b0</title>
<path fill="none" stroke="#7b8894" d="M635.81,-179.79C621.58,-189.2 605.92,-198.59 591.2,-206.57" />
<polygon fill="#7b8894" stroke="#7b8894" points="589.38,-203.57 582.17,-211.34 592.65,-209.76 589.38,-203.57" />
</g>
<!-- cce5c8dcf23d410b9fd7c875a37e14cf -->
<g id="node8" class="node">
<title>cce5c8dcf23d410b9fd7c875a37e14cf</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="791" y="-358.5" />
<text text-anchor="middle" x="841.5" y="-242.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Check Abort</text>
<text text-anchor="middle" x="841.5" y="-228.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Conditions</text>
</g>
<!-- 01dc1baef9bf46a4abe1739a8e790cf6&#45;&gt;cce5c8dcf23d410b9fd7c875a37e14cf -->
<g id="edge8" class="edge">
<title>01dc1baef9bf46a4abe1739a8e790cf6-&gt;cce5c8dcf23d410b9fd7c875a37e14cf</title>
<path fill="none" stroke="#7b8894" d="M737.17,-312.73C751.01,-312.09 766.18,-311.4 780.53,-310.74" />
<polygon fill="#7b8894" stroke="#7b8894" points="780.98,-314.23 790.81,-310.27 780.66,-307.23 780.98,-314.23" />
</g>
<!-- 30590392c84044b483e8e1b0b4b93d3e -->
<g id="node9" class="node">
<title>30590392c84044b483e8e1b0b4b93d3e</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="946" y="-358.5" />
<text text-anchor="middle" x="996.5" y="-242.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Handle Tape</text>
<text text-anchor="middle" x="996.5" y="-228.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">&amp; Aperture</text>
</g>
<!-- cce5c8dcf23d410b9fd7c875a37e14cf&#45;&gt;30590392c84044b483e8e1b0b4b93d3e -->
<g id="edge9" class="edge">
<title>cce5c8dcf23d410b9fd7c875a37e14cf-&gt;30590392c84044b483e8e1b0b4b93d3e</title>
<path fill="none" stroke="#7b8894" d="M892.17,-308C906.01,-308 921.18,-308 935.53,-308" />
<polygon fill="#7b8894" stroke="#7b8894" points="935.81,-311.5 945.81,-308 935.81,-304.5 935.81,-311.5" />
</g>
<!-- 6f1f8ff8060341ff8119dea6f5d8d435 -->
<g id="node10" class="node">
<title>6f1f8ff8060341ff8119dea6f5d8d435</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1101" y="-358.5" />
<text text-anchor="middle" x="1151.5" y="-242.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Aperture Movement</text>
<text text-anchor="middle" x="1151.5" y="-228.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">&amp; Correction</text>
</g>
<!-- 30590392c84044b483e8e1b0b4b93d3e&#45;&gt;6f1f8ff8060341ff8119dea6f5d8d435 -->
<g id="edge10" class="edge">
<title>30590392c84044b483e8e1b0b4b93d3e-&gt;6f1f8ff8060341ff8119dea6f5d8d435</title>
<path fill="none" stroke="#7b8894" d="M1047.17,-308C1061.01,-308 1076.18,-308 1090.53,-308" />
<polygon fill="#7b8894" stroke="#7b8894" points="1090.81,-311.5 1100.81,-308 1090.81,-304.5 1090.81,-311.5" />
</g>
<!-- 84a992741df14058b0c6d8c87672c937 -->
<g id="node11" class="node">
<title>84a992741df14058b0c6d8c87672c937</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1256" y="-358.5" />
<text text-anchor="middle" x="1306.5" y="-242.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Lens &amp; Beam</text>
<text text-anchor="middle" x="1306.5" y="-228.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Adjustments</text>
</g>
<!-- 6f1f8ff8060341ff8119dea6f5d8d435&#45;&gt;84a992741df14058b0c6d8c87672c937 -->
<g id="edge11" class="edge">
<title>6f1f8ff8060341ff8119dea6f5d8d435-&gt;84a992741df14058b0c6d8c87672c937</title>
<path fill="none" stroke="#7b8894" d="M1202.17,-308C1216.01,-308 1231.18,-308 1245.53,-308" />
<polygon fill="#7b8894" stroke="#7b8894" points="1245.81,-311.5 1255.81,-308 1245.81,-304.5 1245.81,-311.5" />
</g>
<!-- 1e70c8200aa3416db6c8a7141736788a -->
<g id="node12" class="node">
<title>1e70c8200aa3416db6c8a7141736788a</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1411" y="-358.5" />
<text text-anchor="middle" x="1461.5" y="-243.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Brightfield Imaging</text>
</g>
<!-- 84a992741df14058b0c6d8c87672c937&#45;&gt;1e70c8200aa3416db6c8a7141736788a -->
<g id="edge12" class="edge">
<title>84a992741df14058b0c6d8c87672c937-&gt;1e70c8200aa3416db6c8a7141736788a</title>
<path fill="none" stroke="#7b8894" d="M1357.17,-308C1371.01,-308 1386.18,-308 1400.53,-308" />
<polygon fill="#7b8894" stroke="#7b8894" points="1400.81,-311.5 1410.81,-308 1400.81,-304.5 1400.81,-311.5" />
</g>
<!-- aafa76b354c8416b8101091a59132c49 -->
<g id="node13" class="node">
<title>aafa76b354c8416b8101091a59132c49</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1566" y="-358.5" />
<text text-anchor="middle" x="1616.5" y="-242.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Lens Correction</text>
<text text-anchor="middle" x="1616.5" y="-228.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Montage</text>
</g>
<!-- 1e70c8200aa3416db6c8a7141736788a&#45;&gt;aafa76b354c8416b8101091a59132c49 -->
<g id="edge13" class="edge">
<title>1e70c8200aa3416db6c8a7141736788a-&gt;aafa76b354c8416b8101091a59132c49</title>
<path fill="none" stroke="#7b8894" d="M1512.17,-308C1526.01,-308 1541.18,-308 1555.53,-308" />
<polygon fill="#7b8894" stroke="#7b8894" points="1555.81,-311.5 1565.81,-308 1555.81,-304.5 1555.81,-311.5" />
</g>
<!-- 6cbd1efe30cf42979ae1f4042762b3a3 -->
<g id="node14" class="node">
<title>6cbd1efe30cf42979ae1f4042762b3a3</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1721" y="-358.5" />
<text text-anchor="middle" x="1771.5" y="-242.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Finalizing &amp; Error</text>
<text text-anchor="middle" x="1771.5" y="-228.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Handling</text>
</g>
<!-- aafa76b354c8416b8101091a59132c49&#45;&gt;6cbd1efe30cf42979ae1f4042762b3a3 -->
<g id="edge14" class="edge">
<title>aafa76b354c8416b8101091a59132c49-&gt;6cbd1efe30cf42979ae1f4042762b3a3</title>
<path fill="none" stroke="#7b8894" d="M1667.17,-308C1681.01,-308 1696.18,-308 1710.53,-308" />
<polygon fill="#7b8894" stroke="#7b8894" points="1710.81,-311.5 1720.81,-308 1710.81,-304.5 1710.81,-311.5" />
</g>
<!-- 9cfb8fc52c4f482685367634557b5c15 -->
<g id="node15" class="node">
<title>9cfb8fc52c4f482685367634557b5c15</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1876" y="-358.5" />
<text text-anchor="middle" x="1926.5" y="-243.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Set State to NONE</text>
</g>
<!-- 6cbd1efe30cf42979ae1f4042762b3a3&#45;&gt;9cfb8fc52c4f482685367634557b5c15 -->
<g id="edge15" class="edge">
<title>6cbd1efe30cf42979ae1f4042762b3a3-&gt;9cfb8fc52c4f482685367634557b5c15</title>
<path fill="none" stroke="#7b8894" d="M1822.17,-308C1836.01,-308 1851.18,-308 1865.53,-308" />
<polygon fill="#7b8894" stroke="#7b8894" points="1865.81,-311.5 1875.81,-308 1865.81,-304.5 1865.81,-311.5" />
</g>
</g>
</svg></div>

<h2 id="acquisition-state">Acquisition State</h2>

<p>The Acquisition State represents the overall state of the acquisition loop in the system for imaging and processing data. It manages tasks related to moving the stage, capturing images, processing metadata, and handling various states during the acquisition process.</p>

<h3 id="acquisition-state-logic">Acquisition State Logic</h3>

<h4 id="main-acquisition-loop-activation">Main Acquisition Loop Activation</h4>

<p>The acquisition starts if both the main_acquisition_loop_active_event is set and _start_new_aperture() returns True.
Initialize variables and prepare for the acquisition sequence within a specific aperture.</p>

<h4 id="roi-acquisition-process">ROI Acquisition Process</h4>

<p>Iterate over each ROI in roi_list.</p>

<p>For each ROI:</p>

<ul>
  <li>Initialize the ROI and calculate the starting position.</li>
  <li>Move the stage to the initial position and wait for it to stabilize.</li>
  <li>Enter a nested loop to handle image capture for each tile in the ROI until there are no more positions to move to.
    <ul>
      <li>Set metadata for the image.</li>
      <li>Start camera exposure.</li>
      <li>If there was a previous image, wait for asynchronous processes to complete and possibly write metadata.</li>
      <li>Wait for the current exposure to complete.</li>
      <li>Get the next position and move the stage.</li>
      <li>Handle synchronization and stabilization of the stage.</li>
    </ul>
  </li>
  <li>After completing all tiles in the ROI, perform final processing such as writing metadata and resetting the stage to the starting position.</li>
</ul>

<h4 id="lens-correction-process">Lens Correction Process</h4>

<p>If lens correction is part of the current montage, attempt to correct lens distortions using template matching and solving algorithms. Multiple attempts are made, and if unsuccessful, a critical error event is logged.</p>

<h4 id="completion-and-metadata-handling">Completion and Metadata Handling</h4>

<p>Finalize the metadata file and write results to a database.
Create a robocopy file if not aborting.</p>

<h4 id="abort-or-switch-event">Abort or Switch Event</h4>

<p>If an abort signal is received or it’s time to switch to another aperture, the loop is terminated or adjusted accordingly.</p>

<h4 id="event-scheduling">Event Scheduling</h4>

<p>Schedule callbacks for events like “BACK_TO_SETUP” or “NEXT_APERTURE” based on the conditions met during the loop.</p>

<div class="diagram"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0.00 0.00 821.00 670.00">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(144 526)">
<title>%3</title>
<g id="clust1" class="cluster">
<title>cluster_Outer Infinite Loop</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M12,-230.5C12,-230.5 161,-230.5 161,-230.5 167,-230.5 173,-236.5 173,-242.5 173,-242.5 173,-355.5 173,-355.5 173,-361.5 167,-367.5 161,-367.5 161,-367.5 12,-367.5 12,-367.5 6,-367.5 0,-361.5 0,-355.5 0,-355.5 0,-242.5 0,-242.5 0,-236.5 6,-230.5 12,-230.5" />
<text text-anchor="middle" x="64.5" y="-353.9" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Outer Infinite Loop</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_Main Acquisition</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M12,-144C12,-144 161,-144 161,-144 167,-144 173,-150 173,-156 173,-156 173,-298 173,-298 173,-304 167,-310 161,-310 161,-310 12,-310 12,-310 6,-310 0,-304 0,-298 0,-298 0,-156 0,-156 0,-150 6,-144 12,-144" />
<text text-anchor="middle" x="56.5" y="-296.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Main Acquisition</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_ROI Acquisition Process</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M84,0C84,0 233,0 233,0 239,0 245,-6 245,-12 245,-12 245,-211.5 245,-211.5 245,-217.5 239,-223.5 233,-223.5 233,-223.5 84,-223.5 84,-223.5 78,-223.5 72,-217.5 72,-211.5 72,-211.5 72,-12 72,-12 72,-6 78,0 84,0" />
<text text-anchor="middle" x="149.5" y="-209.9" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">ROI Acquisition Process</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_Per-Tile</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M228,0C228,0 521,0 521,0 527,0 533,-6 533,-12 533,-12 533,-211.5 533,-211.5 533,-217.5 527,-223.5 521,-223.5 521,-223.5 228,-223.5 228,-223.5 222,-223.5 216,-217.5 216,-211.5 216,-211.5 216,-12 216,-12 216,-6 222,0 228,0" />
<text text-anchor="middle" x="245.5" y="-209.9" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Per-Tile</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_Lens Correction
Process</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M156,-144C156,-144 233,-144 233,-144 239,-144 245,-150 245,-156 245,-156 245,-298 245,-298 245,-304 239,-310 233,-310 233,-310 156,-310 156,-310 150,-310 144,-304 144,-298 144,-298 144,-156 144,-156 144,-150 150,-144 156,-144" />
<text text-anchor="middle" x="199" y="-296.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Lens Correction</text>
<text text-anchor="middle" x="199" y="-283.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Process</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_Completion &amp; Metadata Handling</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M228,-144C228,-144 377,-144 377,-144 383,-144 389,-150 389,-156 389,-156 389,-298 389,-298 389,-304 383,-310 377,-310 377,-310 228,-310 228,-310 222,-310 216,-304 216,-298 216,-298 216,-156 216,-156 216,-150 222,-144 228,-144" />
<text text-anchor="middle" x="323.5" y="-296.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Completion &amp; Metadata Handling</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_Abort or
Switch Event</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M228,-216C228,-216 377,-216 377,-216 383,-216 389,-222 389,-228 389,-228 389,-370 389,-370 389,-376 383,-382 377,-382 377,-382 228,-382 228,-382 222,-382 216,-376 216,-370 216,-370 216,-228 216,-228 216,-222 222,-216 228,-216" />
<text text-anchor="middle" x="262.5" y="-368.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Abort or</text>
<text text-anchor="middle" x="262.5" y="-355.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Switch Event</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_Event Scheduling</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M156,-230.5C156,-230.5 233,-230.5 233,-230.5 239,-230.5 245,-236.5 245,-242.5 245,-242.5 245,-355.5 245,-355.5 245,-361.5 239,-367.5 233,-367.5 233,-367.5 156,-367.5 156,-367.5 150,-367.5 144,-361.5 144,-355.5 144,-355.5 144,-242.5 144,-242.5 144,-236.5 150,-230.5 156,-230.5" />
<text text-anchor="middle" x="203.5" y="-353.9" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Event Scheduling</text>
</g>
<!-- 734f0fc44fdb44bf9508117133bd4c51 -->
<g id="node1" class="node">
<title>734f0fc44fdb44bf9508117133bd4c51</title>
<image xlink:href="/icons/start-end.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="0" y="-349.5" />
<text text-anchor="middle" x="50.5" y="-234.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Start Outer Loop</text>
</g>
<!-- 57f47daedb5c4819a5b902b66e7c4359 -->
<g id="node3" class="node">
<title>57f47daedb5c4819a5b902b66e7c4359</title>
<image xlink:href="/icons/decision.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="0" y="-277.5" />
<text text-anchor="middle" x="50.5" y="-161.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Check Activation</text>
<text text-anchor="middle" x="50.5" y="-147.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">&amp; Start</text>
</g>
<!-- 734f0fc44fdb44bf9508117133bd4c51&#45;&gt;57f47daedb5c4819a5b902b66e7c4359 -->
<g id="edge1" class="edge">
<title>734f0fc44fdb44bf9508117133bd4c51-&gt;57f47daedb5c4819a5b902b66e7c4359</title>
<path fill="none" stroke="#7b8894" d="M50.5,-230.47C50.5,-230.4 50.5,-230.34 50.5,-230.27" />
<polygon fill="#7b8894" stroke="#7b8894" points="54.01,-240.07 50.5,-230.07 47.01,-240.07 54.01,-240.07" />
</g>
<!-- 49582490b4c04533a52f50ec09aa3839 -->
<g id="node2" class="node">
<title>49582490b4c04533a52f50ec09aa3839</title>
<image xlink:href="/icons/start-end.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="72" y="-349.5" />
<text text-anchor="middle" x="122.5" y="-234.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">End Outer Loop</text>
</g>
<!-- 49582490b4c04533a52f50ec09aa3839&#45;&gt;734f0fc44fdb44bf9508117133bd4c51 -->
<g id="edge22" class="edge">
<title>49582490b4c04533a52f50ec09aa3839-&gt;734f0fc44fdb44bf9508117133bd4c51</title>
<path fill="none" stroke="#7b8894" d="M71.71,-299C71.67,-299 71.62,-299 71.57,-299" />
<polygon fill="#7b8894" stroke="#7b8894" points="81.44,-295.51 71.43,-299 81.43,-302.51 81.44,-295.51" />
</g>
<!-- 28e18aeb27674c8da83af4cc566fdeae -->
<g id="node4" class="node">
<title>28e18aeb27674c8da83af4cc566fdeae</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="72" y="-277.5" />
<text text-anchor="middle" x="122.5" y="-161.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Initialize &amp; Prepare</text>
<text text-anchor="middle" x="122.5" y="-147.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Acquisition</text>
</g>
<!-- 57f47daedb5c4819a5b902b66e7c4359&#45;&gt;28e18aeb27674c8da83af4cc566fdeae -->
<g id="edge2" class="edge">
<title>57f47daedb5c4819a5b902b66e7c4359-&gt;28e18aeb27674c8da83af4cc566fdeae</title>
<path fill="none" stroke="#7b8894" d="M101.29,-227C101.33,-227 101.38,-227 101.43,-227" />
<polygon fill="#7b8894" stroke="#7b8894" points="91.57,-230.51 101.57,-227 91.56,-223.51 91.57,-230.51" />
</g>
<!-- 55a93ad5196d4986ba2e69df8b56ddc4 -->
<g id="node5" class="node">
<title>55a93ad5196d4986ba2e69df8b56ddc4</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="72" y="-205.5" />
<text text-anchor="middle" x="122.5" y="-90.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">For Each ROI</text>
</g>
<!-- 28e18aeb27674c8da83af4cc566fdeae&#45;&gt;55a93ad5196d4986ba2e69df8b56ddc4 -->
<g id="edge3" class="edge">
<title>28e18aeb27674c8da83af4cc566fdeae-&gt;55a93ad5196d4986ba2e69df8b56ddc4</title>
<path fill="none" stroke="#7b8894" d="M122.5,-155.05C122.5,-155.04 122.5,-155.04 122.5,-155.03" />
<polygon fill="#7b8894" stroke="#7b8894" points="126.06,-164.99 122.5,-155.01 119.06,-165.03 126.06,-164.99" />
</g>
<!-- 8d85fd3a153743c38767f5da7f8fdc03 -->
<g id="node6" class="node">
<title>8d85fd3a153743c38767f5da7f8fdc03</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="72" y="-133.5" />
<text text-anchor="middle" x="122.5" y="-17.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Initialize ROI &amp;</text>
<text text-anchor="middle" x="122.5" y="-3.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Calculate Position</text>
</g>
<!-- 55a93ad5196d4986ba2e69df8b56ddc4&#45;&gt;8d85fd3a153743c38767f5da7f8fdc03 -->
<g id="edge4" class="edge">
<title>55a93ad5196d4986ba2e69df8b56ddc4-&gt;8d85fd3a153743c38767f5da7f8fdc03</title>
<path fill="none" stroke="#7b8894" d="M122.5,-86.47C122.5,-86.4 122.5,-86.34 122.5,-86.27" />
<polygon fill="#7b8894" stroke="#7b8894" points="126.01,-96.07 122.5,-86.07 119.01,-96.07 126.01,-96.07" />
</g>
<!-- 0ea6ad2e66b6475a882133d274722f54 -->
<g id="node7" class="node">
<title>0ea6ad2e66b6475a882133d274722f54</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="144" y="-133.5" />
<text text-anchor="middle" x="194.5" y="-17.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Move &amp;</text>
<text text-anchor="middle" x="194.5" y="-3.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Stabilize Stage</text>
</g>
<!-- 8d85fd3a153743c38767f5da7f8fdc03&#45;&gt;0ea6ad2e66b6475a882133d274722f54 -->
<g id="edge5" class="edge">
<title>8d85fd3a153743c38767f5da7f8fdc03-&gt;0ea6ad2e66b6475a882133d274722f54</title>
<path fill="none" stroke="#7b8894" d="M173.29,-83C173.33,-83 173.38,-83 173.43,-83" />
<polygon fill="#7b8894" stroke="#7b8894" points="163.57,-86.51 173.57,-83 163.56,-79.51 163.57,-86.51" />
</g>
<!-- 707c5533a1494614a0abfd520cfba85f -->
<g id="node9" class="node">
<title>707c5533a1494614a0abfd520cfba85f</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="216" y="-133.5" />
<text text-anchor="middle" x="266.5" y="-17.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Set Metadata</text>
<text text-anchor="middle" x="266.5" y="-3.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">for Each Tile</text>
</g>
<!-- 0ea6ad2e66b6475a882133d274722f54&#45;&gt;707c5533a1494614a0abfd520cfba85f -->
<g id="edge6" class="edge">
<title>0ea6ad2e66b6475a882133d274722f54-&gt;707c5533a1494614a0abfd520cfba85f</title>
<path fill="none" stroke="#7b8894" d="M245.29,-83C245.33,-83 245.38,-83 245.43,-83" />
<polygon fill="#7b8894" stroke="#7b8894" points="235.57,-86.51 245.57,-83 235.56,-79.51 235.57,-86.51" />
</g>
<!-- 74cf864fc99846f4b48df0acf7448761 -->
<g id="node8" class="node">
<title>74cf864fc99846f4b48df0acf7448761</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="144" y="-205.5" />
<text text-anchor="middle" x="194.5" y="-90.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Finalize ROI</text>
</g>
<!-- efd8ebacffb749aabc5b776fa70d8ddb -->
<g id="node16" class="node">
<title>efd8ebacffb749aabc5b776fa70d8ddb</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="144" y="-277.5" />
<text text-anchor="middle" x="194.5" y="-161.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Correct Lens</text>
<text text-anchor="middle" x="194.5" y="-147.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Distortions</text>
</g>
<!-- 74cf864fc99846f4b48df0acf7448761&#45;&gt;efd8ebacffb749aabc5b776fa70d8ddb -->
<g id="edge15" class="edge">
<title>74cf864fc99846f4b48df0acf7448761-&gt;efd8ebacffb749aabc5b776fa70d8ddb</title>
<path fill="none" stroke="#7b8894" d="M194.5,-223.53C194.5,-223.6 194.5,-223.66 194.5,-223.73" />
<polygon fill="#7b8894" stroke="#7b8894" points="191.01,-213.93 194.5,-223.93 198.01,-213.93 191.01,-213.93" />
</g>
<!-- 5ce307341955473992841ed7a31519ff -->
<g id="node10" class="node">
<title>5ce307341955473992841ed7a31519ff</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="288" y="-133.5" />
<text text-anchor="middle" x="338.5" y="-17.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Start Camera</text>
<text text-anchor="middle" x="338.5" y="-3.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Exposure</text>
</g>
<!-- 707c5533a1494614a0abfd520cfba85f&#45;&gt;5ce307341955473992841ed7a31519ff -->
<g id="edge7" class="edge">
<title>707c5533a1494614a0abfd520cfba85f-&gt;5ce307341955473992841ed7a31519ff</title>
<path fill="none" stroke="#7b8894" d="M317.29,-83C317.33,-83 317.38,-83 317.43,-83" />
<polygon fill="#7b8894" stroke="#7b8894" points="307.57,-86.51 317.57,-83 307.56,-79.51 307.57,-86.51" />
</g>
<!-- aa07982421e043cdb96e00952b093716 -->
<g id="node11" class="node">
<title>aa07982421e043cdb96e00952b093716</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="360" y="-133.5" />
<text text-anchor="middle" x="410.5" y="-17.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Handle Async &amp;</text>
<text text-anchor="middle" x="410.5" y="-3.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Write Metadata</text>
</g>
<!-- 5ce307341955473992841ed7a31519ff&#45;&gt;aa07982421e043cdb96e00952b093716 -->
<g id="edge8" class="edge">
<title>5ce307341955473992841ed7a31519ff-&gt;aa07982421e043cdb96e00952b093716</title>
<path fill="none" stroke="#7b8894" d="M389.29,-83C389.33,-83 389.38,-83 389.43,-83" />
<polygon fill="#7b8894" stroke="#7b8894" points="379.57,-86.51 389.57,-83 379.56,-79.51 379.57,-86.51" />
</g>
<!-- b0b650a42cd3484baa79db10e79796fa -->
<g id="node12" class="node">
<title>b0b650a42cd3484baa79db10e79796fa</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="432" y="-169.5" />
<text text-anchor="middle" x="482.5" y="-53.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Complete</text>
<text text-anchor="middle" x="482.5" y="-39.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Exposure</text>
</g>
<!-- aa07982421e043cdb96e00952b093716&#45;&gt;b0b650a42cd3484baa79db10e79796fa -->
<g id="edge9" class="edge">
<title>aa07982421e043cdb96e00952b093716-&gt;b0b650a42cd3484baa79db10e79796fa</title>
<path fill="none" stroke="#7b8894" d="M461.29,-108.39C461.33,-108.42 461.38,-108.44 461.43,-108.46" />
<polygon fill="#7b8894" stroke="#7b8894" points="451.05,-107.19 461.57,-108.53 454.19,-100.93 451.05,-107.19" />
</g>
<!-- ebbeb16bef9947189cac1f69f412f535 -->
<g id="node13" class="node">
<title>ebbeb16bef9947189cac1f69f412f535</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="360" y="-205.5" />
<text text-anchor="middle" x="410.5" y="-90.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Get Next Position</text>
</g>
<!-- b0b650a42cd3484baa79db10e79796fa&#45;&gt;ebbeb16bef9947189cac1f69f412f535 -->
<g id="edge10" class="edge">
<title>b0b650a42cd3484baa79db10e79796fa-&gt;ebbeb16bef9947189cac1f69f412f535</title>
<path fill="none" stroke="#7b8894" d="M431.71,-144.39C431.67,-144.42 431.62,-144.44 431.57,-144.46" />
<polygon fill="#7b8894" stroke="#7b8894" points="438.81,-136.93 431.43,-144.53 441.95,-143.19 438.81,-136.93" />
</g>
<!-- 821582accd8941249c51e8a0f4a9258d -->
<g id="node14" class="node">
<title>821582accd8941249c51e8a0f4a9258d</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="288" y="-205.5" />
<text text-anchor="middle" x="338.5" y="-90.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Stabilize Stage</text>
</g>
<!-- ebbeb16bef9947189cac1f69f412f535&#45;&gt;821582accd8941249c51e8a0f4a9258d -->
<g id="edge11" class="edge">
<title>ebbeb16bef9947189cac1f69f412f535-&gt;821582accd8941249c51e8a0f4a9258d</title>
<path fill="none" stroke="#7b8894" d="M359.71,-155C359.67,-155 359.62,-155 359.57,-155" />
<polygon fill="#7b8894" stroke="#7b8894" points="369.44,-151.51 359.43,-155 369.43,-158.51 369.44,-151.51" />
</g>
<!-- 2c1aa8ed13c24704b277dc8f31a66c4b -->
<g id="node15" class="node">
<title>2c1aa8ed13c24704b277dc8f31a66c4b</title>
<image xlink:href="/icons/decision.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="216" y="-205.5" />
<text text-anchor="middle" x="266.5" y="-90.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">More Tiles?</text>
</g>
<!-- 821582accd8941249c51e8a0f4a9258d&#45;&gt;2c1aa8ed13c24704b277dc8f31a66c4b -->
<g id="edge12" class="edge">
<title>821582accd8941249c51e8a0f4a9258d-&gt;2c1aa8ed13c24704b277dc8f31a66c4b</title>
<path fill="none" stroke="#7b8894" d="M287.71,-155C287.67,-155 287.62,-155 287.57,-155" />
<polygon fill="#7b8894" stroke="#7b8894" points="297.44,-151.51 287.43,-155 297.43,-158.51 297.44,-151.51" />
</g>
<!-- 2c1aa8ed13c24704b277dc8f31a66c4b&#45;&gt;74cf864fc99846f4b48df0acf7448761 -->
<g id="edge14" class="edge">
<title>2c1aa8ed13c24704b277dc8f31a66c4b-&gt;74cf864fc99846f4b48df0acf7448761</title>
<path fill="none" stroke="#7b8894" d="M215.71,-155C215.67,-155 215.62,-155 215.57,-155" />
<polygon fill="#7b8894" stroke="#7b8894" points="225.44,-151.51 215.43,-155 225.43,-158.51 225.44,-151.51" />
</g>
<!-- 2c1aa8ed13c24704b277dc8f31a66c4b&#45;&gt;707c5533a1494614a0abfd520cfba85f -->
<g id="edge13" class="edge">
<title>2c1aa8ed13c24704b277dc8f31a66c4b-&gt;707c5533a1494614a0abfd520cfba85f</title>
<path fill="none" stroke="#7b8894" d="M266.5,-86.47C266.5,-86.4 266.5,-86.34 266.5,-86.27" />
<polygon fill="#7b8894" stroke="#7b8894" points="270.01,-96.07 266.5,-86.07 263.01,-96.07 270.01,-96.07" />
</g>
<!-- 0153cc471e214e609f5d2fae5e6953b4 -->
<g id="node17" class="node">
<title>0153cc471e214e609f5d2fae5e6953b4</title>
<image xlink:href="/icons/predefined-process.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="216" y="-277.5" />
<text text-anchor="middle" x="266.5" y="-162.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Finalize Metadata</text>
</g>
<!-- efd8ebacffb749aabc5b776fa70d8ddb&#45;&gt;0153cc471e214e609f5d2fae5e6953b4 -->
<g id="edge16" class="edge">
<title>efd8ebacffb749aabc5b776fa70d8ddb-&gt;0153cc471e214e609f5d2fae5e6953b4</title>
<path fill="none" stroke="#7b8894" d="M245.29,-227C245.33,-227 245.38,-227 245.43,-227" />
<polygon fill="#7b8894" stroke="#7b8894" points="235.57,-230.51 245.57,-227 235.56,-223.51 235.57,-230.51" />
</g>
<!-- 8b1b3ab0ee8d42c6acc013109d950dc0 -->
<g id="node18" class="node">
<title>8b1b3ab0ee8d42c6acc013109d950dc0</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="288" y="-277.5" />
<text text-anchor="middle" x="338.5" y="-161.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Create Robocopy</text>
<text text-anchor="middle" x="338.5" y="-147.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">File</text>
</g>
<!-- 0153cc471e214e609f5d2fae5e6953b4&#45;&gt;8b1b3ab0ee8d42c6acc013109d950dc0 -->
<g id="edge17" class="edge">
<title>0153cc471e214e609f5d2fae5e6953b4-&gt;8b1b3ab0ee8d42c6acc013109d950dc0</title>
<path fill="none" stroke="#7b8894" d="M317.29,-227C317.33,-227 317.38,-227 317.43,-227" />
<polygon fill="#7b8894" stroke="#7b8894" points="307.57,-230.51 317.57,-227 307.56,-223.51 307.57,-230.51" />
</g>
<!-- 442141bfda3d4dc0ab0805eb43162921 -->
<g id="node19" class="node">
<title>442141bfda3d4dc0ab0805eb43162921</title>
<image xlink:href="/icons/decision.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="288" y="-349.5" />
<text text-anchor="middle" x="338.5" y="-233.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Check for</text>
<text text-anchor="middle" x="338.5" y="-219.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Abort or Switch</text>
</g>
<!-- 8b1b3ab0ee8d42c6acc013109d950dc0&#45;&gt;442141bfda3d4dc0ab0805eb43162921 -->
<g id="edge18" class="edge">
<title>8b1b3ab0ee8d42c6acc013109d950dc0-&gt;442141bfda3d4dc0ab0805eb43162921</title>
<path fill="none" stroke="#7b8894" d="M338.5,-298.95C338.5,-298.96 338.5,-298.96 338.5,-298.97" />
<polygon fill="#7b8894" stroke="#7b8894" points="335.06,-288.97 338.5,-298.99 342.06,-289.01 335.06,-288.97" />
</g>
<!-- d9184bd454f64f75b39a7425602213e8 -->
<g id="node20" class="node">
<title>d9184bd454f64f75b39a7425602213e8</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="216" y="-349.5" />
<text text-anchor="middle" x="266.5" y="-234.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Handle Abort</text>
</g>
<!-- 442141bfda3d4dc0ab0805eb43162921&#45;&gt;d9184bd454f64f75b39a7425602213e8 -->
<g id="edge19" class="edge">
<title>442141bfda3d4dc0ab0805eb43162921-&gt;d9184bd454f64f75b39a7425602213e8</title>
<path fill="none" stroke="#7b8894" d="M287.71,-299C287.67,-299 287.62,-299 287.57,-299" />
<polygon fill="#7b8894" stroke="#7b8894" points="297.44,-295.51 287.43,-299 297.43,-302.51 297.44,-295.51" />
</g>
<!-- 56ba1398e2f14e1ba8701d893bf2320b -->
<g id="node21" class="node">
<title>56ba1398e2f14e1ba8701d893bf2320b</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="144" y="-349.5" />
<text text-anchor="middle" x="194.5" y="-234.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Schedule Events</text>
</g>
<!-- d9184bd454f64f75b39a7425602213e8&#45;&gt;56ba1398e2f14e1ba8701d893bf2320b -->
<g id="edge20" class="edge">
<title>d9184bd454f64f75b39a7425602213e8-&gt;56ba1398e2f14e1ba8701d893bf2320b</title>
<path fill="none" stroke="#7b8894" d="M215.71,-299C215.67,-299 215.62,-299 215.57,-299" />
<polygon fill="#7b8894" stroke="#7b8894" points="225.44,-295.51 215.43,-299 225.43,-302.51 225.44,-295.51" />
</g>
<!-- 56ba1398e2f14e1ba8701d893bf2320b&#45;&gt;49582490b4c04533a52f50ec09aa3839 -->
<g id="edge21" class="edge">
<title>56ba1398e2f14e1ba8701d893bf2320b-&gt;49582490b4c04533a52f50ec09aa3839</title>
<path fill="none" stroke="#7b8894" d="M143.71,-299C143.67,-299 143.62,-299 143.57,-299" />
<polygon fill="#7b8894" stroke="#7b8894" points="153.44,-295.51 143.43,-299 153.43,-302.51 153.44,-295.51" />
</g>
</g>
</svg></div>

<h2 id="error-state">Error State</h2>


</div>
    </div>
</div>
        <footer class="mdl-mega-footer">
  <div class="mdl-mega-footer__middle-section">
    
  </div>
  <div class="mdl-mega-footer__bottom-section">
    <ul class="mdl-mega-footer__link-list">
      
    </ul>
  </div>
</footer>

      </main>
    </div>
  </body>
</html>

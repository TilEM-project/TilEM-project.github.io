<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <title>pyTEM - TEM Architecture</title>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css"/>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"/>
<!-- <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.-.min.css"/> -->
<link rel="stylesheet" href="/assets/css/style.css"/>
<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/font-awesome.min.css"> -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
  window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>

  </head>
  <body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
      <!-- <div class="mdl-layout--fixed-header mdl-layout__header--scroll"> -->
  <header class="mdl-layout__header">
    <div class="mdl-layout__header-row">
      <span class="mdl-layout-title">
        <a href="/">TEM Architecture</a>
      </span>
      <div class="mdl-layout-spacer mdl-layout--large-screen-only"></div>
      <nav class="mdl-navigation mdl-layout--large-screen-only">
        
          <a class="mdl-navigation__link" href="/topics.html">Topics</a>
        
      </nav>
    </div>
  </header>
  <div class="mdl-layout__drawer">
    <span class="mdl-layout-title">TEM Architecture</span>
    <nav class="mdl-navigation">
      
        <a class="mdl-navigation__link" href="/topics.html">Topics</a>
        
      
    </nav>
  </div>
<!-- </div> -->

      <main class="mdl-layout__content">
        <div class="mdl-grid page-container">
    <div class="mdl-card mdl-cell--12-col mdl-shadow--4dp">
        <div class="mdl-card__title">
            <h2 class="mdl-card__title--text">
                pyTEM
            </h2>
        </div>
        
  <div class="mdl-card__supporting-text mdl-card--border">
    
    
      <h3>Sends</h3>
      <ul>
        
        
          <li><a href="/topics.html#camera-command">camera.command</a></li>
        
          <li><a href="/topics.html#camera-settings">camera.settings</a></li>
        
          <li><a href="/topics.html#scope-command">scope.command</a></li>
        
          <li><a href="/topics.html#stage-aperture-command">stage.aperture.command</a></li>
        
          <li><a href="/topics.html#stage-motion-command">stage.motion.command</a></li>
        
          <li><a href="/topics.html#stage-rotation-command">stage.rotation.command</a></li>
        
          <li><a href="/topics.html#tile-raw">tile.raw</a></li>
        
      </ul>
    
    
      <h3>Receives</h3>
      <ul>
        
        
          <li><a href="/topics.html#camera-image">camera.image</a></li>
        
          <li><a href="/topics.html#camera-status">camera.status</a></li>
        
          <li><a href="/topics.html#scope-status">scope.status</a></li>
        
          <li><a href="/topics.html#stage-aperture-status">stage.aperture.status</a></li>
        
          <li><a href="/topics.html#stage-motion-status">stage.motion.status</a></li>
        
          <li><a href="/topics.html#stage-rotation-status">stage.rotation.status</a></li>
        
      </ul>
    
  </div>

<div class="mdl-card__supporting-text">
  <div class="diagram"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0.00 0.00 828.00 612.00">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(144 468)">
<title>%3</title>
<g id="clust1" class="cluster">
<title>cluster_pyTEM States</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M12,0C12,0 528,0 528,0 534,0 540,-6 540,-12 540,-12 540,-312 540,-312 540,-318 534,-324 528,-324 528,-324 12,-324 12,-324 6,-324 0,-318 0,-312 0,-312 0,-12 0,-12 0,-6 6,0 12,0" />
<text text-anchor="middle" x="49" y="-310.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">pyTEM States</text>
</g>
<!-- 521f05c6b41044d88d0fe6457d79e9ad -->
<g id="node1" class="node">
<title>521f05c6b41044d88d0fe6457d79e9ad</title>
<g id="a_node1"><a xlink:href="#preview-state" xlink:title="Preview/Setup State">
<path fill="none" stroke="black" d="M348,-324C348,-324 156,-324 156,-324 150,-324 144,-318 144,-312 144,-312 144,-300 144,-300 144,-294 150,-288 156,-288 156,-288 348,-288 348,-288 354,-288 360,-294 360,-300 360,-300 360,-312 360,-312 360,-318 354,-324 348,-324" />
<text text-anchor="middle" x="252" y="-302.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Preview/Setup State</text>
</a>
</g>
</g>
<!-- 4da8dd1951e142cf864cccad015a0446 -->
<g id="node2" class="node">
<title>4da8dd1951e142cf864cccad015a0446</title>
<g id="a_node2"><a xlink:href="#change-aperture-state" xlink:title="Change Aperture State">
<path fill="none" stroke="black" d="M204,-216C204,-216 12,-216 12,-216 6,-216 0,-210 0,-204 0,-204 0,-192 0,-192 0,-186 6,-180 12,-180 12,-180 204,-180 204,-180 210,-180 216,-186 216,-192 216,-192 216,-204 216,-204 216,-210 210,-216 204,-216" />
<text text-anchor="middle" x="108" y="-194.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Change Aperture State</text>
</a>
</g>
</g>
<!-- 521f05c6b41044d88d0fe6457d79e9ad&#45;&gt;4da8dd1951e142cf864cccad015a0446 -->
<g id="edge1" class="edge">
<title>521f05c6b41044d88d0fe6457d79e9ad-&gt;4da8dd1951e142cf864cccad015a0446</title>
<path fill="none" stroke="#7b8894" d="M227.9,-287.92C203.91,-269.93 166.95,-242.21 140.4,-222.3" />
<polygon fill="#7b8894" stroke="#7b8894" points="142.28,-219.34 132.18,-216.14 138.08,-224.94 142.28,-219.34" />
</g>
<!-- fd83c22b728a49ceac91a40de0ad80ea -->
<g id="node3" class="node">
<title>fd83c22b728a49ceac91a40de0ad80ea</title>
<g id="a_node3"><a xlink:href="#acquisition-state" xlink:title="Acquisition State">
<path fill="none" stroke="black" d="M348,-36C348,-36 156,-36 156,-36 150,-36 144,-30 144,-24 144,-24 144,-12 144,-12 144,-6 150,0 156,0 156,0 348,0 348,0 354,0 360,-6 360,-12 360,-12 360,-24 360,-24 360,-30 354,-36 348,-36" />
<text text-anchor="middle" x="252" y="-14.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Acquisition State</text>
</a>
</g>
</g>
<!-- 4da8dd1951e142cf864cccad015a0446&#45;&gt;fd83c22b728a49ceac91a40de0ad80ea -->
<g id="edge2" class="edge">
<title>4da8dd1951e142cf864cccad015a0446-&gt;fd83c22b728a49ceac91a40de0ad80ea</title>
<path fill="none" stroke="#7b8894" d="M137.2,-179.69C170.66,-147.66 222.24,-82.73 243.56,-45.39" />
<polygon fill="#7b8894" stroke="#7b8894" points="246.9,-46.56 248.52,-36.08 240.73,-43.27 246.9,-46.56" />
</g>
<!-- 71624a4bdaa84e7f8ec84e71580f33a7 -->
<g id="node4" class="node">
<title>71624a4bdaa84e7f8ec84e71580f33a7</title>
<g id="a_node4"><a xlink:href="#error-state" xlink:title="Error State">
<polygon fill="none" stroke="black" points="468,-225 396,-198 468,-171 540,-198 468,-225" />
<text text-anchor="middle" x="468" y="-194.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Error State</text>
</a>
</g>
</g>
<!-- 4da8dd1951e142cf864cccad015a0446&#45;&gt;71624a4bdaa84e7f8ec84e71580f33a7 -->
<g id="edge5" class="edge">
<title>4da8dd1951e142cf864cccad015a0446-&gt;71624a4bdaa84e7f8ec84e71580f33a7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M216.01,-198C270.46,-198 335.43,-198 385.76,-198" />
<polygon fill="red" stroke="red" points="385.94,-201.5 395.94,-198 385.94,-194.5 385.94,-201.5" />
<text text-anchor="middle" x="284.38" y="-201.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Error</text>
</g>
<!-- fd83c22b728a49ceac91a40de0ad80ea&#45;&gt;521f05c6b41044d88d0fe6457d79e9ad -->
<g id="edge6" class="edge">
<title>fd83c22b728a49ceac91a40de0ad80ea-&gt;521f05c6b41044d88d0fe6457d79e9ad</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M252,-36.02C252,-84.71 252,-219.2 252,-277.94" />
<polygon fill="blue" stroke="blue" points="248.5,-277.99 252,-287.99 255.5,-277.99 248.5,-277.99" />
<text text-anchor="middle" x="233.5" y="-160.58" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Abort</text>
</g>
<!-- fd83c22b728a49ceac91a40de0ad80ea&#45;&gt;4da8dd1951e142cf864cccad015a0446 -->
<g id="edge3" class="edge">
<title>fd83c22b728a49ceac91a40de0ad80ea-&gt;4da8dd1951e142cf864cccad015a0446</title>
<path fill="none" stroke="#7b8894" d="M222.01,-36.31C188.21,-68.39 136.69,-133.34 115.83,-170.68" />
<polygon fill="#7b8894" stroke="#7b8894" points="112.5,-169.5 111.01,-179.99 118.72,-172.72 112.5,-169.5" />
<text text-anchor="middle" x="145.42" y="-107.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Repeat</text>
</g>
<!-- fd83c22b728a49ceac91a40de0ad80ea&#45;&gt;71624a4bdaa84e7f8ec84e71580f33a7 -->
<g id="edge4" class="edge">
<title>fd83c22b728a49ceac91a40de0ad80ea-&gt;71624a4bdaa84e7f8ec84e71580f33a7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M273.9,-36.25C312.67,-68.56 393.46,-135.88 437.6,-172.66" />
<polygon fill="red" stroke="red" points="435.47,-175.45 445.39,-179.16 439.95,-170.07 435.47,-175.45" />
<text text-anchor="middle" x="339.25" y="-108.06" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Error</text>
</g>
</g>
</svg></div>

<h2 id="preview-state">Preview State</h2>

<p>This state is is the entry point to the system. It is the default state at start up and will also be the state that the system will revert to upon detecting an error that does not crash the system.</p>

<h3 id="preview-state-logic">Preview State Logic</h3>

<p>Upon entering this state the system will continuously acquire images from the XIMEA camera and each image frame will be minimally processed. The images are then JPEG encoded and sent to python which pushes them to a websocket to display on a browser based UI.</p>

<div class="diagram"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0.00 0.00 1474.00 868.00">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(144 724)">
<title>%3</title>
<g id="clust1" class="cluster">
<title>cluster_opencv_graph</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M159,-8C159,-8 717,-8 717,-8 723,-8 729,-14 729,-20 729,-20 729,-560 729,-560 729,-566 723,-572 717,-572 717,-572 159,-572 159,-572 153,-572 147,-566 147,-560 147,-560 147,-20 147,-20 147,-14 153,-8 159,-8" />
<text text-anchor="middle" x="197.5" y="-558.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">opencv_graph</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_pyTEMCA</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M779,-217C779,-217 1027,-217 1027,-217 1033,-217 1039,-223 1039,-229 1039,-229 1039,-380 1039,-380 1039,-386 1033,-392 1027,-392 1027,-392 779,-392 779,-392 773,-392 767,-386 767,-380 767,-380 767,-229 767,-229 767,-223 773,-217 779,-217" />
<text text-anchor="middle" x="803.5" y="-378.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">pyTEMCA</text>
</g>
<!-- f8fbba934c2f498ab71a358488b7c710 -->
<g id="node1" class="node">
<title>f8fbba934c2f498ab71a358488b7c710</title>
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="155" y="-350.812" />
<text text-anchor="middle" x="205.5" y="-229.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Acquire Image</text>
</g>
<!-- 091e28ec2fc14f69b27812fa6ac64c42 -->
<g id="node2" class="node">
<title>091e28ec2fc14f69b27812fa6ac64c42</title>
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="310" y="-350.812" />
<text text-anchor="middle" x="360.5" y="-228.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Flat Field Correction</text>
<text text-anchor="middle" x="360.5" y="-214.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">and CLAHE (CUDA)</text>
</g>
<!-- f8fbba934c2f498ab71a358488b7c710&#45;&gt;091e28ec2fc14f69b27812fa6ac64c42 -->
<g id="edge1" class="edge">
<title>f8fbba934c2f498ab71a358488b7c710-&gt;091e28ec2fc14f69b27812fa6ac64c42</title>
<path fill="none" stroke="#7b8894" d="M256.17,-294C270.01,-294 285.18,-294 299.53,-294" />
<polygon fill="#7b8894" stroke="#7b8894" points="299.81,-297.5 309.81,-294 299.81,-290.5 299.81,-297.5" />
</g>
<!-- 37a66f0c44724706be9e19220bfb599f -->
<g id="node3" class="node">
<title>37a66f0c44724706be9e19220bfb599f</title>
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="465" y="-155.812" />
<text text-anchor="middle" x="515.5" y="-33.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Calculate Stats</text>
<text text-anchor="middle" x="515.5" y="-19.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">(Min/Max/Mean)</text>
</g>
<!-- 091e28ec2fc14f69b27812fa6ac64c42&#45;&gt;37a66f0c44724706be9e19220bfb599f -->
<g id="edge4" class="edge">
<title>091e28ec2fc14f69b27812fa6ac64c42-&gt;37a66f0c44724706be9e19220bfb599f</title>
<path fill="none" stroke="#7b8894" d="M411.17,-230.69C426.28,-211.43 442.99,-190.14 458.48,-170.39" />
<polygon fill="#7b8894" stroke="#7b8894" points="461.39,-172.35 464.81,-162.33 455.89,-168.03 461.39,-172.35" />
</g>
<!-- 1004691a868e4254b84cd29d658a2d81 -->
<g id="node4" class="node">
<title>1004691a868e4254b84cd29d658a2d81</title>
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="465" y="-350.812" />
<text text-anchor="middle" x="515.5" y="-229.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Calculate FFT Focus Score</text>
</g>
<!-- 091e28ec2fc14f69b27812fa6ac64c42&#45;&gt;1004691a868e4254b84cd29d658a2d81 -->
<g id="edge6" class="edge">
<title>091e28ec2fc14f69b27812fa6ac64c42-&gt;1004691a868e4254b84cd29d658a2d81</title>
<path fill="none" stroke="#7b8894" d="M411.17,-294C425.01,-294 440.18,-294 454.53,-294" />
<polygon fill="#7b8894" stroke="#7b8894" points="454.81,-297.5 464.81,-294 454.81,-290.5 454.81,-297.5" />
</g>
<!-- 54da796538ce441f9752f67697e6dbf6 -->
<g id="node5" class="node">
<title>54da796538ce441f9752f67697e6dbf6</title>
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="465" y="-530.812" />
<text text-anchor="middle" x="515.5" y="-409.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">JPEG Compress</text>
</g>
<!-- 091e28ec2fc14f69b27812fa6ac64c42&#45;&gt;54da796538ce441f9752f67697e6dbf6 -->
<g id="edge2" class="edge">
<title>091e28ec2fc14f69b27812fa6ac64c42-&gt;54da796538ce441f9752f67697e6dbf6</title>
<path fill="none" stroke="#7b8894" d="M411.17,-352.44C426.22,-370.14 442.84,-389.69 458.28,-407.86" />
<polygon fill="#7b8894" stroke="#7b8894" points="455.67,-410.19 464.81,-415.54 461,-405.66 455.67,-410.19" />
</g>
<!-- 09e55d6066304e4faab375b981f9680e -->
<g id="node6" class="node">
<title>09e55d6066304e4faab375b981f9680e</title>
<image xlink:href="/icons/cpp.png" width="101px" height="113.625px" preserveAspectRatio="xMinYMin meet" x="620" y="-350.812" />
<text text-anchor="middle" x="670.5" y="-228.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Send to Python</text>
<text text-anchor="middle" x="670.5" y="-214.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">via pybind11</text>
</g>
<!-- 37a66f0c44724706be9e19220bfb599f&#45;&gt;09e55d6066304e4faab375b981f9680e -->
<g id="edge5" class="edge">
<title>37a66f0c44724706be9e19220bfb599f-&gt;09e55d6066304e4faab375b981f9680e</title>
<path fill="none" stroke="#7b8894" d="M566.17,-162.31C581.28,-181.57 597.99,-202.86 613.48,-222.61" />
<polygon fill="#7b8894" stroke="#7b8894" points="610.89,-224.97 619.81,-230.67 616.39,-220.65 610.89,-224.97" />
</g>
<!-- 1004691a868e4254b84cd29d658a2d81&#45;&gt;09e55d6066304e4faab375b981f9680e -->
<g id="edge7" class="edge">
<title>1004691a868e4254b84cd29d658a2d81-&gt;09e55d6066304e4faab375b981f9680e</title>
<path fill="none" stroke="#7b8894" d="M566.17,-294C580.01,-294 595.18,-294 609.53,-294" />
<polygon fill="#7b8894" stroke="#7b8894" points="609.81,-297.5 619.81,-294 609.81,-290.5 609.81,-297.5" />
</g>
<!-- 54da796538ce441f9752f67697e6dbf6&#45;&gt;09e55d6066304e4faab375b981f9680e -->
<g id="edge3" class="edge">
<title>54da796538ce441f9752f67697e6dbf6-&gt;09e55d6066304e4faab375b981f9680e</title>
<path fill="none" stroke="#7b8894" d="M566.17,-415.56C581.22,-397.86 597.84,-378.31 613.28,-360.14" />
<polygon fill="#7b8894" stroke="#7b8894" points="616,-362.34 619.81,-352.46 610.67,-357.81 616,-362.34" />
</g>
<!-- 06d8a956b32243a0b997f7dd6b8fa980 -->
<g id="node7" class="node">
<title>06d8a956b32243a0b997f7dd6b8fa980</title>
<image xlink:href="/icons/python.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="775" y="-344.5" />
<text text-anchor="middle" x="825.5" y="-229.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Encode Image</text>
</g>
<!-- 09e55d6066304e4faab375b981f9680e&#45;&gt;06d8a956b32243a0b997f7dd6b8fa980 -->
<g id="edge8" class="edge">
<title>09e55d6066304e4faab375b981f9680e-&gt;06d8a956b32243a0b997f7dd6b8fa980</title>
<path fill="none" stroke="#7b8894" d="M721.17,-294C735.01,-294 750.18,-294 764.53,-294" />
<polygon fill="#7b8894" stroke="#7b8894" points="764.81,-297.5 774.81,-294 764.81,-290.5 764.81,-297.5" />
</g>
<!-- b680c1bdda28492095b490e0efa317ec -->
<g id="node8" class="node">
<title>b680c1bdda28492095b490e0efa317ec</title>
<image xlink:href="/icons/python.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="930" y="-344.5" />
<text text-anchor="middle" x="980.5" y="-229.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Publish Image</text>
</g>
<!-- 06d8a956b32243a0b997f7dd6b8fa980&#45;&gt;b680c1bdda28492095b490e0efa317ec -->
<g id="edge9" class="edge">
<title>06d8a956b32243a0b997f7dd6b8fa980-&gt;b680c1bdda28492095b490e0efa317ec</title>
<path fill="none" stroke="#7b8894" d="M876.17,-294C890.01,-294 905.18,-294 919.53,-294" />
<polygon fill="#7b8894" stroke="#7b8894" points="919.81,-297.5 929.81,-294 919.81,-290.5 919.81,-297.5" />
</g>
<!-- 8dc52b47a8c748abb3bb297e68217ca8 -->
<g id="node9" class="node">
<title>8dc52b47a8c748abb3bb297e68217ca8</title>
<image xlink:href="/icons/user.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1085" y="-344.5" />
<text text-anchor="middle" x="1135.5" y="-229.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Web UI</text>
</g>
<!-- b680c1bdda28492095b490e0efa317ec&#45;&gt;8dc52b47a8c748abb3bb297e68217ca8 -->
<g id="edge10" class="edge">
<title>b680c1bdda28492095b490e0efa317ec-&gt;8dc52b47a8c748abb3bb297e68217ca8</title>
<path fill="none" stroke="#7b8894" d="M1031.17,-294C1045.01,-294 1060.18,-294 1074.53,-294" />
<polygon fill="#7b8894" stroke="#7b8894" points="1074.81,-297.5 1084.81,-294 1074.81,-290.5 1074.81,-297.5" />
</g>
<!-- b796edf4d0a445afb79f636104043ae0 -->
<g id="node10" class="node">
<title>b796edf4d0a445afb79f636104043ae0</title>
<image xlink:href="/icons/decision.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="0" y="-344.5" />
<text text-anchor="middle" x="50.5" y="-229.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">State Changed?</text>
</g>
<!-- b796edf4d0a445afb79f636104043ae0&#45;&gt;f8fbba934c2f498ab71a358488b7c710 -->
<g id="edge12" class="edge">
<title>b796edf4d0a445afb79f636104043ae0-&gt;f8fbba934c2f498ab71a358488b7c710</title>
<path fill="none" stroke="#7b8894" d="M101.17,-294C115.01,-294 130.18,-294 144.53,-294" />
<polygon fill="#7b8894" stroke="#7b8894" points="144.81,-297.5 154.81,-294 144.81,-290.5 144.81,-297.5" />
</g>
<!-- b796edf4d0a445afb79f636104043ae0&#45;&gt;b796edf4d0a445afb79f636104043ae0 -->
<g id="edge11" class="edge">
<title>b796edf4d0a445afb79f636104043ae0-&gt;b796edf4d0a445afb79f636104043ae0</title>
<path fill="none" stroke="#7b8894" d="M21.63,-362.6C21.33,-386.33 30.95,-405.5 50.5,-405.5 67.15,-405.5 76.6,-391.6 78.85,-372.82" />
<polygon fill="#7b8894" stroke="#7b8894" points="82.35,-372.76 79.37,-362.6 75.36,-372.4 82.35,-372.76" />
<text text-anchor="middle" x="24.64" y="-391.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Repeat</text>
</g>
</g>
</svg></div>

<h2 id="change-aperture-state">Change Aperture State</h2>

<p>The Change Aperture State represents a state for moving to an aperture on a grid tape or stick16.</p>

<h3 id="change-aperture-state-logic">Change Aperture State Logic</h3>

<p>Upon entering this state it handles the entry logic for the state and initializes tape_ranges if it is None. It tries to fetch barcode values from TEM_db (if using tape); otherwise, it sets default values.</p>

<p>Next the code performs the following:</p>

<ol>
  <li>
    <p>Initialization and Logging:
 Clears lists related to aperture critical and error events.
 Logs the action of changing the aperture.</p>
  </li>
  <li>
    <p>State Check for Pause:
 Checks if the current montage state is PAUSE. If yes, it schedules the _change_aperture method to run again after 0.2 seconds and exits the current execution.</p>
  </li>
  <li>
    <p>Preparatory Actions:
 Updates beam center results and informs the system that a new montage is starting.</p>
  </li>
  <li>Abort Conditions Check:
 Checks several conditions to decide whether to abort the operation:
    <ul>
      <li>If required media information is missing.</li>
      <li>If environmental conditions are not suitable.</li>
      <li>If there’s a pending request to abort at the end of the montage.</li>
      <li>If there is insufficient disk space.</li>
      <li>If too many errors have accumulated (default is 3).</li>
    </ul>
  </li>
  <li>Handling of Tape and Aperture:
 Retrieves the next task object (TAO) from the montage controller.
 If a valid TAO is found:
    <ul>
      <li>Checks if the destination directory exists or needs to be created.</li>
      <li>Checks for existing data that might require an abort.</li>
      <li>Performs adjustments based on the first Region of Interest (ROI) from tao.</li>
    </ul>
  </li>
  <li>
    <p>Aperture Movement and Correction:
 Manages movement to the correct grid or aperture based on the tape controller status.
 Deals with potential barcode errors and adjusts based on confidence levels in the barcode readings.</p>
  </li>
  <li>
    <p>Lens and Beam Adjustments:
 Adjusts the beam’s brightness and attempts to find a centroid for the aperture if needed.
 Conducts a quality check on the beam’s brightness and might abort if the beam mean value is too low.
 Manages autocentering of the beam if necessary.</p>
  </li>
  <li>
    <p>Brightfield Imaging:
 Handles brightfield imaging conditions and might abort based on the quality of consecutive brightfield images.</p>
  </li>
  <li>
    <p>Lens Correction Montage:
 Decides whether a new lens correction montage is necessary based on time intervals and changes in lens conditions.</p>
  </li>
  <li>Finalizing and Error Handling:
If no ROIs are found in tao, logs the event but continues processing.
If there are still tasks (taos) left in the montage queue, it triggers the start of another attempt.
Sets the montage state to NONE if no tasks are left.</li>
</ol>

<div class="diagram"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0.00 0.00 2281.00 716.00">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(144 572)">
<title>%3</title>
<g id="clust1" class="cluster">
<title>cluster_Change Aperture State</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M20,-8C20,-8 1973,-8 1973,-8 1979,-8 1985,-14 1985,-20 1985,-20 1985,-408 1985,-408 1985,-414 1979,-420 1973,-420 1973,-420 20,-420 20,-420 14,-420 8,-414 8,-408 8,-408 8,-20 8,-20 8,-14 14,-8 20,-8" />
<text text-anchor="middle" x="85" y="-406.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Change Aperture State</text>
</g>
<!-- 53cc958cf4974207b63077055339e05e -->
<g id="node1" class="node">
<title>53cc958cf4974207b63077055339e05e</title>
<image xlink:href="/icons/start-end.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="16" y="-253.5" />
<text text-anchor="middle" x="66.5" y="-138.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Enter State</text>
</g>
<!-- 53a35127a36042b79b1d0af106e350dd -->
<g id="node2" class="node">
<title>53a35127a36042b79b1d0af106e350dd</title>
<image xlink:href="/icons/decision.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="171" y="-253.5" />
<text text-anchor="middle" x="221.5" y="-138.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Initialize tape_ranges</text>
</g>
<!-- 53cc958cf4974207b63077055339e05e&#45;&gt;53a35127a36042b79b1d0af106e350dd -->
<g id="edge1" class="edge">
<title>53cc958cf4974207b63077055339e05e-&gt;53a35127a36042b79b1d0af106e350dd</title>
<path fill="none" stroke="#7b8894" d="M117.17,-203C131.01,-203 146.18,-203 160.53,-203" />
<polygon fill="#7b8894" stroke="#7b8894" points="160.81,-206.5 170.81,-203 160.81,-199.5 160.81,-206.5" />
</g>
<!-- fbdc4533e61e4436a7ac439017237afc -->
<g id="node3" class="node">
<title>fbdc4533e61e4436a7ac439017237afc</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="326" y="-149.5" />
<text text-anchor="middle" x="376.5" y="-33.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Fetch Barcode</text>
<text text-anchor="middle" x="376.5" y="-19.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">from TEM_db</text>
</g>
<!-- 53a35127a36042b79b1d0af106e350dd&#45;&gt;fbdc4533e61e4436a7ac439017237afc -->
<g id="edge2" class="edge">
<title>53a35127a36042b79b1d0af106e350dd-&gt;fbdc4533e61e4436a7ac439017237afc</title>
<path fill="none" stroke="#7b8894" d="M272.17,-169.23C286.54,-159.47 302.36,-148.72 317.2,-138.63" />
<polygon fill="#7b8894" stroke="#7b8894" points="319.51,-141.29 325.81,-132.77 315.58,-135.5 319.51,-141.29" />
</g>
<!-- 05cd30f72cd4435faca1d5dfcdf1383c -->
<g id="node4" class="node">
<title>05cd30f72cd4435faca1d5dfcdf1383c</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="326" y="-358.5" />
<text text-anchor="middle" x="376.5" y="-242.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Initialization</text>
<text text-anchor="middle" x="376.5" y="-228.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">&amp; Logging</text>
</g>
<!-- 53a35127a36042b79b1d0af106e350dd&#45;&gt;05cd30f72cd4435faca1d5dfcdf1383c -->
<g id="edge3" class="edge">
<title>53a35127a36042b79b1d0af106e350dd-&gt;05cd30f72cd4435faca1d5dfcdf1383c</title>
<path fill="none" stroke="#7b8894" d="M272.17,-237.09C286.54,-246.95 302.36,-257.81 317.2,-267.99" />
<polygon fill="#7b8894" stroke="#7b8894" points="315.59,-271.13 325.81,-273.9 319.55,-265.36 315.59,-271.13" />
</g>
<!-- 277f4fa3a197462b9096c1d266b7d93c -->
<g id="node5" class="node">
<title>277f4fa3a197462b9096c1d266b7d93c</title>
<image xlink:href="/icons/decision.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="481" y="-275.5" />
<text text-anchor="middle" x="531.5" y="-159.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Check if State</text>
<text text-anchor="middle" x="531.5" y="-145.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">is PAUSE</text>
</g>
<!-- 05cd30f72cd4435faca1d5dfcdf1383c&#45;&gt;277f4fa3a197462b9096c1d266b7d93c -->
<g id="edge4" class="edge">
<title>05cd30f72cd4435faca1d5dfcdf1383c-&gt;277f4fa3a197462b9096c1d266b7d93c</title>
<path fill="none" stroke="#7b8894" d="M427.17,-281.05C441.41,-273.33 457.06,-264.84 471.79,-256.85" />
<polygon fill="#7b8894" stroke="#7b8894" points="473.69,-259.8 480.81,-251.95 470.35,-253.65 473.69,-259.8" />
</g>
<!-- 80c6510752e342ba8943d84d8d3d6c5d -->
<g id="node6" class="node">
<title>80c6510752e342ba8943d84d8d3d6c5d</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="636" y="-185.5" />
<text text-anchor="middle" x="686.5" y="-70.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Retry after 0.2s</text>
</g>
<!-- 277f4fa3a197462b9096c1d266b7d93c&#45;&gt;80c6510752e342ba8943d84d8d3d6c5d -->
<g id="edge6" class="edge">
<title>277f4fa3a197462b9096c1d266b7d93c-&gt;80c6510752e342ba8943d84d8d3d6c5d</title>
<path fill="none" stroke="#7b8894" d="M582.17,-180.92C596.41,-171.56 612.06,-162.19 626.79,-154.17" />
<polygon fill="#7b8894" stroke="#7b8894" points="628.63,-157.16 635.81,-149.37 625.34,-150.98 628.63,-157.16" />
</g>
<!-- 52e7c10e56ea4d34b417f85e350b6b8c -->
<g id="node7" class="node">
<title>52e7c10e56ea4d34b417f85e350b6b8c</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="636" y="-365.5" />
<text text-anchor="middle" x="686.5" y="-250.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Preparatory Actions</text>
</g>
<!-- 277f4fa3a197462b9096c1d266b7d93c&#45;&gt;52e7c10e56ea4d34b417f85e350b6b8c -->
<g id="edge5" class="edge">
<title>277f4fa3a197462b9096c1d266b7d93c-&gt;52e7c10e56ea4d34b417f85e350b6b8c</title>
<path fill="none" stroke="#7b8894" d="M582.17,-254.22C596.41,-262.59 612.06,-271.8 626.79,-280.46" />
<polygon fill="#7b8894" stroke="#7b8894" points="625.42,-283.72 635.81,-285.77 628.97,-277.69 625.42,-283.72" />
</g>
<!-- 80c6510752e342ba8943d84d8d3d6c5d&#45;&gt;277f4fa3a197462b9096c1d266b7d93c -->
<g id="edge7" class="edge">
<title>80c6510752e342ba8943d84d8d3d6c5d-&gt;277f4fa3a197462b9096c1d266b7d93c</title>
<path fill="none" stroke="#7b8894" d="M635.81,-179.79C621.58,-189.2 605.92,-198.59 591.2,-206.57" />
<polygon fill="#7b8894" stroke="#7b8894" points="589.38,-203.57 582.17,-211.34 592.65,-209.76 589.38,-203.57" />
</g>
<!-- d073ab55975942978324925a99437a82 -->
<g id="node8" class="node">
<title>d073ab55975942978324925a99437a82</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="791" y="-358.5" />
<text text-anchor="middle" x="841.5" y="-242.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Check Abort</text>
<text text-anchor="middle" x="841.5" y="-228.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Conditions</text>
</g>
<!-- 52e7c10e56ea4d34b417f85e350b6b8c&#45;&gt;d073ab55975942978324925a99437a82 -->
<g id="edge8" class="edge">
<title>52e7c10e56ea4d34b417f85e350b6b8c-&gt;d073ab55975942978324925a99437a82</title>
<path fill="none" stroke="#7b8894" d="M737.17,-312.73C751.01,-312.09 766.18,-311.4 780.53,-310.74" />
<polygon fill="#7b8894" stroke="#7b8894" points="780.98,-314.23 790.81,-310.27 780.66,-307.23 780.98,-314.23" />
</g>
<!-- 71b615e0a74d48b3a2420e3a6006aabd -->
<g id="node9" class="node">
<title>71b615e0a74d48b3a2420e3a6006aabd</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="946" y="-358.5" />
<text text-anchor="middle" x="996.5" y="-242.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Handle Tape</text>
<text text-anchor="middle" x="996.5" y="-228.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">&amp; Aperture</text>
</g>
<!-- d073ab55975942978324925a99437a82&#45;&gt;71b615e0a74d48b3a2420e3a6006aabd -->
<g id="edge9" class="edge">
<title>d073ab55975942978324925a99437a82-&gt;71b615e0a74d48b3a2420e3a6006aabd</title>
<path fill="none" stroke="#7b8894" d="M892.17,-308C906.01,-308 921.18,-308 935.53,-308" />
<polygon fill="#7b8894" stroke="#7b8894" points="935.81,-311.5 945.81,-308 935.81,-304.5 935.81,-311.5" />
</g>
<!-- 0cddaa1285374ea39f22f0dde6d97f47 -->
<g id="node10" class="node">
<title>0cddaa1285374ea39f22f0dde6d97f47</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1101" y="-358.5" />
<text text-anchor="middle" x="1151.5" y="-242.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Aperture Movement</text>
<text text-anchor="middle" x="1151.5" y="-228.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">&amp; Correction</text>
</g>
<!-- 71b615e0a74d48b3a2420e3a6006aabd&#45;&gt;0cddaa1285374ea39f22f0dde6d97f47 -->
<g id="edge10" class="edge">
<title>71b615e0a74d48b3a2420e3a6006aabd-&gt;0cddaa1285374ea39f22f0dde6d97f47</title>
<path fill="none" stroke="#7b8894" d="M1047.17,-308C1061.01,-308 1076.18,-308 1090.53,-308" />
<polygon fill="#7b8894" stroke="#7b8894" points="1090.81,-311.5 1100.81,-308 1090.81,-304.5 1090.81,-311.5" />
</g>
<!-- 0d38fd83138a4be8b6ebae2c4ab8cb7a -->
<g id="node11" class="node">
<title>0d38fd83138a4be8b6ebae2c4ab8cb7a</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1256" y="-358.5" />
<text text-anchor="middle" x="1306.5" y="-242.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Lens &amp; Beam</text>
<text text-anchor="middle" x="1306.5" y="-228.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Adjustments</text>
</g>
<!-- 0cddaa1285374ea39f22f0dde6d97f47&#45;&gt;0d38fd83138a4be8b6ebae2c4ab8cb7a -->
<g id="edge11" class="edge">
<title>0cddaa1285374ea39f22f0dde6d97f47-&gt;0d38fd83138a4be8b6ebae2c4ab8cb7a</title>
<path fill="none" stroke="#7b8894" d="M1202.17,-308C1216.01,-308 1231.18,-308 1245.53,-308" />
<polygon fill="#7b8894" stroke="#7b8894" points="1245.81,-311.5 1255.81,-308 1245.81,-304.5 1245.81,-311.5" />
</g>
<!-- 89b5099c93f94e7f9fb51c62f94b1d46 -->
<g id="node12" class="node">
<title>89b5099c93f94e7f9fb51c62f94b1d46</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1411" y="-358.5" />
<text text-anchor="middle" x="1461.5" y="-243.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Brightfield Imaging</text>
</g>
<!-- 0d38fd83138a4be8b6ebae2c4ab8cb7a&#45;&gt;89b5099c93f94e7f9fb51c62f94b1d46 -->
<g id="edge12" class="edge">
<title>0d38fd83138a4be8b6ebae2c4ab8cb7a-&gt;89b5099c93f94e7f9fb51c62f94b1d46</title>
<path fill="none" stroke="#7b8894" d="M1357.17,-308C1371.01,-308 1386.18,-308 1400.53,-308" />
<polygon fill="#7b8894" stroke="#7b8894" points="1400.81,-311.5 1410.81,-308 1400.81,-304.5 1400.81,-311.5" />
</g>
<!-- 64ecc7dacae645979976f8087061952c -->
<g id="node13" class="node">
<title>64ecc7dacae645979976f8087061952c</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1566" y="-358.5" />
<text text-anchor="middle" x="1616.5" y="-242.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Lens Correction</text>
<text text-anchor="middle" x="1616.5" y="-228.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Montage</text>
</g>
<!-- 89b5099c93f94e7f9fb51c62f94b1d46&#45;&gt;64ecc7dacae645979976f8087061952c -->
<g id="edge13" class="edge">
<title>89b5099c93f94e7f9fb51c62f94b1d46-&gt;64ecc7dacae645979976f8087061952c</title>
<path fill="none" stroke="#7b8894" d="M1512.17,-308C1526.01,-308 1541.18,-308 1555.53,-308" />
<polygon fill="#7b8894" stroke="#7b8894" points="1555.81,-311.5 1565.81,-308 1555.81,-304.5 1555.81,-311.5" />
</g>
<!-- 8f3ef197053c466ba963ff16270a03f1 -->
<g id="node14" class="node">
<title>8f3ef197053c466ba963ff16270a03f1</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1721" y="-358.5" />
<text text-anchor="middle" x="1771.5" y="-242.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Finalizing &amp; Error</text>
<text text-anchor="middle" x="1771.5" y="-228.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Handling</text>
</g>
<!-- 64ecc7dacae645979976f8087061952c&#45;&gt;8f3ef197053c466ba963ff16270a03f1 -->
<g id="edge14" class="edge">
<title>64ecc7dacae645979976f8087061952c-&gt;8f3ef197053c466ba963ff16270a03f1</title>
<path fill="none" stroke="#7b8894" d="M1667.17,-308C1681.01,-308 1696.18,-308 1710.53,-308" />
<polygon fill="#7b8894" stroke="#7b8894" points="1710.81,-311.5 1720.81,-308 1710.81,-304.5 1710.81,-311.5" />
</g>
<!-- 8077ae496d2f4ccc99fe4cae6b967d8b -->
<g id="node15" class="node">
<title>8077ae496d2f4ccc99fe4cae6b967d8b</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1876" y="-358.5" />
<text text-anchor="middle" x="1926.5" y="-243.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Set State to NONE</text>
</g>
<!-- 8f3ef197053c466ba963ff16270a03f1&#45;&gt;8077ae496d2f4ccc99fe4cae6b967d8b -->
<g id="edge15" class="edge">
<title>8f3ef197053c466ba963ff16270a03f1-&gt;8077ae496d2f4ccc99fe4cae6b967d8b</title>
<path fill="none" stroke="#7b8894" d="M1822.17,-308C1836.01,-308 1851.18,-308 1865.53,-308" />
<polygon fill="#7b8894" stroke="#7b8894" points="1865.81,-311.5 1875.81,-308 1865.81,-304.5 1865.81,-311.5" />
</g>
</g>
</svg></div>

<h2 id="acquisition-state">Acquisition State</h2>

<p>The Acquisition State represents the overall state of the acquisition loop in the system for imaging and processing data. It manages tasks related to moving the stage, capturing images, processing metadata, and handling various states during the acquisition process.</p>

<h3 id="acquisition-state-logic">Acquisition State Logic</h3>

<h4 id="main-acquisition-loop-activation">Main Acquisition Loop Activation</h4>

<p>The acquisition starts if both the main_acquisition_loop_active_event is set and _start_new_aperture() returns True.
Initialize variables and prepare for the acquisition sequence within a specific aperture.</p>

<h4 id="roi-acquisition-process">ROI Acquisition Process</h4>

<p>Iterate over each ROI in roi_list.</p>

<p>For each ROI:</p>

<ul>
  <li>Initialize the ROI and calculate the starting position.</li>
  <li>Move the stage to the initial position and wait for it to stabilize.</li>
  <li>Enter a nested loop to handle image capture for each tile in the ROI until there are no more positions to move to.
    <ul>
      <li>Set metadata for the image.</li>
      <li>Start camera exposure.</li>
      <li>If there was a previous image, wait for asynchronous processes to complete and possibly write metadata.</li>
      <li>Wait for the current exposure to complete.</li>
      <li>Get the next position and move the stage.</li>
      <li>Handle synchronization and stabilization of the stage.</li>
    </ul>
  </li>
  <li>After completing all tiles in the ROI, perform final processing such as writing metadata and resetting the stage to the starting position.</li>
</ul>

<h4 id="lens-correction-process">Lens Correction Process</h4>

<p>If lens correction is part of the current montage, attempt to correct lens distortions using template matching and solving algorithms. Multiple attempts are made, and if unsuccessful, a critical error event is logged.</p>

<h4 id="completion-and-metadata-handling">Completion and Metadata Handling</h4>

<p>Finalize the metadata file and write results to a database.
Create a robocopy file if not aborting.</p>

<h4 id="abort-or-switch-event">Abort or Switch Event</h4>

<p>If an abort signal is received or it’s time to switch to another aperture, the loop is terminated or adjusted accordingly.</p>

<h4 id="event-scheduling">Event Scheduling</h4>

<p>Schedule callbacks for events like “BACK_TO_SETUP” or “NEXT_APERTURE” based on the conditions met during the loop.</p>

<div class="diagram"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0.00 0.00 1433.00 976.00">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(144 832)">
<title>%3</title>
<g id="clust1" class="cluster">
<title>cluster_Outer Infinite Loop</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M12,-536.5C12,-536.5 263,-536.5 263,-536.5 269,-536.5 275,-542.5 275,-548.5 275,-548.5 275,-661.5 275,-661.5 275,-667.5 269,-673.5 263,-673.5 263,-673.5 12,-673.5 12,-673.5 6,-673.5 0,-667.5 0,-661.5 0,-661.5 0,-548.5 0,-548.5 0,-542.5 6,-536.5 12,-536.5" />
<text text-anchor="middle" x="64.5" y="-659.9" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Outer Infinite Loop</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_Main Acquisition</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M12,-348C12,-348 263,-348 263,-348 269,-348 275,-354 275,-360 275,-360 275,-502 275,-502 275,-508 269,-514 263,-514 263,-514 12,-514 12,-514 6,-514 0,-508 0,-502 0,-502 0,-360 0,-360 0,-354 6,-348 12,-348" />
<text text-anchor="middle" x="56.5" y="-500.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Main Acquisition</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_ROI Acquisition Process</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M186,0C186,0 437,0 437,0 443,0 449,-6 449,-12 449,-12 449,-313.5 449,-313.5 449,-319.5 443,-325.5 437,-325.5 437,-325.5 186,-325.5 186,-325.5 180,-325.5 174,-319.5 174,-313.5 174,-313.5 174,-12 174,-12 174,-6 180,0 186,0" />
<text text-anchor="middle" x="251.5" y="-311.9" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">ROI Acquisition Process</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_Per-Tile</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M534,0C534,0 1133,0 1133,0 1139,0 1145,-6 1145,-12 1145,-12 1145,-313.5 1145,-313.5 1145,-319.5 1139,-325.5 1133,-325.5 1133,-325.5 534,-325.5 534,-325.5 528,-325.5 522,-319.5 522,-313.5 522,-313.5 522,-12 522,-12 522,-6 528,0 534,0" />
<text text-anchor="middle" x="551.5" y="-311.9" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Per-Tile</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_Lens Correction
Process</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M360,-348C360,-348 437,-348 437,-348 443,-348 449,-354 449,-360 449,-360 449,-502 449,-502 449,-508 443,-514 437,-514 437,-514 360,-514 360,-514 354,-514 348,-508 348,-502 348,-502 348,-360 348,-360 348,-354 354,-348 360,-348" />
<text text-anchor="middle" x="403" y="-500.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Lens Correction</text>
<text text-anchor="middle" x="403" y="-487.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Process</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_Completion &amp; Metadata Handling</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M534,-348C534,-348 785,-348 785,-348 791,-348 797,-354 797,-360 797,-360 797,-502 797,-502 797,-508 791,-514 785,-514 785,-514 534,-514 534,-514 528,-514 522,-508 522,-502 522,-502 522,-360 522,-360 522,-354 528,-348 534,-348" />
<text text-anchor="middle" x="629.5" y="-500.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Completion &amp; Metadata Handling</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_Abort or
Switch Event</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M534,-522C534,-522 785,-522 785,-522 791,-522 797,-528 797,-534 797,-534 797,-676 797,-676 797,-682 791,-688 785,-688 785,-688 534,-688 534,-688 528,-688 522,-682 522,-676 522,-676 522,-534 522,-534 522,-528 528,-522 534,-522" />
<text text-anchor="middle" x="568.5" y="-674.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Abort or</text>
<text text-anchor="middle" x="568.5" y="-661.4" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Switch Event</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_Event Scheduling</title>
<path fill="#e5f5fd" stroke="#aeb6be" d="M360,-536.5C360,-536.5 437,-536.5 437,-536.5 443,-536.5 449,-542.5 449,-548.5 449,-548.5 449,-661.5 449,-661.5 449,-667.5 443,-673.5 437,-673.5 437,-673.5 360,-673.5 360,-673.5 354,-673.5 348,-667.5 348,-661.5 348,-661.5 348,-548.5 348,-548.5 348,-542.5 354,-536.5 360,-536.5" />
<text text-anchor="middle" x="407.5" y="-659.9" font-family="Sans-Serif" font-size="12.00" fill="#2d3436">Event Scheduling</text>
</g>
<!-- 794c09f878b8403489ccaae6719ce2d6 -->
<g id="node1" class="node">
<title>794c09f878b8403489ccaae6719ce2d6</title>
<image xlink:href="/icons/start-end.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="0" y="-655.5" />
<text text-anchor="middle" x="50.5" y="-540.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Start Outer Loop</text>
</g>
<!-- 076adf202f9e4a2fbffc1832fe59c89a -->
<g id="node3" class="node">
<title>076adf202f9e4a2fbffc1832fe59c89a</title>
<image xlink:href="/icons/decision.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="0" y="-481.5" />
<text text-anchor="middle" x="50.5" y="-365.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Check Activation</text>
<text text-anchor="middle" x="50.5" y="-351.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">&amp; Start</text>
</g>
<!-- 794c09f878b8403489ccaae6719ce2d6&#45;&gt;076adf202f9e4a2fbffc1832fe59c89a -->
<g id="edge1" class="edge">
<title>794c09f878b8403489ccaae6719ce2d6-&gt;076adf202f9e4a2fbffc1832fe59c89a</title>
<path fill="none" stroke="#7b8894" d="M50.5,-536.23C50.5,-532.28 50.5,-528.28 50.5,-524.26" />
<polygon fill="#7b8894" stroke="#7b8894" points="54,-524.26 50.5,-514.26 47,-524.26 54,-524.26" />
</g>
<!-- 0bf32893a4cb4dc38f3312e6c6cdc88b -->
<g id="node2" class="node">
<title>0bf32893a4cb4dc38f3312e6c6cdc88b</title>
<image xlink:href="/icons/start-end.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="174" y="-655.5" />
<text text-anchor="middle" x="224.5" y="-540.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">End Outer Loop</text>
</g>
<!-- 0bf32893a4cb4dc38f3312e6c6cdc88b&#45;&gt;794c09f878b8403489ccaae6719ce2d6 -->
<g id="edge22" class="edge">
<title>0bf32893a4cb4dc38f3312e6c6cdc88b-&gt;794c09f878b8403489ccaae6719ce2d6</title>
<path fill="none" stroke="#7b8894" d="M173.7,-605C154.14,-605 131.6,-605 111.19,-605" />
<polygon fill="#7b8894" stroke="#7b8894" points="111.06,-601.5 101.06,-605 111.06,-608.5 111.06,-601.5" />
</g>
<!-- 9f6ffd72adb2467896ec614ec971ceeb -->
<g id="node4" class="node">
<title>9f6ffd72adb2467896ec614ec971ceeb</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="174" y="-481.5" />
<text text-anchor="middle" x="224.5" y="-365.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Initialize &amp; Prepare</text>
<text text-anchor="middle" x="224.5" y="-351.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Acquisition</text>
</g>
<!-- 076adf202f9e4a2fbffc1832fe59c89a&#45;&gt;9f6ffd72adb2467896ec614ec971ceeb -->
<g id="edge2" class="edge">
<title>076adf202f9e4a2fbffc1832fe59c89a-&gt;9f6ffd72adb2467896ec614ec971ceeb</title>
<path fill="none" stroke="#7b8894" d="M101.3,-431C120.86,-431 143.4,-431 163.81,-431" />
<polygon fill="#7b8894" stroke="#7b8894" points="163.94,-434.5 173.94,-431 163.94,-427.5 163.94,-434.5" />
</g>
<!-- 37da934eb025480f8d95701bb157bc5f -->
<g id="node5" class="node">
<title>37da934eb025480f8d95701bb157bc5f</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="174" y="-307.5" />
<text text-anchor="middle" x="224.5" y="-192.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">For Each ROI</text>
</g>
<!-- 9f6ffd72adb2467896ec614ec971ceeb&#45;&gt;37da934eb025480f8d95701bb157bc5f -->
<g id="edge3" class="edge">
<title>9f6ffd72adb2467896ec614ec971ceeb-&gt;37da934eb025480f8d95701bb157bc5f</title>
<path fill="none" stroke="#7b8894" d="M224.5,-347.82C224.5,-343.88 224.5,-339.92 224.5,-335.99" />
<polygon fill="#7b8894" stroke="#7b8894" points="228,-335.65 224.5,-325.65 221,-335.65 228,-335.65" />
</g>
<!-- cc1aea3108054a87a63ba4785b1c20f3 -->
<g id="node6" class="node">
<title>cc1aea3108054a87a63ba4785b1c20f3</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="174" y="-133.5" />
<text text-anchor="middle" x="224.5" y="-17.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Initialize ROI &amp;</text>
<text text-anchor="middle" x="224.5" y="-3.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Calculate Position</text>
</g>
<!-- 37da934eb025480f8d95701bb157bc5f&#45;&gt;cc1aea3108054a87a63ba4785b1c20f3 -->
<g id="edge4" class="edge">
<title>37da934eb025480f8d95701bb157bc5f-&gt;cc1aea3108054a87a63ba4785b1c20f3</title>
<path fill="none" stroke="#7b8894" d="M224.5,-188.23C224.5,-184.28 224.5,-180.28 224.5,-176.26" />
<polygon fill="#7b8894" stroke="#7b8894" points="228,-176.26 224.5,-166.26 221,-176.26 228,-176.26" />
</g>
<!-- 874853f21fc54b7087cb4eeacfda1485 -->
<g id="node7" class="node">
<title>874853f21fc54b7087cb4eeacfda1485</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="348" y="-133.5" />
<text text-anchor="middle" x="398.5" y="-17.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Move &amp;</text>
<text text-anchor="middle" x="398.5" y="-3.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Stabilize Stage</text>
</g>
<!-- cc1aea3108054a87a63ba4785b1c20f3&#45;&gt;874853f21fc54b7087cb4eeacfda1485 -->
<g id="edge5" class="edge">
<title>cc1aea3108054a87a63ba4785b1c20f3-&gt;874853f21fc54b7087cb4eeacfda1485</title>
<path fill="none" stroke="#7b8894" d="M275.3,-83C294.86,-83 317.4,-83 337.81,-83" />
<polygon fill="#7b8894" stroke="#7b8894" points="337.94,-86.5 347.94,-83 337.94,-79.5 337.94,-86.5" />
</g>
<!-- be643727107843f996fae8ec10356364 -->
<g id="node9" class="node">
<title>be643727107843f996fae8ec10356364</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="522" y="-133.5" />
<text text-anchor="middle" x="572.5" y="-17.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Set Metadata</text>
<text text-anchor="middle" x="572.5" y="-3.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">for Each Tile</text>
</g>
<!-- 874853f21fc54b7087cb4eeacfda1485&#45;&gt;be643727107843f996fae8ec10356364 -->
<g id="edge6" class="edge">
<title>874853f21fc54b7087cb4eeacfda1485-&gt;be643727107843f996fae8ec10356364</title>
<path fill="none" stroke="#7b8894" d="M449.3,-83C468.86,-83 491.4,-83 511.81,-83" />
<polygon fill="#7b8894" stroke="#7b8894" points="511.94,-86.5 521.94,-83 511.94,-79.5 511.94,-86.5" />
</g>
<!-- 1ec5b473c89b4aa2b578ca0de18c5d0f -->
<g id="node8" class="node">
<title>1ec5b473c89b4aa2b578ca0de18c5d0f</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="348" y="-307.5" />
<text text-anchor="middle" x="398.5" y="-192.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Finalize ROI</text>
</g>
<!-- d38026b60bc24a1ab369bec660712d26 -->
<g id="node16" class="node">
<title>d38026b60bc24a1ab369bec660712d26</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="348" y="-481.5" />
<text text-anchor="middle" x="398.5" y="-365.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Correct Lens</text>
<text text-anchor="middle" x="398.5" y="-351.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Distortions</text>
</g>
<!-- 1ec5b473c89b4aa2b578ca0de18c5d0f&#45;&gt;d38026b60bc24a1ab369bec660712d26 -->
<g id="edge15" class="edge">
<title>1ec5b473c89b4aa2b578ca0de18c5d0f-&gt;d38026b60bc24a1ab369bec660712d26</title>
<path fill="none" stroke="#7b8894" d="M398.5,-325.77C398.5,-329.72 398.5,-333.72 398.5,-337.74" />
<polygon fill="#7b8894" stroke="#7b8894" points="395,-337.74 398.5,-347.74 402,-337.74 395,-337.74" />
</g>
<!-- 8420fdb54fcc4406b4e5dfa7aa5c6d2e -->
<g id="node10" class="node">
<title>8420fdb54fcc4406b4e5dfa7aa5c6d2e</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="696" y="-133.5" />
<text text-anchor="middle" x="746.5" y="-17.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Start Camera</text>
<text text-anchor="middle" x="746.5" y="-3.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Exposure</text>
</g>
<!-- be643727107843f996fae8ec10356364&#45;&gt;8420fdb54fcc4406b4e5dfa7aa5c6d2e -->
<g id="edge7" class="edge">
<title>be643727107843f996fae8ec10356364-&gt;8420fdb54fcc4406b4e5dfa7aa5c6d2e</title>
<path fill="none" stroke="#7b8894" d="M623.3,-83C642.86,-83 665.4,-83 685.81,-83" />
<polygon fill="#7b8894" stroke="#7b8894" points="685.94,-86.5 695.94,-83 685.94,-79.5 685.94,-86.5" />
</g>
<!-- 6001b7068970476e81e666ec14ee4a16 -->
<g id="node11" class="node">
<title>6001b7068970476e81e666ec14ee4a16</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="870" y="-133.5" />
<text text-anchor="middle" x="920.5" y="-17.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Handle Async &amp;</text>
<text text-anchor="middle" x="920.5" y="-3.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Write Metadata</text>
</g>
<!-- 8420fdb54fcc4406b4e5dfa7aa5c6d2e&#45;&gt;6001b7068970476e81e666ec14ee4a16 -->
<g id="edge8" class="edge">
<title>8420fdb54fcc4406b4e5dfa7aa5c6d2e-&gt;6001b7068970476e81e666ec14ee4a16</title>
<path fill="none" stroke="#7b8894" d="M797.3,-83C816.86,-83 839.4,-83 859.81,-83" />
<polygon fill="#7b8894" stroke="#7b8894" points="859.94,-86.5 869.94,-83 859.94,-79.5 859.94,-86.5" />
</g>
<!-- dc29ac8e705c49c3b05ee9abaa2c3a46 -->
<g id="node12" class="node">
<title>dc29ac8e705c49c3b05ee9abaa2c3a46</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="1044" y="-220.5" />
<text text-anchor="middle" x="1094.5" y="-104.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Complete</text>
<text text-anchor="middle" x="1094.5" y="-90.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Exposure</text>
</g>
<!-- 6001b7068970476e81e666ec14ee4a16&#45;&gt;dc29ac8e705c49c3b05ee9abaa2c3a46 -->
<g id="edge9" class="edge">
<title>6001b7068970476e81e666ec14ee4a16-&gt;dc29ac8e705c49c3b05ee9abaa2c3a46</title>
<path fill="none" stroke="#7b8894" d="M971.3,-108.4C991.22,-118.36 1014.22,-129.86 1034.92,-140.21" />
<polygon fill="#7b8894" stroke="#7b8894" points="1033.43,-143.38 1043.94,-144.72 1036.56,-137.12 1033.43,-143.38" />
</g>
<!-- f44c54d3c7b245428d6593c2ba9be862 -->
<g id="node13" class="node">
<title>f44c54d3c7b245428d6593c2ba9be862</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="870" y="-307.5" />
<text text-anchor="middle" x="920.5" y="-192.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Get Next Position</text>
</g>
<!-- dc29ac8e705c49c3b05ee9abaa2c3a46&#45;&gt;f44c54d3c7b245428d6593c2ba9be862 -->
<g id="edge10" class="edge">
<title>dc29ac8e705c49c3b05ee9abaa2c3a46-&gt;f44c54d3c7b245428d6593c2ba9be862</title>
<path fill="none" stroke="#7b8894" d="M1043.7,-195.4C1023.78,-205.36 1000.78,-216.86 980.08,-227.21" />
<polygon fill="#7b8894" stroke="#7b8894" points="978.44,-224.12 971.06,-231.72 981.57,-230.38 978.44,-224.12" />
</g>
<!-- 5ff6f43cb77f4e49ac9a92c37ee78753 -->
<g id="node14" class="node">
<title>5ff6f43cb77f4e49ac9a92c37ee78753</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="696" y="-307.5" />
<text text-anchor="middle" x="746.5" y="-192.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Stabilize Stage</text>
</g>
<!-- f44c54d3c7b245428d6593c2ba9be862&#45;&gt;5ff6f43cb77f4e49ac9a92c37ee78753 -->
<g id="edge11" class="edge">
<title>f44c54d3c7b245428d6593c2ba9be862-&gt;5ff6f43cb77f4e49ac9a92c37ee78753</title>
<path fill="none" stroke="#7b8894" d="M869.7,-257C850.14,-257 827.6,-257 807.19,-257" />
<polygon fill="#7b8894" stroke="#7b8894" points="807.06,-253.5 797.06,-257 807.06,-260.5 807.06,-253.5" />
</g>
<!-- e5aeb254c89d4f78b8a171b827cbccec -->
<g id="node15" class="node">
<title>e5aeb254c89d4f78b8a171b827cbccec</title>
<image xlink:href="/icons/decision.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="522" y="-307.5" />
<text text-anchor="middle" x="572.5" y="-192.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">More Tiles?</text>
</g>
<!-- 5ff6f43cb77f4e49ac9a92c37ee78753&#45;&gt;e5aeb254c89d4f78b8a171b827cbccec -->
<g id="edge12" class="edge">
<title>5ff6f43cb77f4e49ac9a92c37ee78753-&gt;e5aeb254c89d4f78b8a171b827cbccec</title>
<path fill="none" stroke="#7b8894" d="M695.7,-257C676.14,-257 653.6,-257 633.19,-257" />
<polygon fill="#7b8894" stroke="#7b8894" points="633.06,-253.5 623.06,-257 633.06,-260.5 633.06,-253.5" />
</g>
<!-- e5aeb254c89d4f78b8a171b827cbccec&#45;&gt;1ec5b473c89b4aa2b578ca0de18c5d0f -->
<g id="edge14" class="edge">
<title>e5aeb254c89d4f78b8a171b827cbccec-&gt;1ec5b473c89b4aa2b578ca0de18c5d0f</title>
<path fill="none" stroke="#7b8894" d="M521.7,-257C502.14,-257 479.6,-257 459.19,-257" />
<polygon fill="#7b8894" stroke="#7b8894" points="459.06,-253.5 449.06,-257 459.06,-260.5 459.06,-253.5" />
</g>
<!-- e5aeb254c89d4f78b8a171b827cbccec&#45;&gt;be643727107843f996fae8ec10356364 -->
<g id="edge13" class="edge">
<title>e5aeb254c89d4f78b8a171b827cbccec-&gt;be643727107843f996fae8ec10356364</title>
<path fill="none" stroke="#7b8894" d="M572.5,-188.23C572.5,-184.28 572.5,-180.28 572.5,-176.26" />
<polygon fill="#7b8894" stroke="#7b8894" points="576,-176.26 572.5,-166.26 569,-176.26 576,-176.26" />
</g>
<!-- d983e11f99bf42c6a70710da80e6a329 -->
<g id="node17" class="node">
<title>d983e11f99bf42c6a70710da80e6a329</title>
<image xlink:href="/icons/predefined-process.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="522" y="-481.5" />
<text text-anchor="middle" x="572.5" y="-366.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Finalize Metadata</text>
</g>
<!-- d38026b60bc24a1ab369bec660712d26&#45;&gt;d983e11f99bf42c6a70710da80e6a329 -->
<g id="edge16" class="edge">
<title>d38026b60bc24a1ab369bec660712d26-&gt;d983e11f99bf42c6a70710da80e6a329</title>
<path fill="none" stroke="#7b8894" d="M449.3,-431C468.86,-431 491.4,-431 511.81,-431" />
<polygon fill="#7b8894" stroke="#7b8894" points="511.94,-434.5 521.94,-431 511.94,-427.5 511.94,-434.5" />
</g>
<!-- 1edacfcc608541c1b1d6c50de88e0e53 -->
<g id="node18" class="node">
<title>1edacfcc608541c1b1d6c50de88e0e53</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="696" y="-481.5" />
<text text-anchor="middle" x="746.5" y="-365.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Create Robocopy</text>
<text text-anchor="middle" x="746.5" y="-351.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">File</text>
</g>
<!-- d983e11f99bf42c6a70710da80e6a329&#45;&gt;1edacfcc608541c1b1d6c50de88e0e53 -->
<g id="edge17" class="edge">
<title>d983e11f99bf42c6a70710da80e6a329-&gt;1edacfcc608541c1b1d6c50de88e0e53</title>
<path fill="none" stroke="#7b8894" d="M623.3,-431C642.86,-431 665.4,-431 685.81,-431" />
<polygon fill="#7b8894" stroke="#7b8894" points="685.94,-434.5 695.94,-431 685.94,-427.5 685.94,-434.5" />
</g>
<!-- 15eaf22c66094df297ae036a587651b7 -->
<g id="node19" class="node">
<title>15eaf22c66094df297ae036a587651b7</title>
<image xlink:href="/icons/decision.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="696" y="-655.5" />
<text text-anchor="middle" x="746.5" y="-539.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Check for</text>
<text text-anchor="middle" x="746.5" y="-525.6" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Abort or Switch</text>
</g>
<!-- 1edacfcc608541c1b1d6c50de88e0e53&#45;&gt;15eaf22c66094df297ae036a587651b7 -->
<g id="edge18" class="edge">
<title>1edacfcc608541c1b1d6c50de88e0e53-&gt;15eaf22c66094df297ae036a587651b7</title>
<path fill="none" stroke="#7b8894" d="M746.5,-514.18C746.5,-514.34 746.5,-514.49 746.5,-514.65" />
<polygon fill="#7b8894" stroke="#7b8894" points="743,-511.78 746.5,-521.78 750,-511.78 743,-511.78" />
</g>
<!-- b30f95c0fb60483f8233e3194de1c481 -->
<g id="node20" class="node">
<title>b30f95c0fb60483f8233e3194de1c481</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="522" y="-655.5" />
<text text-anchor="middle" x="572.5" y="-540.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Handle Abort</text>
</g>
<!-- 15eaf22c66094df297ae036a587651b7&#45;&gt;b30f95c0fb60483f8233e3194de1c481 -->
<g id="edge19" class="edge">
<title>15eaf22c66094df297ae036a587651b7-&gt;b30f95c0fb60483f8233e3194de1c481</title>
<path fill="none" stroke="#7b8894" d="M695.7,-605C676.14,-605 653.6,-605 633.19,-605" />
<polygon fill="#7b8894" stroke="#7b8894" points="633.06,-601.5 623.06,-605 633.06,-608.5 633.06,-601.5" />
</g>
<!-- 50efe96810fe4d7c89e82594b42322a3 -->
<g id="node21" class="node">
<title>50efe96810fe4d7c89e82594b42322a3</title>
<image xlink:href="/icons/action.png" width="101px" height="101px" preserveAspectRatio="xMinYMin meet" x="348" y="-655.5" />
<text text-anchor="middle" x="398.5" y="-540.1" font-family="Sans-Serif" font-size="13.00" fill="#2d3436">Schedule Events</text>
</g>
<!-- b30f95c0fb60483f8233e3194de1c481&#45;&gt;50efe96810fe4d7c89e82594b42322a3 -->
<g id="edge20" class="edge">
<title>b30f95c0fb60483f8233e3194de1c481-&gt;50efe96810fe4d7c89e82594b42322a3</title>
<path fill="none" stroke="#7b8894" d="M521.7,-605C502.14,-605 479.6,-605 459.19,-605" />
<polygon fill="#7b8894" stroke="#7b8894" points="459.06,-601.5 449.06,-605 459.06,-608.5 459.06,-601.5" />
</g>
<!-- 50efe96810fe4d7c89e82594b42322a3&#45;&gt;0bf32893a4cb4dc38f3312e6c6cdc88b -->
<g id="edge21" class="edge">
<title>50efe96810fe4d7c89e82594b42322a3-&gt;0bf32893a4cb4dc38f3312e6c6cdc88b</title>
<path fill="none" stroke="#7b8894" d="M347.7,-605C328.14,-605 305.6,-605 285.19,-605" />
<polygon fill="#7b8894" stroke="#7b8894" points="285.06,-601.5 275.06,-605 285.06,-608.5 285.06,-601.5" />
</g>
</g>
</svg></div>

<h2 id="error-state">Error State</h2>


</div>
    </div>
</div>
        <footer class="mdl-mega-footer">
  <div class="mdl-mega-footer__middle-section">
    
  </div>
  <div class="mdl-mega-footer__bottom-section">
    <ul class="mdl-mega-footer__link-list">
      
    </ul>
  </div>
</footer>

      </main>
    </div>
  </body>
</html>
